2024-12-22 01:59:05,211 - root - INFO - Инициализация бота...
2024-12-22 01:59:05,900 - root - INFO - Инициализация бота...
2024-12-22 01:59:05,965 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 01:59:05,966 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-22 01:59:05,966 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 01:59:05,967 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-22 01:59:05,967 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 01:59:05,968 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 01:59:06,034 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-22 01:59:06,034 - root - INFO - Инициализация диспетчера...
2024-12-22 01:59:06,036 - root - INFO - Регистрация обработчиков...
2024-12-22 01:59:06,038 - root - INFO - Регистрация main menu команд...
2024-12-22 01:59:06,371 - root - INFO - Команды успешно установлены
2024-12-22 01:59:06,371 - root - INFO - Запуск polling...
2024-12-22 01:59:06,371 - aiogram.dispatcher - INFO - Start polling
2024-12-22 01:59:06,377 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 01:59:06,379 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-22 01:59:06,380 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] ()
2024-12-22 01:59:06,383 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 01:59:06,383 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] ('528155210',)
2024-12-22 01:59:07,323 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 01:59:07,324 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 01:59:07,325 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-22 01:59:07,325 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] ('138',)
2024-12-22 01:59:08,335 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 01:59:08,335 - sqlalchemy.engine.Engine - INFO - [generated in 0.00077s] ('528155210',)
2024-12-22 01:59:08,401 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 01:59:08,553 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 01:59:08,553 - sqlalchemy.engine.Engine - INFO - [cached since 0.2183s ago] ('432629636',)
2024-12-22 01:59:08,554 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 01:59:08,555 - sqlalchemy.engine.Engine - INFO - [cached since 2.172s ago] ('432629636',)
2024-12-22 01:59:09,552 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 01:59:09,553 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 01:59:09,554 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 01:59:09,554 - sqlalchemy.engine.Engine - INFO - [cached since 1.219s ago] ('432629636',)
2024-12-22 01:59:11,088 - aiogram.event - INFO - Update id=659308948 is handled. Duration 235 ms by bot id=7444575424
2024-12-22 01:59:13,233 - aiogram.event - INFO - Update id=659308949 is handled. Duration 218 ms by bot id=7444575424
2024-12-22 01:59:31,268 - aiogram.event - INFO - Update id=659308950 is handled. Duration 281 ms by bot id=7444575424
2024-12-22 01:59:35,854 - root - INFO - {
    "message_id": 4326,
    "date": 1734821977,
    "chat": {
        "id": 528155210,
        "type": "private",
        "title": null,
        "username": "dastroo",
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "is_forum": null,
        "accent_color_id": null,
        "active_usernames": null,
        "available_reactions": null,
        "background_custom_emoji_id": null,
        "bio": null,
        "birthdate": null,
        "business_intro": null,
        "business_location": null,
        "business_opening_hours": null,
        "can_set_sticker_set": null,
        "custom_emoji_sticker_set_name": null,
        "description": null,
        "emoji_status_custom_emoji_id": null,
        "emoji_status_expiration_date": null,
        "has_aggressive_anti_spam_enabled": null,
        "has_hidden_members": null,
        "has_private_forwards": null,
        "has_protected_content": null,
        "has_restricted_voice_and_video_messages": null,
        "has_visible_history": null,
        "invite_link": null,
        "join_by_request": null,
        "join_to_send_messages": null,
        "linked_chat_id": null,
        "location": null,
        "message_auto_delete_time": null,
        "permissions": null,
        "personal_chat": null,
        "photo": null,
        "pinned_message": null,
        "profile_accent_color_id": null,
        "profile_background_custom_emoji_id": null,
        "slow_mode_delay": null,
        "sticker_set_name": null,
        "unrestrict_boost_count": null
    },
    "message_thread_id": null,
    "from_user": {
        "id": 528155210,
        "is_bot": false,
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "username": "dastroo",
        "language_code": "ru",
        "is_premium": null,
        "added_to_attachment_menu": null,
        "can_join_groups": null,
        "can_read_all_group_messages": null,
        "supports_inline_queries": null,
        "can_connect_to_business": null,
        "has_main_web_app": null
    },
    "sender_chat": null,
    "sender_boost_count": null,
    "sender_business_bot": null,
    "business_connection_id": null,
    "forward_origin": null,
    "is_topic_message": null,
    "is_automatic_forward": null,
    "reply_to_message": null,
    "external_reply": null,
    "quote": null,
    "reply_to_story": null,
    "via_bot": null,
    "edit_date": null,
    "has_protected_content": null,
    "is_from_offline": null,
    "media_group_id": null,
    "author_signature": null,
    "text": null,
    "entities": null,
    "link_preview_options": null,
    "effect_id": null,
    "animation": null,
    "audio": null,
    "document": null,
    "paid_media": null,
    "photo": null,
    "sticker": null,
    "story": null,
    "video": null,
    "video_note": null,
    "voice": null,
    "caption": null,
    "caption_entities": null,
    "show_caption_above_media": null,
    "has_media_spoiler": null,
    "contact": null,
    "dice": null,
    "game": null,
    "poll": null,
    "venue": null,
    "location": null,
    "new_chat_members": null,
    "left_chat_member": null,
    "new_chat_title": null,
    "new_chat_photo": null,
    "delete_chat_photo": null,
    "group_chat_created": null,
    "supergroup_chat_created": null,
    "channel_chat_created": null,
    "message_auto_delete_timer_changed": null,
    "migrate_to_chat_id": null,
    "migrate_from_chat_id": null,
    "pinned_message": null,
    "invoice": null,
    "successful_payment": {
        "currency": "RUB",
        "total_amount": 5000,
        "invoice_payload": "93c42f12-dbd7-4593-a555-f1ad56264930",
        "telegram_payment_charge_id": "7444575424_528155210_340556",
        "provider_payment_charge_id": "7444575424_528155210_340556",
        "subscription_expiration_date": null,
        "is_recurring": null,
        "is_first_recurring": null,
        "shipping_option_id": null,
        "order_info": null
    },
    "refunded_payment": null,
    "users_shared": null,
    "chat_shared": null,
    "connected_website": null,
    "write_access_allowed": null,
    "passport_data": null,
    "proximity_alert_triggered": null,
    "boost_added": null,
    "chat_background_set": null,
    "forum_topic_created": null,
    "forum_topic_edited": null,
    "forum_topic_closed": null,
    "forum_topic_reopened": null,
    "general_forum_topic_hidden": null,
    "general_forum_topic_unhidden": null,
    "giveaway_created": null,
    "giveaway": null,
    "giveaway_winners": null,
    "giveaway_completed": null,
    "video_chat_scheduled": null,
    "video_chat_started": null,
    "video_chat_ended": null,
    "video_chat_participants_invited": null,
    "web_app_data": null,
    "reply_markup": null,
    "forward_date": null,
    "forward_from": null,
    "forward_from_chat": null,
    "forward_from_message_id": null,
    "forward_sender_name": null,
    "forward_signature": null,
    "user_shared": null
}
2024-12-22 01:59:35,990 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 01:59:35,992 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id IS NULL
 LIMIT ? OFFSET ?
2024-12-22 01:59:35,993 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] (1, 0)
2024-12-22 01:59:35,994 - root - ERROR - Ключ с ID None не найден.
2024-12-22 01:59:35,994 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 01:59:35,995 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 01:59:35,996 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id IS NULL
 LIMIT ? OFFSET ?
2024-12-22 01:59:35,996 - sqlalchemy.engine.Engine - INFO - [cached since 0.004077s ago] (1, 0)
2024-12-22 01:59:36,202 - root - INFO - Unable to get key
2024-12-22 01:59:36,202 - aiogram.event - INFO - Update id=659308951 is handled. Duration 358 ms by bot id=7444575424
2024-12-22 02:02:26,383 - aiogram.dispatcher - INFO - Polling stopped
2024-12-22 02:11:16,503 - root - INFO - Инициализация бота...
2024-12-22 02:11:17,350 - root - INFO - Инициализация бота...
2024-12-22 02:11:17,438 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:11:17,439 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-22 02:11:17,439 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 02:11:17,441 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-22 02:11:17,442 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 02:11:17,443 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:11:17,492 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-22 02:11:17,493 - root - INFO - Инициализация диспетчера...
2024-12-22 02:11:17,494 - root - INFO - Регистрация обработчиков...
2024-12-22 02:11:17,496 - root - INFO - Регистрация main menu команд...
2024-12-22 02:11:17,778 - root - INFO - Команды успешно установлены
2024-12-22 02:11:17,778 - root - INFO - Запуск polling...
2024-12-22 02:11:17,778 - aiogram.dispatcher - INFO - Start polling
2024-12-22 02:11:17,787 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:11:17,791 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-22 02:11:17,791 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ()
2024-12-22 02:11:17,795 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 02:11:17,796 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('528155210',)
2024-12-22 02:11:18,936 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:11:18,937 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:11:18,939 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-22 02:11:18,939 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] ('138',)
2024-12-22 02:11:19,704 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:11:19,704 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ('528155210',)
2024-12-22 02:11:19,765 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 02:11:20,004 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:11:20,005 - sqlalchemy.engine.Engine - INFO - [cached since 0.3015s ago] ('432629636',)
2024-12-22 02:11:20,007 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 02:11:20,007 - sqlalchemy.engine.Engine - INFO - [cached since 2.213s ago] ('432629636',)
2024-12-22 02:11:20,893 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:11:20,893 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:11:20,894 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:11:20,894 - sqlalchemy.engine.Engine - INFO - [cached since 1.191s ago] ('432629636',)
2024-12-22 02:11:20,987 - aiogram.event - INFO - Update id=659308952 is handled. Duration 1125 ms by bot id=7444575424
2024-12-22 02:11:22,761 - aiogram.event - INFO - Update id=659308953 is handled. Duration 156 ms by bot id=7444575424
2024-12-22 02:11:28,816 - aiogram.dispatcher - INFO - Polling stopped
2024-12-22 02:11:29,062 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 02:11:29,064 - root - INFO - Бот остановлен вручную.
2024-12-22 02:11:29,313 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000210B94B5FD0>
2024-12-22 02:11:29,314 - asyncio - ERROR - Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x00000210BCF95860>, 34193.015)]']
connector: <aiohttp.connector.TCPConnector object at 0x00000210B94B2F10>
2024-12-22 02:11:35,923 - root - INFO - Инициализация бота...
2024-12-22 02:11:36,593 - root - INFO - Инициализация бота...
2024-12-22 02:11:36,661 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:11:36,661 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-22 02:11:36,662 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 02:11:36,663 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-22 02:11:36,663 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 02:11:36,663 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:11:36,697 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-22 02:11:36,698 - root - INFO - Инициализация диспетчера...
2024-12-22 02:11:36,698 - root - INFO - Регистрация обработчиков...
2024-12-22 02:11:36,700 - root - INFO - Регистрация main menu команд...
2024-12-22 02:11:36,982 - root - INFO - Команды успешно установлены
2024-12-22 02:11:36,982 - root - INFO - Запуск polling...
2024-12-22 02:11:36,982 - aiogram.dispatcher - INFO - Start polling
2024-12-22 02:11:36,989 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:11:36,992 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-22 02:11:36,992 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] ()
2024-12-22 02:11:36,996 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 02:11:36,996 - sqlalchemy.engine.Engine - INFO - [generated in 0.00039s] ('528155210',)
2024-12-22 02:11:37,846 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:11:37,846 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:11:37,847 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-22 02:11:37,848 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] ('138',)
2024-12-22 02:11:38,672 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:11:38,672 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('528155210',)
2024-12-22 02:11:38,732 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 02:11:38,916 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:11:38,917 - sqlalchemy.engine.Engine - INFO - [cached since 0.2448s ago] ('432629636',)
2024-12-22 02:11:38,919 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 02:11:38,919 - sqlalchemy.engine.Engine - INFO - [cached since 1.924s ago] ('432629636',)
2024-12-22 02:11:39,636 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:11:39,637 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:11:39,638 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:11:39,638 - sqlalchemy.engine.Engine - INFO - [cached since 0.966s ago] ('432629636',)
2024-12-22 02:11:40,438 - aiogram.event - INFO - Update id=659308954 is handled. Duration 218 ms by bot id=7444575424
2024-12-22 02:11:41,540 - aiogram.event - INFO - Update id=659308955 is handled. Duration 125 ms by bot id=7444575424
2024-12-22 02:18:07,539 - aiogram.dispatcher - INFO - Polling stopped
2024-12-22 02:18:07,792 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 02:18:07,794 - root - INFO - Бот остановлен вручную.
2024-12-22 02:18:08,034 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001D01B7D6ED0>
2024-12-22 02:18:15,183 - root - INFO - Инициализация бота...
2024-12-22 02:18:16,110 - root - INFO - Инициализация бота...
2024-12-22 02:18:16,209 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:18:16,209 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-22 02:18:16,210 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 02:18:16,212 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-22 02:18:16,212 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 02:18:16,214 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:18:16,278 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-22 02:18:16,278 - root - INFO - Инициализация диспетчера...
2024-12-22 02:18:16,281 - root - INFO - Регистрация обработчиков...
2024-12-22 02:18:16,284 - root - INFO - Регистрация main menu команд...
2024-12-22 02:18:16,626 - root - INFO - Команды успешно установлены
2024-12-22 02:18:16,626 - root - INFO - Запуск polling...
2024-12-22 02:18:16,627 - aiogram.dispatcher - INFO - Start polling
2024-12-22 02:18:16,639 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:18:16,643 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-22 02:18:16,644 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] ()
2024-12-22 02:18:16,649 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 02:18:16,649 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] ('528155210',)
2024-12-22 02:18:17,627 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:18:17,629 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:18:17,631 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-22 02:18:17,632 - sqlalchemy.engine.Engine - INFO - [generated in 0.00068s] ('138',)
2024-12-22 02:18:18,306 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:18:18,307 - sqlalchemy.engine.Engine - INFO - [generated in 0.00064s] ('528155210',)
2024-12-22 02:18:18,368 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 02:18:18,601 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:18:18,602 - sqlalchemy.engine.Engine - INFO - [cached since 0.2958s ago] ('432629636',)
2024-12-22 02:18:18,603 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 02:18:18,604 - sqlalchemy.engine.Engine - INFO - [cached since 1.955s ago] ('432629636',)
2024-12-22 02:18:19,491 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:18:19,492 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:18:19,493 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:18:19,494 - sqlalchemy.engine.Engine - INFO - [cached since 1.188s ago] ('432629636',)
2024-12-22 02:18:19,799 - aiogram.event - INFO - Update id=659308956 is not handled. Duration 0 ms by bot id=7444575424
2024-12-22 02:18:19,800 - aiogram.event - ERROR - Cause exception while process update id=659308956 by bot id=7444575424
AttributeError: 'dict' object has no attribute 'update_data'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 47, in extension_period_key_menu
    await data.update_data(callback.data.split('_')[1])
          ^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'update_data'
2024-12-22 02:18:36,829 - aiogram.dispatcher - INFO - Polling stopped
2024-12-22 02:18:37,091 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 02:18:37,094 - root - INFO - Бот остановлен вручную.
2024-12-22 02:18:37,403 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001CD0EE66F90>
2024-12-22 02:18:37,404 - asyncio - ERROR - Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x000001CD0EDD5710>, 34611.593)]']
connector: <aiohttp.connector.TCPConnector object at 0x000001CD07B82C50>
2024-12-22 02:18:48,643 - root - INFO - Инициализация бота...
2024-12-22 02:18:50,012 - root - INFO - Инициализация бота...
2024-12-22 02:18:50,162 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:18:50,162 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-22 02:18:50,163 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 02:18:50,165 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-22 02:18:50,166 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 02:18:50,168 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:18:50,267 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-22 02:18:50,267 - root - INFO - Инициализация диспетчера...
2024-12-22 02:18:50,272 - root - INFO - Регистрация обработчиков...
2024-12-22 02:18:50,278 - root - INFO - Регистрация main menu команд...
2024-12-22 02:18:50,571 - root - INFO - Команды успешно установлены
2024-12-22 02:18:50,572 - root - INFO - Запуск polling...
2024-12-22 02:18:50,572 - aiogram.dispatcher - INFO - Start polling
2024-12-22 02:18:50,587 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:18:50,594 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-22 02:18:50,595 - sqlalchemy.engine.Engine - INFO - [generated in 0.00089s] ()
2024-12-22 02:18:50,605 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 02:18:50,605 - sqlalchemy.engine.Engine - INFO - [generated in 0.00089s] ('528155210',)
2024-12-22 02:18:51,531 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:18:51,534 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:18:51,536 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-22 02:18:51,537 - sqlalchemy.engine.Engine - INFO - [generated in 0.00083s] ('138',)
2024-12-22 02:18:52,320 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:18:52,320 - sqlalchemy.engine.Engine - INFO - [generated in 0.00090s] ('528155210',)
2024-12-22 02:18:52,388 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 02:18:52,637 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:18:52,638 - sqlalchemy.engine.Engine - INFO - [cached since 0.3183s ago] ('432629636',)
2024-12-22 02:18:52,640 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 02:18:52,642 - sqlalchemy.engine.Engine - INFO - [cached since 2.037s ago] ('432629636',)
2024-12-22 02:18:53,330 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:18:53,332 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:18:53,332 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:18:53,333 - sqlalchemy.engine.Engine - INFO - [cached since 1.013s ago] ('432629636',)
2024-12-22 02:18:54,195 - aiogram.event - INFO - Update id=659308957 is not handled. Duration 0 ms by bot id=7444575424
2024-12-22 02:18:54,196 - aiogram.event - ERROR - Cause exception while process update id=659308957 by bot id=7444575424
ValueError: dictionary update sequence element #0 has length 1; 2 is required
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 47, in extension_period_key_menu
    await state.update_data(callback.data.split('_')[1])
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\context.py", line 36, in update_data
    kwargs.update(data)
ValueError: dictionary update sequence element #0 has length 1; 2 is required
2024-12-22 02:19:11,796 - aiogram.dispatcher - INFO - Polling stopped
2024-12-22 02:19:12,058 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 02:19:12,066 - root - INFO - Бот остановлен вручную.
2024-12-22 02:19:12,907 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002B95C884C90>
2024-12-22 02:19:12,909 - asyncio - ERROR - Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x000002B960361710>, 34645.437)]']
connector: <aiohttp.connector.TCPConnector object at 0x000002B95C885CD0>
2024-12-22 02:19:33,757 - root - INFO - Инициализация бота...
2024-12-22 02:19:35,101 - root - INFO - Инициализация бота...
2024-12-22 02:19:35,228 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:19:35,229 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-22 02:19:35,229 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 02:19:35,232 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-22 02:19:35,233 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 02:19:35,234 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:19:35,324 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-22 02:19:35,325 - root - INFO - Инициализация диспетчера...
2024-12-22 02:19:35,326 - root - INFO - Регистрация обработчиков...
2024-12-22 02:19:35,329 - root - INFO - Регистрация main menu команд...
2024-12-22 02:19:35,697 - root - INFO - Команды успешно установлены
2024-12-22 02:19:35,697 - root - INFO - Запуск polling...
2024-12-22 02:19:35,698 - aiogram.dispatcher - INFO - Start polling
2024-12-22 02:19:35,714 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:19:35,720 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-22 02:19:35,721 - sqlalchemy.engine.Engine - INFO - [generated in 0.00103s] ()
2024-12-22 02:19:35,731 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 02:19:35,731 - sqlalchemy.engine.Engine - INFO - [generated in 0.00086s] ('528155210',)
2024-12-22 02:19:36,614 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:19:36,616 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:19:36,618 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-22 02:19:36,618 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ('138',)
2024-12-22 02:19:37,343 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:19:37,343 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] ('528155210',)
2024-12-22 02:19:37,409 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 02:19:37,630 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:19:37,631 - sqlalchemy.engine.Engine - INFO - [cached since 0.2879s ago] ('432629636',)
2024-12-22 02:19:37,634 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 02:19:37,634 - sqlalchemy.engine.Engine - INFO - [cached since 1.904s ago] ('432629636',)
2024-12-22 02:19:38,335 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:19:38,336 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:19:38,337 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:19:38,338 - sqlalchemy.engine.Engine - INFO - [cached since 0.9951s ago] ('432629636',)
2024-12-22 02:19:38,867 - aiogram.event - INFO - Update id=659308958 is not handled. Duration 0 ms by bot id=7444575424
2024-12-22 02:19:38,868 - aiogram.event - ERROR - Cause exception while process update id=659308958 by bot id=7444575424
TypeError: FSMContext.update_data() takes from 1 to 2 positional arguments but 3 were given
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 47, in extension_period_key_menu
    await state.update_data("selected_key_id", callback.data.split('_')[1])
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FSMContext.update_data() takes from 1 to 2 positional arguments but 3 were given
2024-12-22 02:20:44,000 - aiogram.dispatcher - INFO - Polling stopped
2024-12-22 02:20:44,253 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 02:20:44,255 - root - INFO - Бот остановлен вручную.
2024-12-22 02:20:44,491 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002DB7E3943D0>
2024-12-22 02:20:51,594 - root - INFO - Инициализация бота...
2024-12-22 02:20:52,305 - root - INFO - Инициализация бота...
2024-12-22 02:20:52,388 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:20:52,389 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-22 02:20:52,389 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 02:20:52,391 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-22 02:20:52,391 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 02:20:52,392 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:20:52,432 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-22 02:20:52,433 - root - INFO - Инициализация диспетчера...
2024-12-22 02:20:52,434 - root - INFO - Регистрация обработчиков...
2024-12-22 02:20:52,435 - root - INFO - Регистрация main menu команд...
2024-12-22 02:20:52,814 - root - INFO - Команды успешно установлены
2024-12-22 02:20:52,814 - root - INFO - Запуск polling...
2024-12-22 02:20:52,815 - aiogram.dispatcher - INFO - Start polling
2024-12-22 02:20:52,824 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:20:52,828 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-22 02:20:52,828 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ()
2024-12-22 02:20:52,833 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 02:20:52,833 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] ('528155210',)
2024-12-22 02:20:53,767 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:20:53,768 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:20:53,769 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-22 02:20:53,770 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ('138',)
2024-12-22 02:20:54,548 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:20:54,548 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ('528155210',)
2024-12-22 02:20:54,615 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 02:20:54,771 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:20:54,771 - sqlalchemy.engine.Engine - INFO - [cached since 0.2231s ago] ('432629636',)
2024-12-22 02:20:54,772 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 02:20:54,772 - sqlalchemy.engine.Engine - INFO - [cached since 1.94s ago] ('432629636',)
2024-12-22 02:20:55,486 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:20:55,486 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:20:55,487 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:20:55,487 - sqlalchemy.engine.Engine - INFO - [cached since 0.9388s ago] ('432629636',)
2024-12-22 02:20:56,262 - aiogram.event - INFO - Update id=659308959 is handled. Duration 218 ms by bot id=7444575424
2024-12-22 02:20:58,404 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:20:58,406 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 02:20:58,406 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] ('136', 1, 0)
2024-12-22 02:20:58,531 - aiogram.event - INFO - Update id=659308960 is handled. Duration 858 ms by bot id=7444575424
2024-12-22 02:21:00,587 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:21:00,588 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 02:21:00,588 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] ('528155210', 1, 0)
2024-12-22 02:21:00,590 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 02:21:00,590 - sqlalchemy.engine.Engine - INFO - [cached since 7.758s ago] ('528155210',)
2024-12-22 02:21:02,344 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 02:21:02,344 - aiogram.event - INFO - Update id=659308961 is handled. Duration 1766 ms by bot id=7444575424
2024-12-22 02:21:04,449 - aiogram.dispatcher - INFO - Polling stopped
2024-12-22 02:21:04,710 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 02:21:04,712 - root - INFO - Бот остановлен вручную.
2024-12-22 02:21:29,506 - root - INFO - Инициализация бота...
2024-12-22 02:21:30,437 - root - INFO - Инициализация бота...
2024-12-22 02:21:30,533 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:21:30,533 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-22 02:21:30,533 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 02:21:30,535 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-22 02:21:30,535 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 02:21:30,536 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:21:30,588 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-22 02:21:30,588 - root - INFO - Инициализация диспетчера...
2024-12-22 02:21:30,593 - root - INFO - Регистрация обработчиков...
2024-12-22 02:21:30,595 - root - INFO - Регистрация main menu команд...
2024-12-22 02:21:30,939 - root - INFO - Команды успешно установлены
2024-12-22 02:21:30,939 - root - INFO - Запуск polling...
2024-12-22 02:21:30,939 - aiogram.dispatcher - INFO - Start polling
2024-12-22 02:21:30,949 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:21:30,953 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-22 02:21:30,953 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] ()
2024-12-22 02:21:30,962 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 02:21:30,962 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ('528155210',)
2024-12-22 02:21:31,867 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:21:31,869 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:21:31,871 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-22 02:21:31,872 - sqlalchemy.engine.Engine - INFO - [generated in 0.00071s] ('138',)
2024-12-22 02:21:32,735 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:21:32,735 - sqlalchemy.engine.Engine - INFO - [generated in 0.00063s] ('528155210',)
2024-12-22 02:21:32,802 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 02:21:32,982 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:21:32,983 - sqlalchemy.engine.Engine - INFO - [cached since 0.248s ago] ('432629636',)
2024-12-22 02:21:32,985 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 02:21:32,985 - sqlalchemy.engine.Engine - INFO - [cached since 2.024s ago] ('432629636',)
2024-12-22 02:21:33,744 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 02:21:33,746 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 02:21:33,746 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 02:21:33,746 - sqlalchemy.engine.Engine - INFO - [cached since 1.011s ago] ('432629636',)
2024-12-22 02:21:35,831 - aiogram.event - INFO - Update id=659308962 is handled. Duration 280 ms by bot id=7444575424
2024-12-22 02:21:40,093 - aiogram.dispatcher - INFO - Polling stopped
2024-12-22 11:12:18,600 - root - INFO - Инициализация бота...
2024-12-22 11:12:19,335 - root - INFO - Инициализация бота...
2024-12-22 11:12:19,394 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:12:19,394 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-22 11:12:19,395 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 11:12:19,396 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-22 11:12:19,396 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 11:12:19,397 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 11:12:19,434 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-22 11:12:19,434 - root - INFO - Инициализация диспетчера...
2024-12-22 11:12:19,435 - root - INFO - Регистрация обработчиков...
2024-12-22 11:12:19,437 - root - INFO - Регистрация main menu команд...
2024-12-22 11:12:20,228 - root - INFO - Команды успешно установлены
2024-12-22 11:12:20,228 - root - INFO - Запуск polling...
2024-12-22 11:12:20,229 - aiogram.dispatcher - INFO - Start polling
2024-12-22 11:12:20,239 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:12:20,244 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-22 11:12:20,244 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] ()
2024-12-22 11:12:20,250 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 11:12:20,250 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] ('528155210',)
2024-12-22 11:12:21,986 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 11:12:21,987 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:12:21,988 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-22 11:12:21,989 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ('138',)
2024-12-22 11:12:23,011 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 11:12:23,012 - sqlalchemy.engine.Engine - INFO - [generated in 0.00083s] ('528155210',)
2024-12-22 11:12:23,077 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 11:12:23,301 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 11:12:23,302 - sqlalchemy.engine.Engine - INFO - [cached since 0.2917s ago] ('432629636',)
2024-12-22 11:12:23,304 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 11:12:23,305 - sqlalchemy.engine.Engine - INFO - [cached since 3.055s ago] ('432629636',)
2024-12-22 11:12:24,450 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 11:12:24,452 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:12:24,452 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 11:12:24,452 - sqlalchemy.engine.Engine - INFO - [cached since 1.441s ago] ('432629636',)
2024-12-22 11:12:24,836 - aiogram.event - INFO - Update id=659308963 is handled. Duration 1593 ms by bot id=7444575424
2024-12-22 11:12:27,086 - aiogram.dispatcher - INFO - Polling stopped
2024-12-22 11:12:27,339 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 11:12:27,342 - root - INFO - Бот остановлен вручную.
2024-12-22 11:12:27,640 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002F1EF9A6810>
2024-12-22 11:12:27,641 - asyncio - ERROR - Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x000002F1F6C01710>, 66656.875)]']
connector: <aiohttp.connector.TCPConnector object at 0x000002F1F3135A90>
2024-12-22 11:12:33,477 - root - INFO - Инициализация бота...
2024-12-22 11:12:34,082 - root - INFO - Инициализация бота...
2024-12-22 11:12:34,149 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:12:34,149 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-22 11:12:34,150 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 11:12:34,151 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-22 11:12:34,151 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 11:12:34,152 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 11:12:34,184 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-22 11:12:34,184 - root - INFO - Инициализация диспетчера...
2024-12-22 11:12:34,185 - root - INFO - Регистрация обработчиков...
2024-12-22 11:12:34,186 - root - INFO - Регистрация main menu команд...
2024-12-22 11:12:34,549 - root - INFO - Команды успешно установлены
2024-12-22 11:12:34,550 - root - INFO - Запуск polling...
2024-12-22 11:12:34,551 - aiogram.dispatcher - INFO - Start polling
2024-12-22 11:12:34,567 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:12:34,573 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-22 11:12:34,574 - sqlalchemy.engine.Engine - INFO - [generated in 0.00088s] ()
2024-12-22 11:12:34,586 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 11:12:34,587 - sqlalchemy.engine.Engine - INFO - [generated in 0.00103s] ('528155210',)
2024-12-22 11:12:36,116 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 11:12:36,118 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:12:36,120 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-22 11:12:36,121 - sqlalchemy.engine.Engine - INFO - [generated in 0.00078s] ('138',)
2024-12-22 11:12:37,340 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 11:12:37,341 - sqlalchemy.engine.Engine - INFO - [generated in 0.00141s] ('528155210',)
2024-12-22 11:12:37,422 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 11:12:37,658 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 11:12:37,658 - sqlalchemy.engine.Engine - INFO - [cached since 0.3184s ago] ('432629636',)
2024-12-22 11:12:37,660 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 11:12:37,660 - sqlalchemy.engine.Engine - INFO - [cached since 3.075s ago] ('432629636',)
2024-12-22 11:12:38,879 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 11:12:38,881 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:12:38,883 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 11:12:38,883 - sqlalchemy.engine.Engine - INFO - [cached since 1.543s ago] ('432629636',)
2024-12-22 11:14:39,556 - aiogram.event - INFO - Update id=659308964 is handled. Duration 390 ms by bot id=7444575424
2024-12-22 11:14:44,333 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:14:44,336 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 11:14:44,336 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ('136', 1, 0)
2024-12-22 11:14:44,464 - aiogram.event - INFO - Update id=659308965 is handled. Duration 1235 ms by bot id=7444575424
2024-12-22 11:14:52,037 - aiogram.dispatcher - INFO - Polling stopped
2024-12-22 11:20:46,789 - root - INFO - Инициализация бота...
2024-12-22 11:20:47,390 - root - INFO - Инициализация бота...
2024-12-22 11:20:47,446 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:20:47,447 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-22 11:20:47,447 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 11:20:47,449 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-22 11:20:47,449 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 11:20:47,449 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 11:20:47,484 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-22 11:20:47,485 - root - INFO - Инициализация диспетчера...
2024-12-22 11:20:47,485 - root - INFO - Регистрация обработчиков...
2024-12-22 11:20:47,487 - root - INFO - Регистрация main menu команд...
2024-12-22 11:20:47,879 - root - INFO - Команды успешно установлены
2024-12-22 11:20:47,879 - root - INFO - Запуск polling...
2024-12-22 11:20:47,880 - aiogram.dispatcher - INFO - Start polling
2024-12-22 11:20:47,893 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:20:47,898 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-22 11:20:47,899 - sqlalchemy.engine.Engine - INFO - [generated in 0.00068s] ()
2024-12-22 11:20:47,906 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 11:20:47,908 - sqlalchemy.engine.Engine - INFO - [generated in 0.00077s] ('528155210',)
2024-12-22 11:20:48,969 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 11:20:48,972 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:20:48,975 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-22 11:20:48,976 - sqlalchemy.engine.Engine - INFO - [generated in 0.00080s] ('138',)
2024-12-22 11:20:49,878 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 11:20:49,879 - sqlalchemy.engine.Engine - INFO - [generated in 0.00102s] ('528155210',)
2024-12-22 11:20:49,950 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 11:20:50,134 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 11:20:50,134 - sqlalchemy.engine.Engine - INFO - [cached since 0.2562s ago] ('432629636',)
2024-12-22 11:20:50,136 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 11:20:50,136 - sqlalchemy.engine.Engine - INFO - [cached since 2.229s ago] ('432629636',)
2024-12-22 11:20:51,077 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 11:20:51,078 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:20:51,079 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 11:20:51,079 - sqlalchemy.engine.Engine - INFO - [cached since 1.202s ago] ('432629636',)
2024-12-22 11:20:56,467 - aiogram.event - INFO - Update id=659308966 is handled. Duration 297 ms by bot id=7444575424
2024-12-22 11:20:58,757 - aiogram.event - INFO - Update id=659308967 is handled. Duration 218 ms by bot id=7444575424
2024-12-22 11:21:20,080 - aiogram.event - INFO - Update id=659308968 is handled. Duration 202 ms by bot id=7444575424
2024-12-22 11:21:26,333 - root - INFO - {
    "message_id": 4354,
    "date": 1734855687,
    "chat": {
        "id": 528155210,
        "type": "private",
        "title": null,
        "username": "dastroo",
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "is_forum": null,
        "accent_color_id": null,
        "active_usernames": null,
        "available_reactions": null,
        "background_custom_emoji_id": null,
        "bio": null,
        "birthdate": null,
        "business_intro": null,
        "business_location": null,
        "business_opening_hours": null,
        "can_set_sticker_set": null,
        "custom_emoji_sticker_set_name": null,
        "description": null,
        "emoji_status_custom_emoji_id": null,
        "emoji_status_expiration_date": null,
        "has_aggressive_anti_spam_enabled": null,
        "has_hidden_members": null,
        "has_private_forwards": null,
        "has_protected_content": null,
        "has_restricted_voice_and_video_messages": null,
        "has_visible_history": null,
        "invite_link": null,
        "join_by_request": null,
        "join_to_send_messages": null,
        "linked_chat_id": null,
        "location": null,
        "message_auto_delete_time": null,
        "permissions": null,
        "personal_chat": null,
        "photo": null,
        "pinned_message": null,
        "profile_accent_color_id": null,
        "profile_background_custom_emoji_id": null,
        "slow_mode_delay": null,
        "sticker_set_name": null,
        "unrestrict_boost_count": null
    },
    "message_thread_id": null,
    "from_user": {
        "id": 528155210,
        "is_bot": false,
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "username": "dastroo",
        "language_code": "ru",
        "is_premium": null,
        "added_to_attachment_menu": null,
        "can_join_groups": null,
        "can_read_all_group_messages": null,
        "supports_inline_queries": null,
        "can_connect_to_business": null,
        "has_main_web_app": null
    },
    "sender_chat": null,
    "sender_boost_count": null,
    "sender_business_bot": null,
    "business_connection_id": null,
    "forward_origin": null,
    "is_topic_message": null,
    "is_automatic_forward": null,
    "reply_to_message": null,
    "external_reply": null,
    "quote": null,
    "reply_to_story": null,
    "via_bot": null,
    "edit_date": null,
    "has_protected_content": null,
    "is_from_offline": null,
    "media_group_id": null,
    "author_signature": null,
    "text": null,
    "entities": null,
    "link_preview_options": null,
    "effect_id": null,
    "animation": null,
    "audio": null,
    "document": null,
    "paid_media": null,
    "photo": null,
    "sticker": null,
    "story": null,
    "video": null,
    "video_note": null,
    "voice": null,
    "caption": null,
    "caption_entities": null,
    "show_caption_above_media": null,
    "has_media_spoiler": null,
    "contact": null,
    "dice": null,
    "game": null,
    "poll": null,
    "venue": null,
    "location": null,
    "new_chat_members": null,
    "left_chat_member": null,
    "new_chat_title": null,
    "new_chat_photo": null,
    "delete_chat_photo": null,
    "group_chat_created": null,
    "supergroup_chat_created": null,
    "channel_chat_created": null,
    "message_auto_delete_timer_changed": null,
    "migrate_to_chat_id": null,
    "migrate_from_chat_id": null,
    "pinned_message": null,
    "invoice": null,
    "successful_payment": {
        "currency": "RUB",
        "total_amount": 5000,
        "invoice_payload": "438be681-0ae4-42cd-a25b-348d0e6fb2dc",
        "telegram_payment_charge_id": "7444575424_528155210_340586",
        "provider_payment_charge_id": "7444575424_528155210_340586",
        "subscription_expiration_date": null,
        "is_recurring": null,
        "is_first_recurring": null,
        "shipping_option_id": null,
        "order_info": null
    },
    "refunded_payment": null,
    "users_shared": null,
    "chat_shared": null,
    "connected_website": null,
    "write_access_allowed": null,
    "passport_data": null,
    "proximity_alert_triggered": null,
    "boost_added": null,
    "chat_background_set": null,
    "forum_topic_created": null,
    "forum_topic_edited": null,
    "forum_topic_closed": null,
    "forum_topic_reopened": null,
    "general_forum_topic_hidden": null,
    "general_forum_topic_unhidden": null,
    "giveaway_created": null,
    "giveaway": null,
    "giveaway_winners": null,
    "giveaway_completed": null,
    "video_chat_scheduled": null,
    "video_chat_started": null,
    "video_chat_ended": null,
    "video_chat_participants_invited": null,
    "web_app_data": null,
    "reply_markup": null,
    "forward_date": null,
    "forward_from": null,
    "forward_from_chat": null,
    "forward_from_message_id": null,
    "forward_sender_name": null,
    "forward_signature": null,
    "user_shared": null
}
2024-12-22 11:21:26,422 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:21:26,429 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 11:21:26,429 - sqlalchemy.engine.Engine - INFO - [generated in 0.00120s] ('136', 1, 0)
2024-12-22 11:21:26,441 - sqlalchemy.engine.Engine - INFO - UPDATE keys SET expiration_date=? WHERE keys.key_id = ?
2024-12-22 11:21:26,442 - sqlalchemy.engine.Engine - INFO - [generated in 0.00145s] ('2025-01-24 01:23:22.098292', '136')
2024-12-22 11:21:26,448 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 11:21:26,461 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:21:26,463 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-22 11:21:26,464 - sqlalchemy.engine.Engine - INFO - [cached since 37.49s ago] ('136',)
2024-12-22 11:21:26,469 - root - INFO - Ключ с ID 136 успешно продлён на 31 дней. Новая дата окончания: 2025-01-24 01:23:22.098292
2024-12-22 11:21:26,471 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 11:21:26,474 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:21:26,476 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 11:21:26,477 - sqlalchemy.engine.Engine - INFO - [cached since 0.0492s ago] ('136', 1, 0)
2024-12-22 11:21:27,823 - aiogram.event - INFO - Update id=659308969 is handled. Duration 1500 ms by bot id=7444575424
2024-12-22 11:21:33,888 - aiogram.event - INFO - Update id=659308970 is handled. Duration 264 ms by bot id=7444575424
2024-12-22 11:21:35,394 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:21:35,397 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 11:21:35,398 - sqlalchemy.engine.Engine - INFO - [generated in 0.00088s] ('528155210', 1, 0)
2024-12-22 11:21:35,402 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 11:21:35,402 - sqlalchemy.engine.Engine - INFO - [cached since 47.5s ago] ('528155210',)
2024-12-22 11:21:37,902 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 11:21:38,058 - aiogram.event - INFO - Update id=659308971 is handled. Duration 2671 ms by bot id=7444575424
2024-12-22 11:21:40,459 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:21:40,460 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 11:21:40,460 - sqlalchemy.engine.Engine - INFO - [cached since 14.03s ago] ('136', 1, 0)
2024-12-22 11:21:40,592 - aiogram.event - INFO - Update id=659308972 is handled. Duration 1141 ms by bot id=7444575424
2024-12-22 11:21:43,652 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:21:43,653 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 11:21:43,653 - sqlalchemy.engine.Engine - INFO - [cached since 17.23s ago] ('136', 1, 0)
2024-12-22 11:21:44,832 - aiogram.event - INFO - Update id=659308973 is handled. Duration 1187 ms by bot id=7444575424
2024-12-22 11:21:47,629 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:21:47,630 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 11:21:47,632 - sqlalchemy.engine.Engine - INFO - [cached since 21.2s ago] ('136', 1, 0)
2024-12-22 11:21:47,755 - aiogram.event - INFO - Update id=659308974 is handled. Duration 1156 ms by bot id=7444575424
2024-12-22 11:21:49,217 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:21:49,218 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 11:21:49,218 - sqlalchemy.engine.Engine - INFO - [cached since 13.82s ago] ('528155210', 1, 0)
2024-12-22 11:21:49,220 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 11:21:49,220 - sqlalchemy.engine.Engine - INFO - [cached since 61.31s ago] ('528155210',)
2024-12-22 11:21:51,536 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 11:21:51,536 - aiogram.event - INFO - Update id=659308975 is handled. Duration 2312 ms by bot id=7444575424
2024-12-22 11:21:52,903 - aiogram.event - INFO - Update id=659308976 is handled. Duration 359 ms by bot id=7444575424
2024-12-22 11:21:54,413 - aiogram.event - INFO - Update id=659308977 is handled. Duration 172 ms by bot id=7444575424
2024-12-22 11:21:56,706 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 11:21:56,707 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 11:21:56,707 - sqlalchemy.engine.Engine - INFO - [cached since 21.31s ago] ('528155210', 1, 0)
2024-12-22 11:21:56,792 - aiogram.event - INFO - Update id=659308978 is handled. Duration 110 ms by bot id=7444575424
2024-12-22 11:22:00,590 - aiogram.event - INFO - Update id=659308979 is handled. Duration 157 ms by bot id=7444575424
2024-12-22 11:22:06,016 - aiogram.event - INFO - Update id=659308980 is handled. Duration 218 ms by bot id=7444575424
2024-12-22 11:22:14,395 - aiogram.dispatcher - INFO - Polling stopped
2024-12-22 12:25:47,800 - root - INFO - Инициализация бота...
2024-12-22 12:25:49,592 - root - INFO - Инициализация бота...
2024-12-22 12:25:49,948 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 12:25:49,949 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-22 12:25:49,949 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 12:25:49,953 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2024-12-22 12:25:49,953 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 12:25:49,954 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-22 12:25:49,955 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 12:25:49,956 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("keys")
2024-12-22 12:25:49,957 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 12:25:49,958 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	user_telegram_id VARCHAR NOT NULL, 
	subscription_status VARCHAR, 
	use_trial_period BOOLEAN, 
	PRIMARY KEY (user_telegram_id)
)


2024-12-22 12:25:49,959 - sqlalchemy.engine.Engine - INFO - [no key 0.00049s] ()
2024-12-22 12:25:49,971 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE keys (
	key_id VARCHAR NOT NULL, 
	user_telegram_id VARCHAR, 
	expiration_date DATETIME, 
	start_date DATETIME, 
	remembering_before_exp BOOLEAN, 
	PRIMARY KEY (key_id), 
	FOREIGN KEY(user_telegram_id) REFERENCES users (user_telegram_id)
)


2024-12-22 12:25:49,972 - sqlalchemy.engine.Engine - INFO - [no key 0.00055s] ()
2024-12-22 12:25:49,981 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 12:25:50,106 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-22 12:25:50,107 - root - INFO - Инициализация диспетчера...
2024-12-22 12:25:50,108 - root - INFO - Регистрация обработчиков...
2024-12-22 12:25:50,111 - root - INFO - Регистрация main menu команд...
2024-12-22 12:25:50,743 - root - INFO - Команды успешно установлены
2024-12-22 12:25:50,744 - root - INFO - Запуск polling...
2024-12-22 12:25:50,744 - aiogram.dispatcher - INFO - Start polling
2024-12-22 12:25:50,754 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 12:25:50,758 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-22 12:25:50,759 - sqlalchemy.engine.Engine - INFO - [generated in 0.00052s] ()
2024-12-22 12:25:50,822 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 12:26:39,298 - aiogram.event - INFO - Update id=659308981 is handled. Duration 235 ms by bot id=7444575424
2024-12-22 12:30:55,058 - aiogram.event - INFO - Update id=659308982 is handled. Duration 233 ms by bot id=7444575424
2024-12-22 12:31:03,989 - aiogram.event - INFO - Update id=659308983 is handled. Duration 233 ms by bot id=7444575424
2024-12-22 12:31:09,641 - aiogram.event - INFO - Update id=659308984 is handled. Duration 156 ms by bot id=7444575424
2024-12-22 12:31:37,833 - aiogram.event - INFO - Update id=659308985 is handled. Duration 218 ms by bot id=7444575424
2024-12-22 12:31:39,773 - aiogram.event - INFO - Update id=659308986 is handled. Duration 203 ms by bot id=7444575424
2024-12-22 12:41:11,797 - aiogram.event - INFO - Update id=659308987 is handled. Duration 406 ms by bot id=7444575424
2024-12-22 12:41:13,684 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 12:41:13,687 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 12:41:13,687 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] ('528155210', 1, 0)
2024-12-22 12:41:13,806 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 12:41:13,875 - aiogram.event - INFO - Update id=659308988 is handled. Duration 188 ms by bot id=7444575424
2024-12-22 12:41:25,530 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 12:41:25,530 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 12:41:25,531 - sqlalchemy.engine.Engine - INFO - [cached since 11.84s ago] ('528155210', 1, 0)
2024-12-22 12:41:25,533 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (user_telegram_id, subscription_status, use_trial_period) VALUES (?, ?, ?)
2024-12-22 12:41:25,534 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ('528155210', 'active', 0)
2024-12-22 12:41:25,542 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 12:41:25,548 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 12:41:25,549 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 12:41:25,549 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] ('528155210',)
2024-12-22 12:41:25,552 - sqlalchemy.engine.Engine - INFO - UPDATE users SET use_trial_period=? WHERE users.user_telegram_id = ?
2024-12-22 12:41:25,552 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] (1, '528155210')
2024-12-22 12:41:25,553 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 12:41:26,780 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 12:41:26,782 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2024-12-22 12:41:26,782 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('98', '528155210', '2024-12-24 12:41:26.780159', '2024-12-22 12:41:26.780159', 0)
2024-12-22 12:41:26,790 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 12:41:26,795 - root - INFO - Key created: OutlineKey(key_id='98', name='VPN Key56', password='dWThsKB4YQXzciLlrEBmIu', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpkV1Roc0tCNFlRWHpjaUxsckVCbUl1@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2024-12-22 12:41:27,049 - aiogram.event - INFO - Update id=659308989 is handled. Duration 1515 ms by bot id=7444575424
2024-12-22 12:41:28,723 - aiogram.event - INFO - Update id=659308990 is handled. Duration 157 ms by bot id=7444575424
2024-12-22 12:41:29,876 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 12:41:29,877 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 12:41:29,877 - sqlalchemy.engine.Engine - INFO - [cached since 16.19s ago] ('528155210', 1, 0)
2024-12-22 12:41:29,880 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 12:41:29,880 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] ('528155210',)
2024-12-22 12:41:31,438 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 12:41:31,588 - aiogram.event - INFO - Update id=659308991 is handled. Duration 1718 ms by bot id=7444575424
2024-12-22 12:41:34,385 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 12:41:34,387 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 12:41:34,387 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] ('98', 1, 0)
2024-12-22 12:41:34,513 - aiogram.event - INFO - Update id=659308992 is handled. Duration 1671 ms by bot id=7444575424
2024-12-22 12:43:35,390 - aiogram.dispatcher - INFO - Polling stopped
2024-12-22 12:43:35,646 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 12:43:35,648 - root - INFO - Бот остановлен вручную.
2024-12-22 12:43:43,654 - root - INFO - Инициализация бота...
2024-12-22 12:43:44,321 - root - INFO - Инициализация бота...
2024-12-22 12:43:44,390 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 12:43:44,391 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-22 12:43:44,391 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 12:43:44,392 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-22 12:43:44,392 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 12:43:44,393 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 12:43:44,427 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-22 12:43:44,427 - root - INFO - Инициализация диспетчера...
2024-12-22 12:43:44,428 - root - INFO - Регистрация обработчиков...
2024-12-22 12:43:44,430 - root - INFO - Регистрация main menu команд...
2024-12-22 12:43:44,782 - root - INFO - Команды успешно установлены
2024-12-22 12:43:44,782 - root - INFO - Запуск polling...
2024-12-22 12:43:44,783 - aiogram.dispatcher - INFO - Start polling
2024-12-22 12:43:44,792 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 12:43:44,796 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-22 12:43:44,797 - sqlalchemy.engine.Engine - INFO - [generated in 0.00071s] ()
2024-12-22 12:43:44,803 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 12:43:44,803 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] ('528155210',)
2024-12-22 12:43:45,777 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 12:43:45,777 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 12:43:45,778 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 12:43:45,778 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] ('528155210',)
2024-12-22 12:43:45,843 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 12:43:47,642 - aiogram.event - INFO - Update id=659308993 is handled. Duration 343 ms by bot id=7444575424
2024-12-22 12:43:49,098 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 12:43:49,100 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 12:43:49,100 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] ('528155210', 1, 0)
2024-12-22 12:43:49,102 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 12:43:49,103 - sqlalchemy.engine.Engine - INFO - [cached since 4.3s ago] ('528155210',)
2024-12-22 12:43:50,177 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 12:43:50,311 - aiogram.event - INFO - Update id=659308994 is handled. Duration 1217 ms by bot id=7444575424
2024-12-22 12:43:52,128 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 12:43:52,129 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 12:43:52,129 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ('98', 1, 0)
2024-12-22 12:43:52,272 - aiogram.event - INFO - Update id=659308995 is handled. Duration 1281 ms by bot id=7444575424
2024-12-22 12:46:57,909 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 12:46:57,910 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 12:46:57,910 - sqlalchemy.engine.Engine - INFO - [cached since 188.8s ago] ('528155210', 1, 0)
2024-12-22 12:46:57,912 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 12:46:57,912 - sqlalchemy.engine.Engine - INFO - [cached since 193.1s ago] ('528155210',)
2024-12-22 12:46:59,551 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 12:46:59,552 - aiogram.event - INFO - Update id=659308996 is handled. Duration 1640 ms by bot id=7444575424
2024-12-22 12:47:00,907 - aiogram.event - INFO - Update id=659308997 is handled. Duration 141 ms by bot id=7444575424
2024-12-22 12:47:09,944 - aiogram.event - INFO - Update id=659308998 is handled. Duration 327 ms by bot id=7444575424
2024-12-22 12:47:12,276 - aiogram.event - INFO - Update id=659308999 is handled. Duration 187 ms by bot id=7444575424
2024-12-22 12:47:14,236 - aiogram.event - INFO - Update id=659309000 is handled. Duration 264 ms by bot id=7444575424
2024-12-22 12:47:15,837 - aiogram.event - INFO - Update id=659309001 is handled. Duration 281 ms by bot id=7444575424
2024-12-22 12:47:18,363 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 12:47:18,364 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 12:47:18,364 - sqlalchemy.engine.Engine - INFO - [cached since 209.3s ago] ('528155210', 1, 0)
2024-12-22 12:47:18,365 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 12:47:18,366 - sqlalchemy.engine.Engine - INFO - [cached since 213.6s ago] ('528155210',)
2024-12-22 12:47:19,570 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 12:47:19,710 - aiogram.event - INFO - Update id=659309002 is handled. Duration 1343 ms by bot id=7444575424
2024-12-22 12:47:21,092 - aiogram.event - INFO - Update id=659309003 is handled. Duration 266 ms by bot id=7444575424
2024-12-22 12:49:45,131 - aiogram.event - INFO - Update id=659309004 is handled. Duration 453 ms by bot id=7444575424
2024-12-22 12:49:46,154 - aiogram.event - INFO - Update id=659309005 is handled. Duration 125 ms by bot id=7444575424
2024-12-22 12:49:47,763 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 12:49:47,763 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 12:49:47,764 - sqlalchemy.engine.Engine - INFO - [cached since 358.7s ago] ('528155210', 1, 0)
2024-12-22 12:49:47,766 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 12:49:47,766 - sqlalchemy.engine.Engine - INFO - [cached since 363s ago] ('528155210',)
2024-12-22 12:49:48,802 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 12:49:48,862 - aiogram.event - INFO - Update id=659309006 is handled. Duration 1093 ms by bot id=7444575424
2024-12-22 12:49:50,065 - aiogram.event - INFO - Update id=659309007 is handled. Duration 139 ms by bot id=7444575424
2024-12-22 12:49:51,419 - aiogram.event - INFO - Update id=659309008 is handled. Duration 235 ms by bot id=7444575424
2024-12-22 13:03:17,328 - aiogram.event - INFO - Update id=659309009 is handled. Duration 202 ms by bot id=7444575424
2024-12-22 13:03:23,295 - aiogram.event - INFO - Update id=659309010 is handled. Duration 156 ms by bot id=7444575424
2024-12-22 13:03:25,636 - aiogram.event - INFO - Update id=659309011 is handled. Duration 171 ms by bot id=7444575424
2024-12-22 13:03:27,584 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:03:27,585 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:03:27,585 - sqlalchemy.engine.Engine - INFO - [cached since 1178s ago] ('528155210', 1, 0)
2024-12-22 13:03:27,589 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 13:03:27,589 - sqlalchemy.engine.Engine - INFO - [cached since 1183s ago] ('528155210',)
2024-12-22 13:03:29,192 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 13:03:29,287 - aiogram.event - INFO - Update id=659309012 is handled. Duration 1703 ms by bot id=7444575424
2024-12-22 13:03:31,395 - aiogram.event - INFO - Update id=659309013 is handled. Duration 375 ms by bot id=7444575424
2024-12-22 13:03:33,344 - aiogram.event - INFO - Update id=659309014 is handled. Duration 203 ms by bot id=7444575424
2024-12-22 13:03:34,487 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:03:34,488 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:03:34,488 - sqlalchemy.engine.Engine - INFO - [cached since 1185s ago] ('528155210', 1, 0)
2024-12-22 13:03:34,908 - aiogram.event - INFO - Update id=659309015 is handled. Duration 422 ms by bot id=7444575424
2024-12-22 13:03:37,045 - aiogram.event - INFO - Update id=659309016 is handled. Duration 93 ms by bot id=7444575424
2024-12-22 13:03:42,006 - aiogram.event - INFO - Update id=659309017 is handled. Duration 266 ms by bot id=7444575424
2024-12-22 13:04:11,096 - aiogram.event - INFO - Update id=659309018 is handled. Duration 703 ms by bot id=7444575424
2024-12-22 13:04:34,758 - aiogram.event - INFO - Update id=659309019 is handled. Duration 281 ms by bot id=7444575424
2024-12-22 13:04:43,501 - root - INFO - {
    "message_id": 4367,
    "date": 1734861885,
    "chat": {
        "id": 528155210,
        "type": "private",
        "title": null,
        "username": "dastroo",
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "is_forum": null,
        "accent_color_id": null,
        "active_usernames": null,
        "available_reactions": null,
        "background_custom_emoji_id": null,
        "bio": null,
        "birthdate": null,
        "business_intro": null,
        "business_location": null,
        "business_opening_hours": null,
        "can_set_sticker_set": null,
        "custom_emoji_sticker_set_name": null,
        "description": null,
        "emoji_status_custom_emoji_id": null,
        "emoji_status_expiration_date": null,
        "has_aggressive_anti_spam_enabled": null,
        "has_hidden_members": null,
        "has_private_forwards": null,
        "has_protected_content": null,
        "has_restricted_voice_and_video_messages": null,
        "has_visible_history": null,
        "invite_link": null,
        "join_by_request": null,
        "join_to_send_messages": null,
        "linked_chat_id": null,
        "location": null,
        "message_auto_delete_time": null,
        "permissions": null,
        "personal_chat": null,
        "photo": null,
        "pinned_message": null,
        "profile_accent_color_id": null,
        "profile_background_custom_emoji_id": null,
        "slow_mode_delay": null,
        "sticker_set_name": null,
        "unrestrict_boost_count": null
    },
    "message_thread_id": null,
    "from_user": {
        "id": 528155210,
        "is_bot": false,
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "username": "dastroo",
        "language_code": "ru",
        "is_premium": null,
        "added_to_attachment_menu": null,
        "can_join_groups": null,
        "can_read_all_group_messages": null,
        "supports_inline_queries": null,
        "can_connect_to_business": null,
        "has_main_web_app": null
    },
    "sender_chat": null,
    "sender_boost_count": null,
    "sender_business_bot": null,
    "business_connection_id": null,
    "forward_origin": null,
    "is_topic_message": null,
    "is_automatic_forward": null,
    "reply_to_message": null,
    "external_reply": null,
    "quote": null,
    "reply_to_story": null,
    "via_bot": null,
    "edit_date": null,
    "has_protected_content": null,
    "is_from_offline": null,
    "media_group_id": null,
    "author_signature": null,
    "text": null,
    "entities": null,
    "link_preview_options": null,
    "effect_id": null,
    "animation": null,
    "audio": null,
    "document": null,
    "paid_media": null,
    "photo": null,
    "sticker": null,
    "story": null,
    "video": null,
    "video_note": null,
    "voice": null,
    "caption": null,
    "caption_entities": null,
    "show_caption_above_media": null,
    "has_media_spoiler": null,
    "contact": null,
    "dice": null,
    "game": null,
    "poll": null,
    "venue": null,
    "location": null,
    "new_chat_members": null,
    "left_chat_member": null,
    "new_chat_title": null,
    "new_chat_photo": null,
    "delete_chat_photo": null,
    "group_chat_created": null,
    "supergroup_chat_created": null,
    "channel_chat_created": null,
    "message_auto_delete_timer_changed": null,
    "migrate_to_chat_id": null,
    "migrate_from_chat_id": null,
    "pinned_message": null,
    "invoice": null,
    "successful_payment": {
        "currency": "RUB",
        "total_amount": 14000,
        "invoice_payload": "517e1f38-331b-489c-812f-50ec214165d2",
        "telegram_payment_charge_id": "7444575424_528155210_340606",
        "provider_payment_charge_id": "7444575424_528155210_340606",
        "subscription_expiration_date": null,
        "is_recurring": null,
        "is_first_recurring": null,
        "shipping_option_id": null,
        "order_info": null
    },
    "refunded_payment": null,
    "users_shared": null,
    "chat_shared": null,
    "connected_website": null,
    "write_access_allowed": null,
    "passport_data": null,
    "proximity_alert_triggered": null,
    "boost_added": null,
    "chat_background_set": null,
    "forum_topic_created": null,
    "forum_topic_edited": null,
    "forum_topic_closed": null,
    "forum_topic_reopened": null,
    "general_forum_topic_hidden": null,
    "general_forum_topic_unhidden": null,
    "giveaway_created": null,
    "giveaway": null,
    "giveaway_winners": null,
    "giveaway_completed": null,
    "video_chat_scheduled": null,
    "video_chat_started": null,
    "video_chat_ended": null,
    "video_chat_participants_invited": null,
    "web_app_data": null,
    "reply_markup": null,
    "forward_date": null,
    "forward_from": null,
    "forward_from_chat": null,
    "forward_from_message_id": null,
    "forward_sender_name": null,
    "forward_signature": null,
    "user_shared": null
}
2024-12-22 13:04:44,830 - root - INFO - Key created: OutlineKey(key_id='99', name='VPN Key57', password='hMKsYerDqscrlxblpoJdV0', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpoTUtzWWVyRHFzY3JseGJscG9KZFYw@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 528155210
2024-12-22 13:04:44,962 - root - INFO - Key created: OutlineKey(key_id='99', name='VPN Key57', password='hMKsYerDqscrlxblpoJdV0', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpoTUtzWWVyRHFzY3JseGJscG9KZFYw@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2024-12-22 13:04:45,105 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:04:45,106 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:04:45,108 - sqlalchemy.engine.Engine - INFO - [cached since 1256s ago] ('528155210', 1, 0)
2024-12-22 13:04:45,116 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2024-12-22 13:04:45,116 - sqlalchemy.engine.Engine - INFO - [generated in 0.00081s] ('99', '528155210', '2025-03-22 13:04:45.112587', '2024-12-22 13:04:45.112587', 0)
2024-12-22 13:04:45,119 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 13:04:45,128 - aiogram.event - INFO - Update id=659309020 is handled. Duration 1625 ms by bot id=7444575424
2024-12-22 13:05:03,543 - aiogram.event - INFO - Update id=659309021 is handled. Duration 390 ms by bot id=7444575424
2024-12-22 13:05:27,208 - aiogram.event - INFO - Update id=659309022 is handled. Duration 625 ms by bot id=7444575424
2024-12-22 13:05:28,606 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:05:28,606 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:05:28,606 - sqlalchemy.engine.Engine - INFO - [cached since 1300s ago] ('528155210', 1, 0)
2024-12-22 13:05:28,607 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 13:05:28,607 - sqlalchemy.engine.Engine - INFO - [cached since 1304s ago] ('528155210',)
2024-12-22 13:05:30,898 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 13:05:30,959 - aiogram.event - INFO - Update id=659309023 is handled. Duration 2343 ms by bot id=7444575424
2024-12-22 13:05:33,142 - aiogram.event - INFO - Update id=659309024 is handled. Duration 139 ms by bot id=7444575424
2024-12-22 13:05:43,256 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:05:43,256 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:05:43,257 - sqlalchemy.engine.Engine - INFO - [cached since 1314s ago] ('528155210', 1, 0)
2024-12-22 13:05:43,259 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 13:05:43,259 - sqlalchemy.engine.Engine - INFO - [cached since 1318s ago] ('528155210',)
2024-12-22 13:05:45,448 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 13:05:45,548 - aiogram.event - INFO - Update id=659309025 is handled. Duration 2296 ms by bot id=7444575424
2024-12-22 13:05:50,035 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:05:50,035 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:05:50,035 - sqlalchemy.engine.Engine - INFO - [cached since 1318s ago] ('99', 1, 0)
2024-12-22 13:05:50,174 - aiogram.event - INFO - Update id=659309026 is handled. Duration 1327 ms by bot id=7444575424
2024-12-22 13:05:57,226 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:05:57,228 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:05:57,229 - sqlalchemy.engine.Engine - INFO - [cached since 1325s ago] ('99', 1, 0)
2024-12-22 13:05:58,636 - aiogram.event - INFO - Update id=659309027 is handled. Duration 1421 ms by bot id=7444575424
2024-12-22 13:06:04,982 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:06:04,983 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:06:04,983 - sqlalchemy.engine.Engine - INFO - [cached since 1333s ago] ('99', 1, 0)
2024-12-22 13:06:05,131 - aiogram.event - INFO - Update id=659309028 is handled. Duration 1656 ms by bot id=7444575424
2024-12-22 13:06:07,141 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:06:07,142 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:06:07,142 - sqlalchemy.engine.Engine - INFO - [cached since 1335s ago] ('99', 1, 0)
2024-12-22 13:06:07,232 - aiogram.event - INFO - Update id=659309029 is handled. Duration 93 ms by bot id=7444575424
2024-12-22 13:06:15,961 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:06:15,962 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:06:15,962 - sqlalchemy.engine.Engine - INFO - [cached since 1344s ago] ('99', 1, 0)
2024-12-22 13:06:16,082 - aiogram.event - INFO - Update id=659309030 is handled. Duration 1468 ms by bot id=7444575424
2024-12-22 13:06:21,420 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:06:21,420 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:06:21,421 - sqlalchemy.engine.Engine - INFO - [cached since 1349s ago] ('99', 1, 0)
2024-12-22 13:06:22,878 - aiogram.event - INFO - Update id=659309031 is handled. Duration 1468 ms by bot id=7444575424
2024-12-22 13:06:27,609 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:06:27,610 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:06:27,610 - sqlalchemy.engine.Engine - INFO - [cached since 1355s ago] ('99', 1, 0)
2024-12-22 13:06:27,855 - aiogram.event - INFO - Update id=659309032 is handled. Duration 1250 ms by bot id=7444575424
2024-12-22 13:06:36,163 - aiogram.event - INFO - Update id=659309033 is handled. Duration 109 ms by bot id=7444575424
2024-12-22 13:06:47,716 - aiogram.event - INFO - Update id=659309034 is handled. Duration 141 ms by bot id=7444575424
2024-12-22 13:06:51,792 - aiogram.event - INFO - Update id=659309035 is handled. Duration 93 ms by bot id=7444575424
2024-12-22 13:06:54,263 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:06:54,264 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:06:54,264 - sqlalchemy.engine.Engine - INFO - [cached since 1382s ago] ('99', 1, 0)
2024-12-22 13:06:54,441 - aiogram.event - INFO - Update id=659309036 is handled. Duration 1546 ms by bot id=7444575424
2024-12-22 13:06:59,652 - aiogram.event - INFO - Update id=659309037 is handled. Duration 156 ms by bot id=7444575424
2024-12-22 13:07:03,428 - aiogram.event - INFO - Update id=659309038 is handled. Duration 110 ms by bot id=7444575424
2024-12-22 13:07:05,145 - aiogram.event - INFO - Update id=659309039 is handled. Duration 93 ms by bot id=7444575424
2024-12-22 13:07:07,957 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:07:07,963 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:07:07,965 - sqlalchemy.engine.Engine - INFO - [cached since 1396s ago] ('99', 1, 0)
2024-12-22 13:07:08,148 - aiogram.event - INFO - Update id=659309040 is handled. Duration 2000 ms by bot id=7444575424
2024-12-22 13:07:10,178 - aiogram.event - INFO - Update id=659309041 is handled. Duration 93 ms by bot id=7444575424
2024-12-22 13:07:13,234 - aiogram.event - INFO - Update id=659309042 is handled. Duration 218 ms by bot id=7444575424
2024-12-22 13:07:14,283 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:07:14,284 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:07:14,285 - sqlalchemy.engine.Engine - INFO - [cached since 1402s ago] ('99', 1, 0)
2024-12-22 13:07:14,288 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 13:07:14,291 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:07:14,295 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-22 13:07:14,296 - sqlalchemy.engine.Engine - INFO - [generated in 0.00105s] ('99',)
2024-12-22 13:07:15,091 - aiogram.event - INFO - Update id=659309043 is handled. Duration 828 ms by bot id=7444575424
2024-12-22 13:07:17,167 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:07:17,169 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:07:17,170 - sqlalchemy.engine.Engine - INFO - [cached since 1405s ago] ('99', 1, 0)
2024-12-22 13:07:17,325 - aiogram.event - INFO - Update id=659309044 is handled. Duration 1108 ms by bot id=7444575424
2024-12-22 13:07:26,289 - aiogram.event - INFO - Update id=659309045 is handled. Duration 125 ms by bot id=7444575424
2024-12-22 13:07:29,600 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:07:29,602 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:07:29,604 - sqlalchemy.engine.Engine - INFO - [cached since 1417s ago] ('99', 1, 0)
2024-12-22 13:07:29,973 - aiogram.event - INFO - Update id=659309046 is handled. Duration 2000 ms by bot id=7444575424
2024-12-22 13:07:32,214 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:07:32,215 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:07:32,216 - sqlalchemy.engine.Engine - INFO - [cached since 1420s ago] ('99', 1, 0)
2024-12-22 13:07:32,312 - aiogram.event - INFO - Update id=659309047 is handled. Duration 108 ms by bot id=7444575424
2024-12-22 13:07:35,939 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:07:35,940 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:07:35,941 - sqlalchemy.engine.Engine - INFO - [cached since 1424s ago] ('99', 1, 0)
2024-12-22 13:07:36,164 - aiogram.event - INFO - Update id=659309048 is handled. Duration 1422 ms by bot id=7444575424
2024-12-22 13:07:43,101 - aiogram.event - INFO - Update id=659309049 is handled. Duration 78 ms by bot id=7444575424
2024-12-22 13:07:50,196 - aiogram.event - INFO - Update id=659309050 is handled. Duration 342 ms by bot id=7444575424
2024-12-22 13:08:06,020 - aiogram.event - INFO - Update id=659309051 is handled. Duration 203 ms by bot id=7444575424
2024-12-22 13:08:13,585 - root - INFO - {
    "message_id": 4376,
    "date": 1734862095,
    "chat": {
        "id": 528155210,
        "type": "private",
        "title": null,
        "username": "dastroo",
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "is_forum": null,
        "accent_color_id": null,
        "active_usernames": null,
        "available_reactions": null,
        "background_custom_emoji_id": null,
        "bio": null,
        "birthdate": null,
        "business_intro": null,
        "business_location": null,
        "business_opening_hours": null,
        "can_set_sticker_set": null,
        "custom_emoji_sticker_set_name": null,
        "description": null,
        "emoji_status_custom_emoji_id": null,
        "emoji_status_expiration_date": null,
        "has_aggressive_anti_spam_enabled": null,
        "has_hidden_members": null,
        "has_private_forwards": null,
        "has_protected_content": null,
        "has_restricted_voice_and_video_messages": null,
        "has_visible_history": null,
        "invite_link": null,
        "join_by_request": null,
        "join_to_send_messages": null,
        "linked_chat_id": null,
        "location": null,
        "message_auto_delete_time": null,
        "permissions": null,
        "personal_chat": null,
        "photo": null,
        "pinned_message": null,
        "profile_accent_color_id": null,
        "profile_background_custom_emoji_id": null,
        "slow_mode_delay": null,
        "sticker_set_name": null,
        "unrestrict_boost_count": null
    },
    "message_thread_id": null,
    "from_user": {
        "id": 528155210,
        "is_bot": false,
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "username": "dastroo",
        "language_code": "ru",
        "is_premium": null,
        "added_to_attachment_menu": null,
        "can_join_groups": null,
        "can_read_all_group_messages": null,
        "supports_inline_queries": null,
        "can_connect_to_business": null,
        "has_main_web_app": null
    },
    "sender_chat": null,
    "sender_boost_count": null,
    "sender_business_bot": null,
    "business_connection_id": null,
    "forward_origin": null,
    "is_topic_message": null,
    "is_automatic_forward": null,
    "reply_to_message": null,
    "external_reply": null,
    "quote": null,
    "reply_to_story": null,
    "via_bot": null,
    "edit_date": null,
    "has_protected_content": null,
    "is_from_offline": null,
    "media_group_id": null,
    "author_signature": null,
    "text": null,
    "entities": null,
    "link_preview_options": null,
    "effect_id": null,
    "animation": null,
    "audio": null,
    "document": null,
    "paid_media": null,
    "photo": null,
    "sticker": null,
    "story": null,
    "video": null,
    "video_note": null,
    "voice": null,
    "caption": null,
    "caption_entities": null,
    "show_caption_above_media": null,
    "has_media_spoiler": null,
    "contact": null,
    "dice": null,
    "game": null,
    "poll": null,
    "venue": null,
    "location": null,
    "new_chat_members": null,
    "left_chat_member": null,
    "new_chat_title": null,
    "new_chat_photo": null,
    "delete_chat_photo": null,
    "group_chat_created": null,
    "supergroup_chat_created": null,
    "channel_chat_created": null,
    "message_auto_delete_timer_changed": null,
    "migrate_to_chat_id": null,
    "migrate_from_chat_id": null,
    "pinned_message": null,
    "invoice": null,
    "successful_payment": {
        "currency": "RUB",
        "total_amount": 14000,
        "invoice_payload": "979b1752-22d2-4bf3-9f5f-b2032c5d7918",
        "telegram_payment_charge_id": "7444575424_528155210_340615",
        "provider_payment_charge_id": "7444575424_528155210_340615",
        "subscription_expiration_date": null,
        "is_recurring": null,
        "is_first_recurring": null,
        "shipping_option_id": null,
        "order_info": null
    },
    "refunded_payment": null,
    "users_shared": null,
    "chat_shared": null,
    "connected_website": null,
    "write_access_allowed": null,
    "passport_data": null,
    "proximity_alert_triggered": null,
    "boost_added": null,
    "chat_background_set": null,
    "forum_topic_created": null,
    "forum_topic_edited": null,
    "forum_topic_closed": null,
    "forum_topic_reopened": null,
    "general_forum_topic_hidden": null,
    "general_forum_topic_unhidden": null,
    "giveaway_created": null,
    "giveaway": null,
    "giveaway_winners": null,
    "giveaway_completed": null,
    "video_chat_scheduled": null,
    "video_chat_started": null,
    "video_chat_ended": null,
    "video_chat_participants_invited": null,
    "web_app_data": null,
    "reply_markup": null,
    "forward_date": null,
    "forward_from": null,
    "forward_from_chat": null,
    "forward_from_message_id": null,
    "forward_sender_name": null,
    "forward_signature": null,
    "user_shared": null
}
2024-12-22 13:08:13,720 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:08:13,721 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:08:13,722 - sqlalchemy.engine.Engine - INFO - [cached since 1462s ago] ('99', 1, 0)
2024-12-22 13:08:13,727 - sqlalchemy.engine.Engine - INFO - UPDATE keys SET expiration_date=? WHERE keys.key_id = ?
2024-12-22 13:08:13,728 - sqlalchemy.engine.Engine - INFO - [generated in 0.00117s] ('2025-06-23 13:04:45.112587', '99')
2024-12-22 13:08:13,730 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 13:08:13,746 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:08:13,747 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-22 13:08:13,748 - sqlalchemy.engine.Engine - INFO - [cached since 59.45s ago] ('99',)
2024-12-22 13:08:13,750 - root - INFO - Ключ с ID 99 успешно продлён на 93 дней. Новая дата окончания: 2025-06-23 13:04:45.112587
2024-12-22 13:08:13,750 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 13:08:13,751 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:08:13,752 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:08:13,752 - sqlalchemy.engine.Engine - INFO - [cached since 1462s ago] ('99', 1, 0)
2024-12-22 13:08:16,698 - aiogram.event - INFO - Update id=659309052 is handled. Duration 3125 ms by bot id=7444575424
2024-12-22 13:08:24,438 - aiogram.event - INFO - Update id=659309053 is handled. Duration 171 ms by bot id=7444575424
2024-12-22 13:08:25,740 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:08:25,741 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:08:25,741 - sqlalchemy.engine.Engine - INFO - [cached since 1477s ago] ('528155210', 1, 0)
2024-12-22 13:08:25,742 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 13:08:25,742 - sqlalchemy.engine.Engine - INFO - [cached since 1481s ago] ('528155210',)
2024-12-22 13:08:27,748 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 13:08:27,812 - aiogram.event - INFO - Update id=659309054 is handled. Duration 2077 ms by bot id=7444575424
2024-12-22 13:08:29,713 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:08:29,713 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:08:29,714 - sqlalchemy.engine.Engine - INFO - [cached since 1478s ago] ('99', 1, 0)
2024-12-22 13:08:29,863 - aiogram.event - INFO - Update id=659309055 is handled. Duration 1312 ms by bot id=7444575424
2024-12-22 13:08:31,870 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:08:31,870 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:08:31,870 - sqlalchemy.engine.Engine - INFO - [cached since 1480s ago] ('99', 1, 0)
2024-12-22 13:08:31,943 - aiogram.event - INFO - Update id=659309056 is handled. Duration 77 ms by bot id=7444575424
2024-12-22 13:08:51,558 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:08:51,559 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:08:51,559 - sqlalchemy.engine.Engine - INFO - [cached since 1499s ago] ('99', 1, 0)
2024-12-22 13:08:51,753 - aiogram.event - INFO - Update id=659309057 is handled. Duration 1297 ms by bot id=7444575424
2024-12-22 13:08:54,391 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:08:54,391 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:08:54,392 - sqlalchemy.engine.Engine - INFO - [cached since 1505s ago] ('528155210', 1, 0)
2024-12-22 13:08:54,394 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 13:08:54,394 - sqlalchemy.engine.Engine - INFO - [cached since 1510s ago] ('528155210',)
2024-12-22 13:08:56,380 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 13:08:56,380 - aiogram.event - INFO - Update id=659309058 is handled. Duration 1985 ms by bot id=7444575424
2024-12-22 13:08:58,425 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:08:58,425 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:08:58,425 - sqlalchemy.engine.Engine - INFO - [cached since 1506s ago] ('98', 1, 0)
2024-12-22 13:08:58,553 - aiogram.event - INFO - Update id=659309059 is handled. Duration 1093 ms by bot id=7444575424
2024-12-22 13:09:00,425 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:09:00,425 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:09:00,425 - sqlalchemy.engine.Engine - INFO - [cached since 1508s ago] ('98', 1, 0)
2024-12-22 13:09:00,553 - aiogram.event - INFO - Update id=659309060 is handled. Duration 125 ms by bot id=7444575424
2024-12-22 13:09:05,390 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:09:05,390 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:09:05,391 - sqlalchemy.engine.Engine - INFO - [cached since 1513s ago] ('98', 1, 0)
2024-12-22 13:09:05,533 - aiogram.event - INFO - Update id=659309061 is handled. Duration 1219 ms by bot id=7444575424
2024-12-22 13:09:06,897 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:09:06,898 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:09:06,898 - sqlalchemy.engine.Engine - INFO - [cached since 1518s ago] ('528155210', 1, 0)
2024-12-22 13:09:06,899 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 13:09:06,899 - sqlalchemy.engine.Engine - INFO - [cached since 1522s ago] ('528155210',)
2024-12-22 13:09:09,129 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 13:09:09,129 - aiogram.event - INFO - Update id=659309062 is handled. Duration 2235 ms by bot id=7444575424
2024-12-22 13:09:14,126 - aiogram.event - INFO - Update id=659309063 is handled. Duration 203 ms by bot id=7444575424
2024-12-22 13:09:30,954 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:09:30,956 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:09:30,956 - sqlalchemy.engine.Engine - INFO - [cached since 1542s ago] ('528155210', 1, 0)
2024-12-22 13:09:30,957 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 13:09:30,958 - sqlalchemy.engine.Engine - INFO - [cached since 1546s ago] ('528155210',)
2024-12-22 13:09:34,095 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 13:09:34,237 - aiogram.event - INFO - Update id=659309064 is handled. Duration 3281 ms by bot id=7444575424
2024-12-22 13:09:35,484 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:09:35,485 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:09:35,486 - sqlalchemy.engine.Engine - INFO - [cached since 1543s ago] ('98', 1, 0)
2024-12-22 13:09:35,790 - aiogram.event - INFO - Update id=659309065 is handled. Duration 1484 ms by bot id=7444575424
2024-12-22 13:09:37,388 - aiogram.event - INFO - Update id=659309066 is handled. Duration 218 ms by bot id=7444575424
2024-12-22 13:09:41,324 - aiogram.event - INFO - Update id=659309067 is handled. Duration 93 ms by bot id=7444575424
2024-12-22 13:09:43,291 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:09:43,293 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:09:43,293 - sqlalchemy.engine.Engine - INFO - [cached since 1551s ago] ('98', 1, 0)
2024-12-22 13:09:43,295 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 13:09:43,296 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:09:43,297 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-22 13:09:43,298 - sqlalchemy.engine.Engine - INFO - [cached since 149s ago] ('98',)
2024-12-22 13:09:43,601 - aiogram.event - INFO - Update id=659309068 is handled. Duration 312 ms by bot id=7444575424
2024-12-22 13:09:45,994 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:09:45,995 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:09:45,995 - sqlalchemy.engine.Engine - INFO - [cached since 1554s ago] ('98', 1, 0)
2024-12-22 13:09:46,114 - aiogram.event - INFO - Update id=659309069 is handled. Duration 1139 ms by bot id=7444575424
2024-12-22 13:09:47,605 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:09:47,606 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:09:47,607 - sqlalchemy.engine.Engine - INFO - [cached since 1559s ago] ('528155210', 1, 0)
2024-12-22 13:09:47,609 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 13:09:47,610 - sqlalchemy.engine.Engine - INFO - [cached since 1563s ago] ('528155210',)
2024-12-22 13:09:49,640 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 13:09:49,642 - aiogram.event - INFO - Update id=659309070 is handled. Duration 2046 ms by bot id=7444575424
2024-12-22 13:09:51,138 - aiogram.event - INFO - Update id=659309071 is handled. Duration 343 ms by bot id=7444575424
2024-12-22 13:09:58,284 - aiogram.dispatcher - INFO - Polling stopped
2024-12-22 13:09:58,539 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 13:09:58,550 - root - INFO - Бот остановлен вручную.
2024-12-22 13:10:34,369 - root - INFO - Инициализация бота...
2024-12-22 13:10:35,509 - root - INFO - Инициализация бота...
2024-12-22 13:10:35,606 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:10:35,607 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-22 13:10:35,607 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 13:10:35,609 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-22 13:10:35,609 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 13:10:35,611 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 13:10:35,679 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-22 13:10:35,679 - root - INFO - Инициализация диспетчера...
2024-12-22 13:10:35,681 - root - INFO - Регистрация обработчиков...
2024-12-22 13:10:35,683 - root - INFO - Регистрация main menu команд...
2024-12-22 13:10:37,215 - root - INFO - Команды успешно установлены
2024-12-22 13:10:37,215 - root - INFO - Запуск polling...
2024-12-22 13:10:37,216 - aiogram.dispatcher - INFO - Start polling
2024-12-22 13:10:37,226 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:10:37,230 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-22 13:10:37,230 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] ()
2024-12-22 13:10:37,237 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 13:10:37,237 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ('528155210',)
2024-12-22 13:10:38,468 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 13:10:38,470 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:10:38,472 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-22 13:10:38,472 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ('99',)
2024-12-22 13:10:39,719 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 13:10:39,719 - sqlalchemy.engine.Engine - INFO - [generated in 0.00075s] ('528155210',)
2024-12-22 13:10:39,783 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 13:10:55,907 - aiogram.event - INFO - Update id=659309072 is handled. Duration 234 ms by bot id=7444575424
2024-12-22 13:11:02,289 - aiogram.event - INFO - Update id=659309073 is handled. Duration 766 ms by bot id=7444575424
2024-12-22 13:11:17,338 - aiogram.event - INFO - Update id=659309074 is handled. Duration 78 ms by bot id=7444575424
2024-12-22 13:11:26,897 - root - INFO - {
    "message_id": 4382,
    "date": 1734862288,
    "chat": {
        "id": 528155210,
        "type": "private",
        "title": null,
        "username": "dastroo",
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "is_forum": null,
        "accent_color_id": null,
        "active_usernames": null,
        "available_reactions": null,
        "background_custom_emoji_id": null,
        "bio": null,
        "birthdate": null,
        "business_intro": null,
        "business_location": null,
        "business_opening_hours": null,
        "can_set_sticker_set": null,
        "custom_emoji_sticker_set_name": null,
        "description": null,
        "emoji_status_custom_emoji_id": null,
        "emoji_status_expiration_date": null,
        "has_aggressive_anti_spam_enabled": null,
        "has_hidden_members": null,
        "has_private_forwards": null,
        "has_protected_content": null,
        "has_restricted_voice_and_video_messages": null,
        "has_visible_history": null,
        "invite_link": null,
        "join_by_request": null,
        "join_to_send_messages": null,
        "linked_chat_id": null,
        "location": null,
        "message_auto_delete_time": null,
        "permissions": null,
        "personal_chat": null,
        "photo": null,
        "pinned_message": null,
        "profile_accent_color_id": null,
        "profile_background_custom_emoji_id": null,
        "slow_mode_delay": null,
        "sticker_set_name": null,
        "unrestrict_boost_count": null
    },
    "message_thread_id": null,
    "from_user": {
        "id": 528155210,
        "is_bot": false,
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "username": "dastroo",
        "language_code": "ru",
        "is_premium": null,
        "added_to_attachment_menu": null,
        "can_join_groups": null,
        "can_read_all_group_messages": null,
        "supports_inline_queries": null,
        "can_connect_to_business": null,
        "has_main_web_app": null
    },
    "sender_chat": null,
    "sender_boost_count": null,
    "sender_business_bot": null,
    "business_connection_id": null,
    "forward_origin": null,
    "is_topic_message": null,
    "is_automatic_forward": null,
    "reply_to_message": null,
    "external_reply": null,
    "quote": null,
    "reply_to_story": null,
    "via_bot": null,
    "edit_date": null,
    "has_protected_content": null,
    "is_from_offline": null,
    "media_group_id": null,
    "author_signature": null,
    "text": null,
    "entities": null,
    "link_preview_options": null,
    "effect_id": null,
    "animation": null,
    "audio": null,
    "document": null,
    "paid_media": null,
    "photo": null,
    "sticker": null,
    "story": null,
    "video": null,
    "video_note": null,
    "voice": null,
    "caption": null,
    "caption_entities": null,
    "show_caption_above_media": null,
    "has_media_spoiler": null,
    "contact": null,
    "dice": null,
    "game": null,
    "poll": null,
    "venue": null,
    "location": null,
    "new_chat_members": null,
    "left_chat_member": null,
    "new_chat_title": null,
    "new_chat_photo": null,
    "delete_chat_photo": null,
    "group_chat_created": null,
    "supergroup_chat_created": null,
    "channel_chat_created": null,
    "message_auto_delete_timer_changed": null,
    "migrate_to_chat_id": null,
    "migrate_from_chat_id": null,
    "pinned_message": null,
    "invoice": null,
    "successful_payment": {
        "currency": "RUB",
        "total_amount": 5000,
        "invoice_payload": "eb744459-dc7b-492e-8769-9d08a975e7e7",
        "telegram_payment_charge_id": "7444575424_528155210_340621",
        "provider_payment_charge_id": "7444575424_528155210_340621",
        "subscription_expiration_date": null,
        "is_recurring": null,
        "is_first_recurring": null,
        "shipping_option_id": null,
        "order_info": null
    },
    "refunded_payment": null,
    "users_shared": null,
    "chat_shared": null,
    "connected_website": null,
    "write_access_allowed": null,
    "passport_data": null,
    "proximity_alert_triggered": null,
    "boost_added": null,
    "chat_background_set": null,
    "forum_topic_created": null,
    "forum_topic_edited": null,
    "forum_topic_closed": null,
    "forum_topic_reopened": null,
    "general_forum_topic_hidden": null,
    "general_forum_topic_unhidden": null,
    "giveaway_created": null,
    "giveaway": null,
    "giveaway_winners": null,
    "giveaway_completed": null,
    "video_chat_scheduled": null,
    "video_chat_started": null,
    "video_chat_ended": null,
    "video_chat_participants_invited": null,
    "web_app_data": null,
    "reply_markup": null,
    "forward_date": null,
    "forward_from": null,
    "forward_from_chat": null,
    "forward_from_message_id": null,
    "forward_sender_name": null,
    "forward_signature": null,
    "user_shared": null
}
2024-12-22 13:11:26,991 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:11:26,994 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:11:26,994 - sqlalchemy.engine.Engine - INFO - [generated in 0.00091s] ('98', 1, 0)
2024-12-22 13:11:27,002 - sqlalchemy.engine.Engine - INFO - UPDATE keys SET expiration_date=? WHERE keys.key_id = ?
2024-12-22 13:11:27,002 - sqlalchemy.engine.Engine - INFO - [generated in 0.00068s] ('2025-01-24 12:41:26.780159', '98')
2024-12-22 13:11:27,005 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 13:11:27,059 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:11:27,060 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-22 13:11:27,060 - sqlalchemy.engine.Engine - INFO - [cached since 48.59s ago] ('98',)
2024-12-22 13:11:27,062 - root - INFO - Ключ с ID 98 успешно продлён на 31 дней. Новая дата окончания: 2025-01-24 12:41:26.780159
2024-12-22 13:11:27,063 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 13:11:27,064 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:11:27,066 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:11:27,066 - sqlalchemy.engine.Engine - INFO - [cached since 0.07261s ago] ('98', 1, 0)
2024-12-22 13:11:29,022 - aiogram.event - INFO - Update id=659309075 is handled. Duration 2125 ms by bot id=7444575424
2024-12-22 13:11:33,845 - aiogram.event - INFO - Update id=659309076 is handled. Duration 141 ms by bot id=7444575424
2024-12-22 13:11:36,554 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:11:36,556 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:11:36,556 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('528155210', 1, 0)
2024-12-22 13:11:36,558 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 13:11:36,558 - sqlalchemy.engine.Engine - INFO - [cached since 59.32s ago] ('528155210',)
2024-12-22 13:11:39,366 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 13:11:39,509 - aiogram.event - INFO - Update id=659309077 is handled. Duration 2953 ms by bot id=7444575424
2024-12-22 13:11:43,154 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:11:43,154 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:11:43,154 - sqlalchemy.engine.Engine - INFO - [cached since 16.16s ago] ('98', 1, 0)
2024-12-22 13:11:43,403 - aiogram.event - INFO - Update id=659309078 is handled. Duration 1891 ms by bot id=7444575424
2024-12-22 13:11:44,924 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:11:44,925 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:11:44,925 - sqlalchemy.engine.Engine - INFO - [cached since 17.93s ago] ('98', 1, 0)
2024-12-22 13:11:45,062 - aiogram.event - INFO - Update id=659309079 is handled. Duration 139 ms by bot id=7444575424
2024-12-22 13:11:55,944 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:11:55,944 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:11:55,944 - sqlalchemy.engine.Engine - INFO - [cached since 28.95s ago] ('98', 1, 0)
2024-12-22 13:11:56,128 - aiogram.event - INFO - Update id=659309080 is handled. Duration 1328 ms by bot id=7444575424
2024-12-22 13:11:59,133 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 13:11:59,134 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 13:11:59,134 - sqlalchemy.engine.Engine - INFO - [cached since 22.58s ago] ('528155210', 1, 0)
2024-12-22 13:11:59,136 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-22 13:11:59,137 - sqlalchemy.engine.Engine - INFO - [cached since 81.9s ago] ('528155210',)
2024-12-22 13:12:01,759 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-22 13:12:01,760 - aiogram.event - INFO - Update id=659309081 is handled. Duration 2639 ms by bot id=7444575424
2024-12-22 13:21:05,250 - aiogram.dispatcher - INFO - Polling stopped
2024-12-22 13:23:57,134 - root - INFO - Инициализация бота...
2024-12-22 23:27:49,027 - root - INFO - Инициализация бота...
2024-12-22 23:27:50,988 - root - INFO - Инициализация бота...
2024-12-22 23:27:51,245 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 23:27:51,246 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-22 23:27:51,247 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 23:27:51,251 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2024-12-22 23:27:51,251 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 23:27:51,251 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-22 23:27:51,252 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 23:27:51,252 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("keys")
2024-12-22 23:27:51,252 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-22 23:27:51,253 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	user_telegram_id VARCHAR NOT NULL, 
	subscription_status VARCHAR, 
	use_trial_period BOOLEAN, 
	PRIMARY KEY (user_telegram_id)
)


2024-12-22 23:27:51,253 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2024-12-22 23:27:51,266 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE keys (
	key_id VARCHAR NOT NULL, 
	user_telegram_id VARCHAR, 
	expiration_date DATETIME, 
	start_date DATETIME, 
	remembering_before_exp BOOLEAN, 
	PRIMARY KEY (key_id), 
	FOREIGN KEY(user_telegram_id) REFERENCES users (user_telegram_id)
)


2024-12-22 23:27:51,266 - sqlalchemy.engine.Engine - INFO - [no key 0.00040s] ()
2024-12-22 23:27:51,275 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 23:27:51,369 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-22 23:27:51,370 - root - INFO - Инициализация диспетчера...
2024-12-22 23:27:51,371 - root - INFO - Регистрация обработчиков...
2024-12-22 23:27:51,373 - root - INFO - Регистрация main menu команд...
2024-12-22 23:27:51,781 - root - INFO - Команды успешно установлены
2024-12-22 23:27:51,781 - root - INFO - Запуск polling...
2024-12-22 23:27:51,781 - aiogram.dispatcher - INFO - Start polling
2024-12-22 23:27:51,790 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 23:27:51,794 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-22 23:27:51,794 - sqlalchemy.engine.Engine - INFO - [generated in 0.00057s] ()
2024-12-22 23:27:51,859 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-22 23:27:52,335 - aiogram.event - INFO - Update id=659309082 is handled. Duration 358 ms by bot id=7444575424
2024-12-22 23:27:52,336 - aiogram.event - INFO - Update id=659309083 is handled. Duration 358 ms by bot id=7444575424
2024-12-22 23:28:06,177 - aiogram.event - INFO - Update id=659309084 is handled. Duration 187 ms by bot id=7444575424
2024-12-22 23:28:13,647 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 23:28:13,654 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-22 23:28:13,655 - sqlalchemy.engine.Engine - INFO - [generated in 0.00093s] ('432629636', 1, 0)
2024-12-22 23:28:13,663 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (user_telegram_id, subscription_status, use_trial_period) VALUES (?, ?, ?)
2024-12-22 23:28:13,664 - sqlalchemy.engine.Engine - INFO - [generated in 0.00107s] ('432629636', 'active', 0)
2024-12-22 23:28:13,668 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 23:28:13,679 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 23:28:13,682 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-22 23:28:13,682 - sqlalchemy.engine.Engine - INFO - [generated in 0.00072s] ('432629636',)
2024-12-22 23:28:13,689 - sqlalchemy.engine.Engine - INFO - UPDATE users SET use_trial_period=? WHERE users.user_telegram_id = ?
2024-12-22 23:28:13,690 - sqlalchemy.engine.Engine - INFO - [generated in 0.00136s] (1, '432629636')
2024-12-22 23:28:13,692 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 23:28:15,163 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-22 23:28:15,166 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2024-12-22 23:28:15,166 - sqlalchemy.engine.Engine - INFO - [generated in 0.00088s] ('100', '432629636', '2024-12-24 23:28:15.162754', '2024-12-22 23:28:15.162754', 0)
2024-12-22 23:28:15,170 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-22 23:28:15,183 - root - INFO - Key created: OutlineKey(key_id='100', name='VPN Key58', password='k8mirEzNqqAMt0fB0k6dIr', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTprOG1pckV6TnFxQU10MGZCMGs2ZEly@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2024-12-22 23:28:15,326 - aiogram.event - INFO - Update id=659309085 is handled. Duration 1687 ms by bot id=7444575424
2024-12-22 23:29:00,476 - aiogram.event - INFO - Update id=659309086 is handled. Duration 500 ms by bot id=7444575424
2024-12-23 00:49:20,391 - root - INFO - Инициализация бота...
2024-12-23 00:49:21,922 - root - INFO - Инициализация бота...
2024-12-23 00:49:22,080 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:49:22,081 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-23 00:49:22,083 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 00:49:22,088 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-23 00:49:22,088 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 00:49:22,091 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 00:49:22,238 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-23 00:49:22,239 - root - INFO - Инициализация диспетчера...
2024-12-23 00:49:22,242 - root - INFO - Регистрация обработчиков...
2024-12-23 00:49:22,244 - root - INFO - Регистрация main menu команд...
2024-12-23 00:49:22,697 - root - INFO - Команды успешно установлены
2024-12-23 00:49:22,697 - root - INFO - Запуск polling...
2024-12-23 00:49:22,698 - aiogram.dispatcher - INFO - Start polling
2024-12-23 00:49:22,729 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:49:22,740 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-23 00:49:22,741 - sqlalchemy.engine.Engine - INFO - [generated in 0.00170s] ()
2024-12-23 00:49:22,760 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-23 00:49:22,762 - sqlalchemy.engine.Engine - INFO - [generated in 0.00181s] ('432629636',)
2024-12-23 00:49:23,993 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 00:49:23,996 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:49:24,001 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-23 00:49:24,002 - sqlalchemy.engine.Engine - INFO - [generated in 0.00173s] ('432629636',)
2024-12-23 00:49:24,082 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-23 00:49:41,933 - aiogram.event - INFO - Update id=659309087 is handled. Duration 375 ms by bot id=7444575424
2024-12-23 00:49:44,017 - aiogram.event - INFO - Update id=659309088 is handled. Duration 375 ms by bot id=7444575424
2024-12-23 00:49:56,978 - aiogram.event - INFO - Update id=659309089 is handled. Duration 141 ms by bot id=7444575424
2024-12-23 00:50:03,104 - root - INFO - {
    "message_id": 4390,
    "date": 1734904203,
    "chat": {
        "id": 432629636,
        "type": "private",
        "title": null,
        "username": "asaidar",
        "first_name": "Aydar",
        "last_name": null,
        "is_forum": null,
        "accent_color_id": null,
        "active_usernames": null,
        "available_reactions": null,
        "background_custom_emoji_id": null,
        "bio": null,
        "birthdate": null,
        "business_intro": null,
        "business_location": null,
        "business_opening_hours": null,
        "can_set_sticker_set": null,
        "custom_emoji_sticker_set_name": null,
        "description": null,
        "emoji_status_custom_emoji_id": null,
        "emoji_status_expiration_date": null,
        "has_aggressive_anti_spam_enabled": null,
        "has_hidden_members": null,
        "has_private_forwards": null,
        "has_protected_content": null,
        "has_restricted_voice_and_video_messages": null,
        "has_visible_history": null,
        "invite_link": null,
        "join_by_request": null,
        "join_to_send_messages": null,
        "linked_chat_id": null,
        "location": null,
        "message_auto_delete_time": null,
        "permissions": null,
        "personal_chat": null,
        "photo": null,
        "pinned_message": null,
        "profile_accent_color_id": null,
        "profile_background_custom_emoji_id": null,
        "slow_mode_delay": null,
        "sticker_set_name": null,
        "unrestrict_boost_count": null
    },
    "message_thread_id": null,
    "from_user": {
        "id": 432629636,
        "is_bot": false,
        "first_name": "Aydar",
        "last_name": null,
        "username": "asaidar",
        "language_code": "ru",
        "is_premium": null,
        "added_to_attachment_menu": null,
        "can_join_groups": null,
        "can_read_all_group_messages": null,
        "supports_inline_queries": null,
        "can_connect_to_business": null,
        "has_main_web_app": null
    },
    "sender_chat": null,
    "sender_boost_count": null,
    "sender_business_bot": null,
    "business_connection_id": null,
    "forward_origin": null,
    "is_topic_message": null,
    "is_automatic_forward": null,
    "reply_to_message": null,
    "external_reply": null,
    "quote": null,
    "reply_to_story": null,
    "via_bot": null,
    "edit_date": null,
    "has_protected_content": null,
    "is_from_offline": null,
    "media_group_id": null,
    "author_signature": null,
    "text": null,
    "entities": null,
    "link_preview_options": null,
    "effect_id": null,
    "animation": null,
    "audio": null,
    "document": null,
    "paid_media": null,
    "photo": null,
    "sticker": null,
    "story": null,
    "video": null,
    "video_note": null,
    "voice": null,
    "caption": null,
    "caption_entities": null,
    "show_caption_above_media": null,
    "has_media_spoiler": null,
    "contact": null,
    "dice": null,
    "game": null,
    "poll": null,
    "venue": null,
    "location": null,
    "new_chat_members": null,
    "left_chat_member": null,
    "new_chat_title": null,
    "new_chat_photo": null,
    "delete_chat_photo": null,
    "group_chat_created": null,
    "supergroup_chat_created": null,
    "channel_chat_created": null,
    "message_auto_delete_timer_changed": null,
    "migrate_to_chat_id": null,
    "migrate_from_chat_id": null,
    "pinned_message": null,
    "invoice": null,
    "successful_payment": {
        "currency": "RUB",
        "total_amount": 14000,
        "invoice_payload": "855ddd7a-f213-46b4-a38e-56541ed334a3",
        "telegram_payment_charge_id": "7444575424_432629636_620661",
        "provider_payment_charge_id": "7444575424_432629636_620661",
        "subscription_expiration_date": null,
        "is_recurring": null,
        "is_first_recurring": null,
        "shipping_option_id": null,
        "order_info": null
    },
    "refunded_payment": null,
    "users_shared": null,
    "chat_shared": null,
    "connected_website": null,
    "write_access_allowed": null,
    "passport_data": null,
    "proximity_alert_triggered": null,
    "boost_added": null,
    "chat_background_set": null,
    "forum_topic_created": null,
    "forum_topic_edited": null,
    "forum_topic_closed": null,
    "forum_topic_reopened": null,
    "general_forum_topic_hidden": null,
    "general_forum_topic_unhidden": null,
    "giveaway_created": null,
    "giveaway": null,
    "giveaway_winners": null,
    "giveaway_completed": null,
    "video_chat_scheduled": null,
    "video_chat_started": null,
    "video_chat_ended": null,
    "video_chat_participants_invited": null,
    "web_app_data": null,
    "reply_markup": null,
    "forward_date": null,
    "forward_from": null,
    "forward_from_chat": null,
    "forward_from_message_id": null,
    "forward_sender_name": null,
    "forward_signature": null,
    "user_shared": null
}
2024-12-23 00:50:03,223 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:50:03,225 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:50:03,226 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] ('100', 1, 0)
2024-12-23 00:50:03,230 - sqlalchemy.engine.Engine - INFO - UPDATE keys SET expiration_date=? WHERE keys.key_id = ?
2024-12-23 00:50:03,231 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] ('2025-03-27 23:28:15.162754', '100')
2024-12-23 00:50:03,237 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 00:50:03,249 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:50:03,251 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-23 00:50:03,252 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] ('100',)
2024-12-23 00:50:03,253 - root - INFO - Ключ с ID 100 успешно продлён на 93 дней. Новая дата окончания: 2025-03-27 23:28:15.162754
2024-12-23 00:50:03,254 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 00:50:03,280 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:50:03,281 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:50:03,281 - sqlalchemy.engine.Engine - INFO - [cached since 0.05573s ago] ('100', 1, 0)
2024-12-23 00:50:04,413 - aiogram.event - INFO - Update id=659309090 is handled. Duration 1312 ms by bot id=7444575424
2024-12-23 00:50:05,901 - aiogram.dispatcher - INFO - Polling stopped
2024-12-23 00:50:24,310 - root - INFO - Инициализация бота...
2024-12-23 00:50:25,355 - root - INFO - Инициализация бота...
2024-12-23 00:50:25,417 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:50:25,418 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-23 00:50:25,418 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 00:50:25,420 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2024-12-23 00:50:25,420 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 00:50:25,420 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-23 00:50:25,421 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 00:50:25,421 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("keys")
2024-12-23 00:50:25,422 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 00:50:25,422 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	user_telegram_id VARCHAR NOT NULL, 
	subscription_status VARCHAR, 
	use_trial_period BOOLEAN, 
	PRIMARY KEY (user_telegram_id)
)


2024-12-23 00:50:25,423 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2024-12-23 00:50:25,455 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE keys (
	key_id VARCHAR NOT NULL, 
	user_telegram_id VARCHAR, 
	expiration_date DATETIME, 
	start_date DATETIME, 
	remembering_before_exp BOOLEAN, 
	PRIMARY KEY (key_id), 
	FOREIGN KEY(user_telegram_id) REFERENCES users (user_telegram_id)
)


2024-12-23 00:50:25,455 - sqlalchemy.engine.Engine - INFO - [no key 0.00048s] ()
2024-12-23 00:50:25,468 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 00:50:25,523 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-23 00:50:25,523 - root - INFO - Инициализация диспетчера...
2024-12-23 00:50:25,525 - root - INFO - Регистрация обработчиков...
2024-12-23 00:50:25,527 - root - INFO - Регистрация main menu команд...
2024-12-23 00:50:25,875 - root - INFO - Команды успешно установлены
2024-12-23 00:50:25,876 - root - INFO - Запуск polling...
2024-12-23 00:50:25,876 - aiogram.dispatcher - INFO - Start polling
2024-12-23 00:50:25,894 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:50:25,901 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-23 00:50:25,902 - sqlalchemy.engine.Engine - INFO - [generated in 0.00126s] ()
2024-12-23 00:50:25,970 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-23 00:50:26,195 - aiogram.event - INFO - Update id=659309093 is not handled. Duration 0 ms by bot id=7444575424
2024-12-23 00:50:26,313 - aiogram.event - INFO - Update id=659309094 is not handled. Duration 15 ms by bot id=7444575424
2024-12-23 00:50:26,600 - aiogram.event - INFO - Update id=659309091 is handled. Duration 406 ms by bot id=7444575424
2024-12-23 00:50:26,692 - aiogram.event - INFO - Update id=659309092 is not handled. Duration 500 ms by bot id=7444575424
2024-12-23 00:50:26,693 - aiogram.event - ERROR - Cause exception while process update id=659309092 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: message is not modified: specified new message content and reply markup are exactly the same as a current content and reply markup of the message
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\utils_router.py", line 44, in back_button
    await callback.message.edit_text(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message is not modified: specified new message content and reply markup are exactly the same as a current content and reply markup of the message
2024-12-23 00:50:27,995 - aiogram.event - INFO - Update id=659309095 is handled. Duration 282 ms by bot id=7444575424
2024-12-23 00:50:28,901 - aiogram.event - INFO - Update id=659309096 is not handled. Duration 0 ms by bot id=7444575424
2024-12-23 00:50:29,834 - aiogram.event - INFO - Update id=659309097 is handled. Duration 139 ms by bot id=7444575424
2024-12-23 00:50:30,739 - aiogram.event - INFO - Update id=659309098 is not handled. Duration 0 ms by bot id=7444575424
2024-12-23 00:50:30,948 - aiogram.event - INFO - Update id=659309099 is handled. Duration 140 ms by bot id=7444575424
2024-12-23 00:50:31,812 - aiogram.event - INFO - Update id=659309100 is handled. Duration 156 ms by bot id=7444575424
2024-12-23 00:50:32,056 - aiogram.event - INFO - Update id=659309101 is handled. Duration 156 ms by bot id=7444575424
2024-12-23 00:50:32,764 - aiogram.event - INFO - Update id=659309102 is handled. Duration 172 ms by bot id=7444575424
2024-12-23 00:50:37,458 - aiogram.event - INFO - Update id=659309103 is handled. Duration 327 ms by bot id=7444575424
2024-12-23 00:50:41,923 - aiogram.event - INFO - Update id=659309104 is handled. Duration 156 ms by bot id=7444575424
2024-12-23 00:50:45,126 - aiogram.event - INFO - Update id=659309105 is handled. Duration 264 ms by bot id=7444575424
2024-12-23 00:50:46,439 - aiogram.event - INFO - Update id=659309106 is handled. Duration 296 ms by bot id=7444575424
2024-12-23 00:50:49,469 - aiogram.event - INFO - Update id=659309107 is handled. Duration 312 ms by bot id=7444575424
2024-12-23 00:50:51,176 - aiogram.event - INFO - Update id=659309108 is handled. Duration 281 ms by bot id=7444575424
2024-12-23 00:50:54,965 - aiogram.event - INFO - Update id=659309109 is handled. Duration 155 ms by bot id=7444575424
2024-12-23 00:50:55,986 - aiogram.event - INFO - Update id=659309110 is handled. Duration 360 ms by bot id=7444575424
2024-12-23 00:50:56,843 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:50:56,852 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:50:56,853 - sqlalchemy.engine.Engine - INFO - [generated in 0.00177s] ('528155210', 1, 0)
2024-12-23 00:50:57,068 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 00:50:57,250 - aiogram.event - INFO - Update id=659309111 is handled. Duration 407 ms by bot id=7444575424
2024-12-23 00:51:02,301 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:51:02,303 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:51:02,304 - sqlalchemy.engine.Engine - INFO - [cached since 5.452s ago] ('528155210', 1, 0)
2024-12-23 00:51:02,309 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (user_telegram_id, subscription_status, use_trial_period) VALUES (?, ?, ?)
2024-12-23 00:51:02,310 - sqlalchemy.engine.Engine - INFO - [generated in 0.00087s] ('528155210', 'active', 0)
2024-12-23 00:51:02,314 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 00:51:02,324 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:51:02,327 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-23 00:51:02,327 - sqlalchemy.engine.Engine - INFO - [generated in 0.00073s] ('528155210',)
2024-12-23 00:51:02,331 - sqlalchemy.engine.Engine - INFO - UPDATE users SET use_trial_period=? WHERE users.user_telegram_id = ?
2024-12-23 00:51:02,332 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] (1, '528155210')
2024-12-23 00:51:02,335 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 00:51:03,448 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:51:03,455 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2024-12-23 00:51:03,456 - sqlalchemy.engine.Engine - INFO - [generated in 0.00179s] ('101', '528155210', '2024-12-25 00:51:03.447084', '2024-12-23 00:51:03.447084', 0)
2024-12-23 00:51:03,469 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 00:51:03,481 - root - INFO - Key created: OutlineKey(key_id='101', name='VPN Key59', password='zVELXIsvVYrBeaUZchWBXw', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTp6VkVMWElzdlZZckJlYVVaY2hXQlh3@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2024-12-23 00:51:03,589 - aiogram.event - INFO - Update id=659309112 is handled. Duration 1296 ms by bot id=7444575424
2024-12-23 00:51:06,675 - aiogram.event - INFO - Update id=659309113 is handled. Duration 234 ms by bot id=7444575424
2024-12-23 00:51:10,494 - aiogram.event - INFO - Update id=659309114 is handled. Duration 375 ms by bot id=7444575424
2024-12-23 00:51:11,504 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:51:11,505 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:51:11,505 - sqlalchemy.engine.Engine - INFO - [cached since 14.65s ago] ('528155210', 1, 0)
2024-12-23 00:51:11,511 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-23 00:51:11,512 - sqlalchemy.engine.Engine - INFO - [generated in 0.00115s] ('528155210',)
2024-12-23 00:51:12,616 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 00:51:12,760 - aiogram.event - INFO - Update id=659309115 is handled. Duration 1250 ms by bot id=7444575424
2024-12-23 00:51:16,079 - aiogram.event - INFO - Update id=659309116 is handled. Duration 171 ms by bot id=7444575424
2024-12-23 00:51:17,583 - aiogram.event - INFO - Update id=659309117 is handled. Duration 139 ms by bot id=7444575424
2024-12-23 00:51:19,388 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:51:19,391 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:51:19,391 - sqlalchemy.engine.Engine - INFO - [cached since 22.54s ago] ('528155210', 1, 0)
2024-12-23 00:51:19,465 - aiogram.event - INFO - Update id=659309118 is handled. Duration 77 ms by bot id=7444575424
2024-12-23 00:51:22,913 - aiogram.event - INFO - Update id=659309119 is handled. Duration 93 ms by bot id=7444575424
2024-12-23 00:51:27,248 - aiogram.event - INFO - Update id=659309120 is handled. Duration 250 ms by bot id=7444575424
2024-12-23 00:51:50,075 - aiogram.event - INFO - Update id=659309121 is handled. Duration 218 ms by bot id=7444575424
2024-12-23 00:52:09,329 - root - INFO - {
    "message_id": 4399,
    "date": 1734904329,
    "chat": {
        "id": 528155210,
        "type": "private",
        "title": null,
        "username": "dastroo",
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "is_forum": null,
        "accent_color_id": null,
        "active_usernames": null,
        "available_reactions": null,
        "background_custom_emoji_id": null,
        "bio": null,
        "birthdate": null,
        "business_intro": null,
        "business_location": null,
        "business_opening_hours": null,
        "can_set_sticker_set": null,
        "custom_emoji_sticker_set_name": null,
        "description": null,
        "emoji_status_custom_emoji_id": null,
        "emoji_status_expiration_date": null,
        "has_aggressive_anti_spam_enabled": null,
        "has_hidden_members": null,
        "has_private_forwards": null,
        "has_protected_content": null,
        "has_restricted_voice_and_video_messages": null,
        "has_visible_history": null,
        "invite_link": null,
        "join_by_request": null,
        "join_to_send_messages": null,
        "linked_chat_id": null,
        "location": null,
        "message_auto_delete_time": null,
        "permissions": null,
        "personal_chat": null,
        "photo": null,
        "pinned_message": null,
        "profile_accent_color_id": null,
        "profile_background_custom_emoji_id": null,
        "slow_mode_delay": null,
        "sticker_set_name": null,
        "unrestrict_boost_count": null
    },
    "message_thread_id": null,
    "from_user": {
        "id": 528155210,
        "is_bot": false,
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "username": "dastroo",
        "language_code": "ru",
        "is_premium": null,
        "added_to_attachment_menu": null,
        "can_join_groups": null,
        "can_read_all_group_messages": null,
        "supports_inline_queries": null,
        "can_connect_to_business": null,
        "has_main_web_app": null
    },
    "sender_chat": null,
    "sender_boost_count": null,
    "sender_business_bot": null,
    "business_connection_id": null,
    "forward_origin": null,
    "is_topic_message": null,
    "is_automatic_forward": null,
    "reply_to_message": null,
    "external_reply": null,
    "quote": null,
    "reply_to_story": null,
    "via_bot": null,
    "edit_date": null,
    "has_protected_content": null,
    "is_from_offline": null,
    "media_group_id": null,
    "author_signature": null,
    "text": null,
    "entities": null,
    "link_preview_options": null,
    "effect_id": null,
    "animation": null,
    "audio": null,
    "document": null,
    "paid_media": null,
    "photo": null,
    "sticker": null,
    "story": null,
    "video": null,
    "video_note": null,
    "voice": null,
    "caption": null,
    "caption_entities": null,
    "show_caption_above_media": null,
    "has_media_spoiler": null,
    "contact": null,
    "dice": null,
    "game": null,
    "poll": null,
    "venue": null,
    "location": null,
    "new_chat_members": null,
    "left_chat_member": null,
    "new_chat_title": null,
    "new_chat_photo": null,
    "delete_chat_photo": null,
    "group_chat_created": null,
    "supergroup_chat_created": null,
    "channel_chat_created": null,
    "message_auto_delete_timer_changed": null,
    "migrate_to_chat_id": null,
    "migrate_from_chat_id": null,
    "pinned_message": null,
    "invoice": null,
    "successful_payment": {
        "currency": "RUB",
        "total_amount": 49000,
        "invoice_payload": "daf86a98-75d0-4e48-b5c9-b6b056bc8601",
        "telegram_payment_charge_id": "7444575424_528155210_341054",
        "provider_payment_charge_id": "7444575424_528155210_341054",
        "subscription_expiration_date": null,
        "is_recurring": null,
        "is_first_recurring": null,
        "shipping_option_id": null,
        "order_info": null
    },
    "refunded_payment": null,
    "users_shared": null,
    "chat_shared": null,
    "connected_website": null,
    "write_access_allowed": null,
    "passport_data": null,
    "proximity_alert_triggered": null,
    "boost_added": null,
    "chat_background_set": null,
    "forum_topic_created": null,
    "forum_topic_edited": null,
    "forum_topic_closed": null,
    "forum_topic_reopened": null,
    "general_forum_topic_hidden": null,
    "general_forum_topic_unhidden": null,
    "giveaway_created": null,
    "giveaway": null,
    "giveaway_winners": null,
    "giveaway_completed": null,
    "video_chat_scheduled": null,
    "video_chat_started": null,
    "video_chat_ended": null,
    "video_chat_participants_invited": null,
    "web_app_data": null,
    "reply_markup": null,
    "forward_date": null,
    "forward_from": null,
    "forward_from_chat": null,
    "forward_from_message_id": null,
    "forward_sender_name": null,
    "forward_signature": null,
    "user_shared": null
}
2024-12-23 00:52:10,607 - root - INFO - Key created: OutlineKey(key_id='102', name='VPN Key60', password='wQUGjYrmNlen6ti61bJOK0', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTp3UVVHallybU5sZW42dGk2MWJKT0sw@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 528155210
2024-12-23 00:52:10,887 - root - INFO - Key created: OutlineKey(key_id='102', name='VPN Key60', password='wQUGjYrmNlen6ti61bJOK0', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTp3UVVHallybU5sZW42dGk2MWJKT0sw@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2024-12-23 00:52:11,052 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:52:11,055 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:52:11,056 - sqlalchemy.engine.Engine - INFO - [cached since 74.21s ago] ('528155210', 1, 0)
2024-12-23 00:52:11,065 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2024-12-23 00:52:11,067 - sqlalchemy.engine.Engine - INFO - [cached since 67.61s ago] ('102', '528155210', '2025-12-18 00:52:11.062447', '2024-12-23 00:52:11.062447', 0)
2024-12-23 00:52:11,076 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 00:52:11,095 - aiogram.event - INFO - Update id=659309122 is handled. Duration 1781 ms by bot id=7444575424
2024-12-23 00:52:14,223 - aiogram.event - INFO - Update id=659309123 is handled. Duration 187 ms by bot id=7444575424
2024-12-23 00:52:15,856 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:52:15,856 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:52:15,856 - sqlalchemy.engine.Engine - INFO - [cached since 79.01s ago] ('528155210', 1, 0)
2024-12-23 00:52:15,857 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-23 00:52:15,857 - sqlalchemy.engine.Engine - INFO - [cached since 64.35s ago] ('528155210',)
2024-12-23 00:52:17,819 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 00:52:17,911 - aiogram.event - INFO - Update id=659309124 is handled. Duration 2062 ms by bot id=7444575424
2024-12-23 00:52:29,037 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:52:29,041 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:52:29,043 - sqlalchemy.engine.Engine - INFO - [generated in 0.00142s] ('102', 1, 0)
2024-12-23 00:52:29,171 - aiogram.event - INFO - Update id=659309125 is handled. Duration 1156 ms by bot id=7444575424
2024-12-23 00:52:30,930 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:52:30,931 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:52:30,931 - sqlalchemy.engine.Engine - INFO - [cached since 94.08s ago] ('528155210', 1, 0)
2024-12-23 00:52:30,935 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-23 00:52:30,935 - sqlalchemy.engine.Engine - INFO - [cached since 79.43s ago] ('528155210',)
2024-12-23 00:52:32,862 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 00:52:32,864 - aiogram.event - INFO - Update id=659309126 is handled. Duration 1937 ms by bot id=7444575424
2024-12-23 00:52:35,431 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:52:35,435 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:52:35,436 - sqlalchemy.engine.Engine - INFO - [cached since 6.394s ago] ('102', 1, 0)
2024-12-23 00:52:35,581 - aiogram.event - INFO - Update id=659309127 is handled. Duration 1217 ms by bot id=7444575424
2024-12-23 00:52:38,166 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:52:38,169 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:52:38,169 - sqlalchemy.engine.Engine - INFO - [cached since 101.3s ago] ('528155210', 1, 0)
2024-12-23 00:52:38,175 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-23 00:52:38,176 - sqlalchemy.engine.Engine - INFO - [cached since 86.67s ago] ('528155210',)
2024-12-23 00:52:40,250 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 00:52:40,252 - aiogram.event - INFO - Update id=659309128 is handled. Duration 2093 ms by bot id=7444575424
2024-12-23 00:52:47,676 - aiogram.event - INFO - Update id=659309129 is handled. Duration 172 ms by bot id=7444575424
2024-12-23 00:52:49,566 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:52:49,568 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:52:49,570 - sqlalchemy.engine.Engine - INFO - [cached since 112.7s ago] ('528155210', 1, 0)
2024-12-23 00:52:49,574 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-23 00:52:49,574 - sqlalchemy.engine.Engine - INFO - [cached since 98.06s ago] ('528155210',)
2024-12-23 00:52:51,771 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 00:52:51,897 - aiogram.event - INFO - Update id=659309130 is handled. Duration 2328 ms by bot id=7444575424
2024-12-23 00:52:55,135 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:52:55,137 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:52:55,138 - sqlalchemy.engine.Engine - INFO - [cached since 26.1s ago] ('102', 1, 0)
2024-12-23 00:52:55,270 - aiogram.event - INFO - Update id=659309131 is handled. Duration 1172 ms by bot id=7444575424
2024-12-23 00:53:02,404 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:53:02,407 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:53:02,408 - sqlalchemy.engine.Engine - INFO - [cached since 33.37s ago] ('102', 1, 0)
2024-12-23 00:53:03,413 - aiogram.event - INFO - Update id=659309132 is handled. Duration 1031 ms by bot id=7444575424
2024-12-23 00:53:05,514 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:53:05,515 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:53:05,515 - sqlalchemy.engine.Engine - INFO - [cached since 36.47s ago] ('102', 1, 0)
2024-12-23 00:53:05,634 - aiogram.event - INFO - Update id=659309133 is handled. Duration 937 ms by bot id=7444575424
2024-12-23 00:53:07,161 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:53:07,163 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:53:07,163 - sqlalchemy.engine.Engine - INFO - [cached since 38.12s ago] ('102', 1, 0)
2024-12-23 00:53:07,238 - aiogram.event - INFO - Update id=659309134 is handled. Duration 93 ms by bot id=7444575424
2024-12-23 00:53:11,732 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:53:11,736 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:53:11,737 - sqlalchemy.engine.Engine - INFO - [cached since 42.7s ago] ('102', 1, 0)
2024-12-23 00:53:11,868 - aiogram.event - INFO - Update id=659309135 is handled. Duration 1141 ms by bot id=7444575424
2024-12-23 00:53:14,608 - aiogram.event - INFO - Update id=659309136 is handled. Duration 108 ms by bot id=7444575424
2024-12-23 00:53:20,203 - aiogram.event - INFO - Update id=659309137 is handled. Duration 155 ms by bot id=7444575424
2024-12-23 00:53:22,601 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:53:22,603 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:53:22,605 - sqlalchemy.engine.Engine - INFO - [cached since 53.56s ago] ('102', 1, 0)
2024-12-23 00:53:22,608 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 00:53:22,610 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:53:22,613 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-23 00:53:22,614 - sqlalchemy.engine.Engine - INFO - [generated in 0.00142s] ('102',)
2024-12-23 00:53:22,948 - aiogram.event - INFO - Update id=659309138 is handled. Duration 343 ms by bot id=7444575424
2024-12-23 00:53:30,924 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:53:30,925 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:53:30,925 - sqlalchemy.engine.Engine - INFO - [cached since 61.88s ago] ('102', 1, 0)
2024-12-23 00:53:31,095 - aiogram.event - INFO - Update id=659309139 is handled. Duration 1202 ms by bot id=7444575424
2024-12-23 00:53:34,247 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:53:34,249 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:53:34,251 - sqlalchemy.engine.Engine - INFO - [cached since 65.21s ago] ('102', 1, 0)
2024-12-23 00:53:35,250 - aiogram.event - INFO - Update id=659309140 is handled. Duration 1016 ms by bot id=7444575424
2024-12-23 00:53:37,231 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:53:37,232 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:53:37,232 - sqlalchemy.engine.Engine - INFO - [cached since 68.19s ago] ('102', 1, 0)
2024-12-23 00:53:37,406 - aiogram.event - INFO - Update id=659309141 is handled. Duration 1078 ms by bot id=7444575424
2024-12-23 00:53:39,132 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:53:39,136 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:53:39,137 - sqlalchemy.engine.Engine - INFO - [cached since 162.3s ago] ('528155210', 1, 0)
2024-12-23 00:53:39,144 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-23 00:53:39,146 - sqlalchemy.engine.Engine - INFO - [cached since 147.6s ago] ('528155210',)
2024-12-23 00:53:41,540 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 00:53:41,540 - aiogram.event - INFO - Update id=659309142 is handled. Duration 2421 ms by bot id=7444575424
2024-12-23 00:53:43,438 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:53:43,440 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:53:43,440 - sqlalchemy.engine.Engine - INFO - [cached since 74.4s ago] ('101', 1, 0)
2024-12-23 00:53:43,563 - aiogram.event - INFO - Update id=659309143 is handled. Duration 1202 ms by bot id=7444575424
2024-12-23 00:53:47,168 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:53:47,169 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:53:47,170 - sqlalchemy.engine.Engine - INFO - [cached since 78.13s ago] ('101', 1, 0)
2024-12-23 00:53:47,248 - aiogram.event - INFO - Update id=659309144 is handled. Duration 78 ms by bot id=7444575424
2024-12-23 00:53:49,809 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:53:49,812 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:53:49,813 - sqlalchemy.engine.Engine - INFO - [cached since 80.77s ago] ('101', 1, 0)
2024-12-23 00:53:49,960 - aiogram.event - INFO - Update id=659309145 is handled. Duration 1202 ms by bot id=7444575424
2024-12-23 00:53:51,022 - aiogram.event - INFO - Update id=659309146 is handled. Duration 93 ms by bot id=7444575424
2024-12-23 00:53:53,652 - aiogram.event - INFO - Update id=659309147 is handled. Duration 297 ms by bot id=7444575424
2024-12-23 00:54:13,564 - aiogram.event - INFO - Update id=659309148 is handled. Duration 281 ms by bot id=7444575424
2024-12-23 00:54:21,494 - root - INFO - {
    "message_id": 4404,
    "date": 1734904461,
    "chat": {
        "id": 528155210,
        "type": "private",
        "title": null,
        "username": "dastroo",
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "is_forum": null,
        "accent_color_id": null,
        "active_usernames": null,
        "available_reactions": null,
        "background_custom_emoji_id": null,
        "bio": null,
        "birthdate": null,
        "business_intro": null,
        "business_location": null,
        "business_opening_hours": null,
        "can_set_sticker_set": null,
        "custom_emoji_sticker_set_name": null,
        "description": null,
        "emoji_status_custom_emoji_id": null,
        "emoji_status_expiration_date": null,
        "has_aggressive_anti_spam_enabled": null,
        "has_hidden_members": null,
        "has_private_forwards": null,
        "has_protected_content": null,
        "has_restricted_voice_and_video_messages": null,
        "has_visible_history": null,
        "invite_link": null,
        "join_by_request": null,
        "join_to_send_messages": null,
        "linked_chat_id": null,
        "location": null,
        "message_auto_delete_time": null,
        "permissions": null,
        "personal_chat": null,
        "photo": null,
        "pinned_message": null,
        "profile_accent_color_id": null,
        "profile_background_custom_emoji_id": null,
        "slow_mode_delay": null,
        "sticker_set_name": null,
        "unrestrict_boost_count": null
    },
    "message_thread_id": null,
    "from_user": {
        "id": 528155210,
        "is_bot": false,
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "username": "dastroo",
        "language_code": "ru",
        "is_premium": null,
        "added_to_attachment_menu": null,
        "can_join_groups": null,
        "can_read_all_group_messages": null,
        "supports_inline_queries": null,
        "can_connect_to_business": null,
        "has_main_web_app": null
    },
    "sender_chat": null,
    "sender_boost_count": null,
    "sender_business_bot": null,
    "business_connection_id": null,
    "forward_origin": null,
    "is_topic_message": null,
    "is_automatic_forward": null,
    "reply_to_message": null,
    "external_reply": null,
    "quote": null,
    "reply_to_story": null,
    "via_bot": null,
    "edit_date": null,
    "has_protected_content": null,
    "is_from_offline": null,
    "media_group_id": null,
    "author_signature": null,
    "text": null,
    "entities": null,
    "link_preview_options": null,
    "effect_id": null,
    "animation": null,
    "audio": null,
    "document": null,
    "paid_media": null,
    "photo": null,
    "sticker": null,
    "story": null,
    "video": null,
    "video_note": null,
    "voice": null,
    "caption": null,
    "caption_entities": null,
    "show_caption_above_media": null,
    "has_media_spoiler": null,
    "contact": null,
    "dice": null,
    "game": null,
    "poll": null,
    "venue": null,
    "location": null,
    "new_chat_members": null,
    "left_chat_member": null,
    "new_chat_title": null,
    "new_chat_photo": null,
    "delete_chat_photo": null,
    "group_chat_created": null,
    "supergroup_chat_created": null,
    "channel_chat_created": null,
    "message_auto_delete_timer_changed": null,
    "migrate_to_chat_id": null,
    "migrate_from_chat_id": null,
    "pinned_message": null,
    "invoice": null,
    "successful_payment": {
        "currency": "RUB",
        "total_amount": 5000,
        "invoice_payload": "4c18b609-1773-4b65-9259-c036e1b88a45",
        "telegram_payment_charge_id": "7444575424_528155210_341059",
        "provider_payment_charge_id": "7444575424_528155210_341059",
        "subscription_expiration_date": null,
        "is_recurring": null,
        "is_first_recurring": null,
        "shipping_option_id": null,
        "order_info": null
    },
    "refunded_payment": null,
    "users_shared": null,
    "chat_shared": null,
    "connected_website": null,
    "write_access_allowed": null,
    "passport_data": null,
    "proximity_alert_triggered": null,
    "boost_added": null,
    "chat_background_set": null,
    "forum_topic_created": null,
    "forum_topic_edited": null,
    "forum_topic_closed": null,
    "forum_topic_reopened": null,
    "general_forum_topic_hidden": null,
    "general_forum_topic_unhidden": null,
    "giveaway_created": null,
    "giveaway": null,
    "giveaway_winners": null,
    "giveaway_completed": null,
    "video_chat_scheduled": null,
    "video_chat_started": null,
    "video_chat_ended": null,
    "video_chat_participants_invited": null,
    "web_app_data": null,
    "reply_markup": null,
    "forward_date": null,
    "forward_from": null,
    "forward_from_chat": null,
    "forward_from_message_id": null,
    "forward_sender_name": null,
    "forward_signature": null,
    "user_shared": null
}
2024-12-23 00:54:21,598 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:54:21,599 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:54:21,600 - sqlalchemy.engine.Engine - INFO - [cached since 112.6s ago] ('101', 1, 0)
2024-12-23 00:54:21,605 - sqlalchemy.engine.Engine - INFO - UPDATE keys SET expiration_date=? WHERE keys.key_id = ?
2024-12-23 00:54:21,606 - sqlalchemy.engine.Engine - INFO - [generated in 0.00138s] ('2025-01-25 00:51:03.447084', '101')
2024-12-23 00:54:21,609 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 00:54:21,633 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:54:21,634 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-23 00:54:21,637 - sqlalchemy.engine.Engine - INFO - [cached since 59.02s ago] ('101',)
2024-12-23 00:54:21,639 - root - INFO - Ключ с ID 101 успешно продлён на 31 дней. Новая дата окончания: 2025-01-25 00:51:03.447084
2024-12-23 00:54:21,639 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 00:54:21,641 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:54:21,642 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:54:21,643 - sqlalchemy.engine.Engine - INFO - [cached since 112.6s ago] ('101', 1, 0)
2024-12-23 00:54:23,048 - aiogram.event - INFO - Update id=659309149 is handled. Duration 1562 ms by bot id=7444575424
2024-12-23 00:54:25,733 - aiogram.event - INFO - Update id=659309150 is handled. Duration 171 ms by bot id=7444575424
2024-12-23 00:54:26,790 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:54:26,792 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:54:26,794 - sqlalchemy.engine.Engine - INFO - [cached since 209.9s ago] ('528155210', 1, 0)
2024-12-23 00:54:26,800 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-23 00:54:26,801 - sqlalchemy.engine.Engine - INFO - [cached since 195.3s ago] ('528155210',)
2024-12-23 00:54:29,831 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 00:54:30,225 - aiogram.event - INFO - Update id=659309151 is handled. Duration 3437 ms by bot id=7444575424
2024-12-23 00:54:32,133 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:54:32,135 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:54:32,136 - sqlalchemy.engine.Engine - INFO - [cached since 123.1s ago] ('101', 1, 0)
2024-12-23 00:54:32,277 - aiogram.event - INFO - Update id=659309152 is handled. Duration 1625 ms by bot id=7444575424
2024-12-23 00:54:35,812 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:54:35,813 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:54:35,815 - sqlalchemy.engine.Engine - INFO - [cached since 126.8s ago] ('101', 1, 0)
2024-12-23 00:54:35,894 - aiogram.event - INFO - Update id=659309153 is handled. Duration 93 ms by bot id=7444575424
2024-12-23 00:54:41,581 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:54:41,583 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:54:41,583 - sqlalchemy.engine.Engine - INFO - [cached since 132.5s ago] ('101', 1, 0)
2024-12-23 00:54:41,734 - aiogram.event - INFO - Update id=659309154 is handled. Duration 1282 ms by bot id=7444575424
2024-12-23 00:54:44,619 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 00:54:44,621 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 00:54:44,623 - sqlalchemy.engine.Engine - INFO - [cached since 227.8s ago] ('528155210', 1, 0)
2024-12-23 00:54:44,635 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-23 00:54:44,636 - sqlalchemy.engine.Engine - INFO - [cached since 213.1s ago] ('528155210',)
2024-12-23 00:54:46,600 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 00:54:46,602 - aiogram.event - INFO - Update id=659309155 is handled. Duration 2000 ms by bot id=7444575424
2024-12-23 00:54:48,384 - aiogram.event - INFO - Update id=659309156 is handled. Duration 139 ms by bot id=7444575424
2024-12-23 00:55:13,415 - aiogram.event - INFO - Update id=659309157 is handled. Duration 500 ms by bot id=7444575424
2024-12-23 00:55:14,327 - aiogram.event - INFO - Update id=659309158 is handled. Duration 156 ms by bot id=7444575424
2024-12-23 00:55:18,533 - aiogram.event - INFO - Update id=659309159 is handled. Duration 187 ms by bot id=7444575424
2024-12-23 00:55:26,202 - aiogram.event - INFO - Update id=659309160 is handled. Duration 140 ms by bot id=7444575424
2024-12-23 00:55:42,851 - aiogram.event - INFO - Update id=659309161 is handled. Duration 327 ms by bot id=7444575424
2024-12-23 00:55:46,948 - aiogram.event - INFO - Update id=659309162 is handled. Duration 202 ms by bot id=7444575424
2024-12-23 01:12:16,322 - aiogram.dispatcher - INFO - Polling stopped
2024-12-23 01:46:11,362 - root - INFO - Инициализация бота...
2024-12-23 01:46:12,588 - root - INFO - Инициализация бота...
2024-12-23 01:46:12,725 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:46:12,725 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-23 01:46:12,725 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 01:46:12,728 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2024-12-23 01:46:12,728 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 01:46:12,728 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-23 01:46:12,729 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 01:46:12,730 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("keys")
2024-12-23 01:46:12,730 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 01:46:12,732 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	user_telegram_id VARCHAR NOT NULL, 
	subscription_status VARCHAR, 
	use_trial_period BOOLEAN, 
	PRIMARY KEY (user_telegram_id)
)


2024-12-23 01:46:12,733 - sqlalchemy.engine.Engine - INFO - [no key 0.00053s] ()
2024-12-23 01:46:12,748 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE keys (
	key_id VARCHAR NOT NULL, 
	user_telegram_id VARCHAR, 
	expiration_date DATETIME, 
	start_date DATETIME, 
	remembering_before_exp BOOLEAN, 
	PRIMARY KEY (key_id), 
	FOREIGN KEY(user_telegram_id) REFERENCES users (user_telegram_id)
)


2024-12-23 01:46:12,748 - sqlalchemy.engine.Engine - INFO - [no key 0.00043s] ()
2024-12-23 01:46:12,760 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 01:46:12,894 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-23 01:46:12,894 - root - INFO - Инициализация диспетчера...
2024-12-23 01:46:12,897 - root - INFO - Регистрация обработчиков...
2024-12-23 01:46:12,900 - root - INFO - Регистрация main menu команд...
2024-12-23 01:46:13,253 - root - INFO - Команды успешно установлены
2024-12-23 01:46:13,254 - root - INFO - Запуск polling...
2024-12-23 01:46:13,254 - aiogram.dispatcher - INFO - Start polling
2024-12-23 01:46:13,265 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:46:13,270 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-23 01:46:13,271 - sqlalchemy.engine.Engine - INFO - [generated in 0.00063s] ()
2024-12-23 01:46:13,330 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-23 01:46:58,289 - aiogram.event - INFO - Update id=659309163 is handled. Duration 218 ms by bot id=7444575424
2024-12-23 01:47:00,486 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:47:00,488 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:47:00,488 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('528155210', 1, 0)
2024-12-23 01:47:00,629 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 01:47:00,724 - aiogram.event - INFO - Update id=659309164 is handled. Duration 233 ms by bot id=7444575424
2024-12-23 01:47:01,828 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:47:01,829 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:47:01,829 - sqlalchemy.engine.Engine - INFO - [cached since 1.341s ago] ('528155210', 1, 0)
2024-12-23 01:47:01,832 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (user_telegram_id, subscription_status, use_trial_period) VALUES (?, ?, ?)
2024-12-23 01:47:01,833 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('528155210', 'active', 0)
2024-12-23 01:47:01,834 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 01:47:01,843 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:47:01,845 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-23 01:47:01,845 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ('528155210',)
2024-12-23 01:47:01,848 - sqlalchemy.engine.Engine - INFO - UPDATE users SET use_trial_period=? WHERE users.user_telegram_id = ?
2024-12-23 01:47:01,849 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] (1, '528155210')
2024-12-23 01:47:01,850 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 01:47:03,016 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:47:03,018 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2024-12-23 01:47:03,018 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('103', '528155210', '2024-12-25 01:47:03.015542', '2024-12-23 01:47:03.015542', 0)
2024-12-23 01:47:03,020 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 01:47:03,030 - root - INFO - Key created: OutlineKey(key_id='103', name='VPN Key61', password='Gzlr8XdLfrY1MXPIM15mLj', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpHemxyOFhkTGZyWTFNWFBJTTE1bUxq@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2024-12-23 01:47:03,112 - aiogram.event - INFO - Update id=659309165 is handled. Duration 1297 ms by bot id=7444575424
2024-12-23 01:48:22,616 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - Request timeout error
2024-12-23 01:48:22,616 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2024-12-23 01:48:33,852 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7444575424)
2024-12-23 01:50:38,392 - aiogram.event - INFO - Update id=659309166 is handled. Duration 391 ms by bot id=7444575424
2024-12-23 01:50:39,635 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:50:39,637 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:50:39,637 - sqlalchemy.engine.Engine - INFO - [cached since 219.2s ago] ('528155210', 1, 0)
2024-12-23 01:50:39,651 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-23 01:50:39,652 - sqlalchemy.engine.Engine - INFO - [generated in 0.00121s] ('528155210',)
2024-12-23 01:50:41,326 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 01:50:41,453 - aiogram.event - INFO - Update id=659309167 is handled. Duration 1812 ms by bot id=7444575424
2024-12-23 01:50:43,846 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:50:43,860 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:50:43,862 - sqlalchemy.engine.Engine - INFO - [generated in 0.00292s] ('103', 1, 0)
2024-12-23 01:50:44,086 - aiogram.event - INFO - Update id=659309168 is handled. Duration 1750 ms by bot id=7444575424
2024-12-23 01:50:46,287 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:50:46,292 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:50:46,293 - sqlalchemy.engine.Engine - INFO - [cached since 2.435s ago] ('103', 1, 0)
2024-12-23 01:50:47,461 - aiogram.event - INFO - Update id=659309169 is handled. Duration 1202 ms by bot id=7444575424
2024-12-23 01:50:58,140 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:50:58,146 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:50:58,147 - sqlalchemy.engine.Engine - INFO - [cached since 14.29s ago] ('103', 1, 0)
2024-12-23 01:50:58,310 - aiogram.event - INFO - Update id=659309170 is handled. Duration 1469 ms by bot id=7444575424
2024-12-23 01:51:00,750 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:51:00,752 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:51:00,754 - sqlalchemy.engine.Engine - INFO - [cached since 16.9s ago] ('103', 1, 0)
2024-12-23 01:51:02,029 - aiogram.event - INFO - Update id=659309171 is handled. Duration 1297 ms by bot id=7444575424
2024-12-23 01:51:05,429 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:51:05,431 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:51:05,431 - sqlalchemy.engine.Engine - INFO - [cached since 21.57s ago] ('103', 1, 0)
2024-12-23 01:51:05,701 - aiogram.event - INFO - Update id=659309172 is handled. Duration 1750 ms by bot id=7444575424
2024-12-23 01:51:06,474 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:51:06,475 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:51:06,476 - sqlalchemy.engine.Engine - INFO - [cached since 22.62s ago] ('103', 1, 0)
2024-12-23 01:51:07,881 - aiogram.event - INFO - Update id=659309173 is handled. Duration 1422 ms by bot id=7444575424
2024-12-23 01:51:38,380 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:51:38,380 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:51:38,380 - sqlalchemy.engine.Engine - INFO - [cached since 54.52s ago] ('103', 1, 0)
2024-12-23 01:51:38,673 - aiogram.event - INFO - Update id=659309174 is handled. Duration 2250 ms by bot id=7444575424
2024-12-23 01:51:40,021 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:51:40,022 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:51:40,022 - sqlalchemy.engine.Engine - INFO - [cached since 56.16s ago] ('103', 1, 0)
2024-12-23 01:51:40,124 - aiogram.event - INFO - Update id=659309175 is handled. Duration 93 ms by bot id=7444575424
2024-12-23 01:51:43,280 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:51:43,282 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:51:43,282 - sqlalchemy.engine.Engine - INFO - [cached since 59.42s ago] ('103', 1, 0)
2024-12-23 01:51:43,410 - aiogram.event - INFO - Update id=659309176 is handled. Duration 1578 ms by bot id=7444575424
2024-12-23 01:51:44,396 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:51:44,397 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:51:44,398 - sqlalchemy.engine.Engine - INFO - [cached since 60.54s ago] ('103', 1, 0)
2024-12-23 01:51:46,065 - aiogram.event - INFO - Update id=659309177 is handled. Duration 1702 ms by bot id=7444575424
2024-12-23 01:53:32,016 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:53:32,017 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:53:32,018 - sqlalchemy.engine.Engine - INFO - [cached since 168.2s ago] ('103', 1, 0)
2024-12-23 01:53:32,210 - aiogram.event - INFO - Update id=659309178 is handled. Duration 1092 ms by bot id=7444575424
2024-12-23 01:53:34,340 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:53:34,341 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:53:34,341 - sqlalchemy.engine.Engine - INFO - [cached since 170.5s ago] ('103', 1, 0)
2024-12-23 01:53:36,354 - aiogram.event - INFO - Update id=659309179 is handled. Duration 2016 ms by bot id=7444575424
2024-12-23 01:53:58,383 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:53:58,384 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:53:58,385 - sqlalchemy.engine.Engine - INFO - [cached since 194.5s ago] ('103', 1, 0)
2024-12-23 01:53:58,566 - aiogram.event - INFO - Update id=659309180 is handled. Duration 1202 ms by bot id=7444575424
2024-12-23 01:53:59,882 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:53:59,883 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:53:59,884 - sqlalchemy.engine.Engine - INFO - [cached since 196s ago] ('103', 1, 0)
2024-12-23 01:54:01,191 - aiogram.event - INFO - Update id=659309181 is handled. Duration 1312 ms by bot id=7444575424
2024-12-23 01:56:17,754 - aiogram.dispatcher - INFO - Polling stopped
2024-12-23 01:56:18,015 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-23 01:56:18,017 - root - INFO - Бот остановлен вручную.
2024-12-23 01:56:21,328 - root - INFO - Инициализация бота...
2024-12-23 01:56:21,684 - root - INFO - Инициализация бота...
2024-12-23 01:56:21,718 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:56:21,719 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-23 01:56:21,719 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 01:56:21,720 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-23 01:56:21,720 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 01:56:21,720 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 01:56:21,747 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-23 01:56:21,747 - root - INFO - Инициализация диспетчера...
2024-12-23 01:56:21,747 - root - INFO - Регистрация обработчиков...
2024-12-23 01:56:21,748 - root - INFO - Регистрация main menu команд...
2024-12-23 01:56:22,088 - root - INFO - Команды успешно установлены
2024-12-23 01:56:22,088 - root - INFO - Запуск polling...
2024-12-23 01:56:22,090 - aiogram.dispatcher - INFO - Start polling
2024-12-23 01:56:22,099 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:56:22,102 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-23 01:56:22,103 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] ()
2024-12-23 01:56:22,108 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-23 01:56:22,109 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] ('528155210',)
2024-12-23 01:56:22,935 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 01:56:22,937 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:56:22,940 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-23 01:56:22,941 - sqlalchemy.engine.Engine - INFO - [generated in 0.00092s] ('528155210',)
2024-12-23 01:56:23,004 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-23 01:56:23,350 - aiogram.event - INFO - Update id=659309182 is handled. Duration 266 ms by bot id=7444575424
2024-12-23 01:56:26,007 - aiogram.event - INFO - Update id=659309183 is handled. Duration 156 ms by bot id=7444575424
2024-12-23 01:56:27,260 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:56:27,261 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:56:27,262 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] ('528155210', 1, 0)
2024-12-23 01:56:27,262 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-23 01:56:27,263 - sqlalchemy.engine.Engine - INFO - [cached since 5.155s ago] ('528155210',)
2024-12-23 01:56:28,338 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 01:56:28,404 - aiogram.event - INFO - Update id=659309184 is handled. Duration 1141 ms by bot id=7444575424
2024-12-23 01:56:30,606 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:56:30,607 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:56:30,607 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] ('103', 1, 0)
2024-12-23 01:56:30,740 - aiogram.event - INFO - Update id=659309185 is handled. Duration 1203 ms by bot id=7444575424
2024-12-23 01:56:32,188 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 01:56:32,189 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 01:56:32,189 - sqlalchemy.engine.Engine - INFO - [cached since 1.582s ago] ('103', 1, 0)
2024-12-23 01:56:33,047 - aiogram.event - INFO - Update id=659309186 is handled. Duration 875 ms by bot id=7444575424
2024-12-23 01:56:44,180 - aiogram.dispatcher - INFO - Polling stopped
2024-12-23 11:17:22,979 - root - INFO - Инициализация бота...
2024-12-23 11:17:23,633 - root - INFO - Инициализация бота...
2024-12-23 11:17:23,702 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:17:23,702 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-23 11:17:23,702 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 11:17:23,705 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2024-12-23 11:17:23,705 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 11:17:23,706 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-23 11:17:23,706 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 11:17:23,706 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("keys")
2024-12-23 11:17:23,706 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 11:17:23,707 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	user_telegram_id VARCHAR NOT NULL, 
	subscription_status VARCHAR, 
	use_trial_period BOOLEAN, 
	PRIMARY KEY (user_telegram_id)
)


2024-12-23 11:17:23,707 - sqlalchemy.engine.Engine - INFO - [no key 0.00021s] ()
2024-12-23 11:17:23,719 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE keys (
	key_id VARCHAR NOT NULL, 
	user_telegram_id VARCHAR, 
	expiration_date DATETIME, 
	start_date DATETIME, 
	remembering_before_exp BOOLEAN, 
	PRIMARY KEY (key_id), 
	FOREIGN KEY(user_telegram_id) REFERENCES users (user_telegram_id)
)


2024-12-23 11:17:23,719 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2024-12-23 11:17:23,727 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 11:17:23,764 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-23 11:17:23,765 - root - INFO - Инициализация диспетчера...
2024-12-23 11:17:23,765 - root - INFO - Регистрация обработчиков...
2024-12-23 11:17:23,767 - root - INFO - Регистрация main menu команд...
2024-12-23 11:17:24,386 - root - INFO - Команды успешно установлены
2024-12-23 11:17:24,386 - root - INFO - Запуск polling...
2024-12-23 11:17:24,386 - aiogram.dispatcher - INFO - Start polling
2024-12-23 11:17:24,391 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:17:24,395 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-23 11:17:24,395 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] ()
2024-12-23 11:17:24,457 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-23 11:17:24,845 - aiogram.event - INFO - Update id=659309187 is handled. Duration 266 ms by bot id=7444575424
2024-12-23 11:17:33,930 - aiogram.event - INFO - Update id=659309188 is handled. Duration 328 ms by bot id=7444575424
2024-12-23 11:17:38,417 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:17:38,417 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:17:38,418 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] ('651077894', 1, 0)
2024-12-23 11:17:38,419 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (user_telegram_id, subscription_status, use_trial_period) VALUES (?, ?, ?)
2024-12-23 11:17:38,419 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ('651077894', 'active', 0)
2024-12-23 11:17:38,420 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 11:17:38,429 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:17:38,430 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-23 11:17:38,430 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ('651077894',)
2024-12-23 11:17:38,432 - sqlalchemy.engine.Engine - INFO - UPDATE users SET use_trial_period=? WHERE users.user_telegram_id = ?
2024-12-23 11:17:38,432 - sqlalchemy.engine.Engine - INFO - [generated in 0.00017s] (1, '651077894')
2024-12-23 11:17:38,433 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 11:17:39,584 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:17:39,585 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2024-12-23 11:17:39,586 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] ('98', '651077894', '2024-12-25 11:17:39.584906', '2024-12-23 11:17:39.584906', 0)
2024-12-23 11:17:39,588 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 11:17:39,597 - root - INFO - Key created: OutlineKey(key_id='98', name='VPN Key56', password='sHauxB2pGamArbvKzpLLAL', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpzSGF1eEIycEdhbUFyYnZLenBMTEFM@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2024-12-23 11:17:39,780 - aiogram.event - INFO - Update id=659309189 is handled. Duration 1359 ms by bot id=7444575424
2024-12-23 11:18:33,608 - aiogram.event - INFO - Update id=659309190 is handled. Duration 296 ms by bot id=7444575424
2024-12-23 11:18:36,862 - aiogram.event - INFO - Update id=659309191 is handled. Duration 219 ms by bot id=7444575424
2024-12-23 11:18:38,753 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:18:38,755 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:18:38,756 - sqlalchemy.engine.Engine - INFO - [cached since 60.34s ago] ('651077894', 1, 0)
2024-12-23 11:18:38,765 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-23 11:18:38,767 - sqlalchemy.engine.Engine - INFO - [generated in 0.00154s] ('651077894',)
2024-12-23 11:18:40,559 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 11:18:40,620 - aiogram.event - INFO - Update id=659309192 is handled. Duration 1875 ms by bot id=7444575424
2024-12-23 11:18:44,285 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:18:44,287 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:18:44,287 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('98', 1, 0)
2024-12-23 11:18:44,403 - aiogram.event - INFO - Update id=659309193 is handled. Duration 1202 ms by bot id=7444575424
2024-12-23 11:18:51,879 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:18:51,881 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:18:51,881 - sqlalchemy.engine.Engine - INFO - [cached since 7.594s ago] ('98', 1, 0)
2024-12-23 11:18:53,841 - aiogram.event - INFO - Update id=659309194 is handled. Duration 1967 ms by bot id=7444575424
2024-12-23 11:18:56,340 - aiogram.event - INFO - Update id=659309195 is handled. Duration 187 ms by bot id=7444575424
2024-12-23 11:18:57,502 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:18:57,503 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:18:57,504 - sqlalchemy.engine.Engine - INFO - [cached since 79.09s ago] ('651077894', 1, 0)
2024-12-23 11:18:57,507 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-23 11:18:57,509 - sqlalchemy.engine.Engine - INFO - [cached since 18.74s ago] ('651077894',)
2024-12-23 11:18:58,710 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 11:18:58,773 - aiogram.event - INFO - Update id=659309196 is handled. Duration 1280 ms by bot id=7444575424
2024-12-23 11:21:07,122 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:21:07,124 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:21:07,125 - sqlalchemy.engine.Engine - INFO - [cached since 142.8s ago] ('98', 1, 0)
2024-12-23 11:21:07,335 - aiogram.event - INFO - Update id=659309197 is handled. Duration 2250 ms by bot id=7444575424
2024-12-23 11:21:13,643 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:21:13,644 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:21:13,645 - sqlalchemy.engine.Engine - INFO - [cached since 149.4s ago] ('98', 1, 0)
2024-12-23 11:21:14,820 - aiogram.event - INFO - Update id=659309198 is handled. Duration 1187 ms by bot id=7444575424
2024-12-23 11:21:51,799 - aiogram.dispatcher - INFO - Polling stopped
2024-12-23 11:22:04,059 - root - INFO - Инициализация бота...
2024-12-23 11:22:04,717 - root - INFO - Инициализация бота...
2024-12-23 11:22:04,803 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:22:04,804 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-23 11:22:04,804 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 11:22:04,805 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-23 11:22:04,805 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 11:22:04,806 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 11:22:04,853 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-23 11:22:04,853 - root - INFO - Инициализация диспетчера...
2024-12-23 11:22:04,854 - root - INFO - Регистрация обработчиков...
2024-12-23 11:22:04,857 - root - INFO - Регистрация main menu команд...
2024-12-23 11:22:05,405 - root - INFO - Команды успешно установлены
2024-12-23 11:22:05,406 - root - INFO - Запуск polling...
2024-12-23 11:22:05,407 - aiogram.dispatcher - INFO - Start polling
2024-12-23 11:22:05,423 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:22:05,429 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-23 11:22:05,430 - sqlalchemy.engine.Engine - INFO - [generated in 0.00078s] ()
2024-12-23 11:22:05,439 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-23 11:22:05,439 - sqlalchemy.engine.Engine - INFO - [generated in 0.00085s] ('651077894',)
2024-12-23 11:22:06,459 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 11:22:06,461 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:22:06,463 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-23 11:22:06,464 - sqlalchemy.engine.Engine - INFO - [generated in 0.00100s] ('651077894',)
2024-12-23 11:22:06,539 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-23 11:22:10,605 - aiogram.event - INFO - Update id=659309199 is handled. Duration 358 ms by bot id=7444575424
2024-12-23 11:22:13,776 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:22:13,781 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:22:13,781 - sqlalchemy.engine.Engine - INFO - [generated in 0.00120s] ('98', 1, 0)
2024-12-23 11:22:13,973 - aiogram.event - INFO - Update id=659309200 is handled. Duration 1405 ms by bot id=7444575424
2024-12-23 11:22:14,502 - aiogram.event - INFO - Update id=659309201 is handled. Duration 390 ms by bot id=7444575424
2024-12-23 11:22:16,449 - aiogram.event - INFO - Update id=659309202 is handled. Duration 235 ms by bot id=7444575424
2024-12-23 11:22:20,152 - aiogram.event - INFO - Update id=659309203 is handled. Duration 125 ms by bot id=7444575424
2024-12-23 11:22:21,295 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:22:21,301 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:22:21,301 - sqlalchemy.engine.Engine - INFO - [generated in 0.00125s] ('651077894', 1, 0)
2024-12-23 11:22:21,307 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-23 11:22:21,308 - sqlalchemy.engine.Engine - INFO - [cached since 15.87s ago] ('651077894',)
2024-12-23 11:22:22,444 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 11:22:22,540 - aiogram.event - INFO - Update id=659309204 is handled. Duration 1250 ms by bot id=7444575424
2024-12-23 11:22:24,716 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:22:24,718 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:22:24,718 - sqlalchemy.engine.Engine - INFO - [cached since 10.94s ago] ('98', 1, 0)
2024-12-23 11:22:25,071 - aiogram.event - INFO - Update id=659309205 is handled. Duration 1500 ms by bot id=7444575424
2024-12-23 11:22:26,559 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:22:26,561 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:22:26,562 - sqlalchemy.engine.Engine - INFO - [cached since 12.78s ago] ('98', 1, 0)
2024-12-23 11:22:27,504 - aiogram.event - INFO - Update id=659309206 is handled. Duration 953 ms by bot id=7444575424
2024-12-23 11:28:34,478 - aiogram.dispatcher - INFO - Polling stopped
2024-12-23 11:28:34,479 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - Request timeout error
2024-12-23 11:28:34,479 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2024-12-23 11:28:34,737 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-23 11:28:34,740 - root - INFO - Бот остановлен вручную.
2024-12-23 11:28:35,094 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000175FF6C6790>
2024-12-23 11:28:48,115 - root - INFO - Инициализация бота...
2024-12-23 11:28:48,813 - root - INFO - Инициализация бота...
2024-12-23 11:28:48,885 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:28:48,885 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-23 11:28:48,885 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 11:28:48,887 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2024-12-23 11:28:48,887 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 11:28:48,887 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-23 11:28:48,887 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 11:28:48,888 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("keys")
2024-12-23 11:28:48,888 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-23 11:28:48,889 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	user_telegram_id VARCHAR NOT NULL, 
	subscription_status VARCHAR, 
	use_trial_period BOOLEAN, 
	PRIMARY KEY (user_telegram_id)
)


2024-12-23 11:28:48,889 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2024-12-23 11:28:48,900 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE keys (
	key_id VARCHAR NOT NULL, 
	user_telegram_id VARCHAR, 
	expiration_date DATETIME, 
	start_date DATETIME, 
	remembering_before_exp BOOLEAN, 
	PRIMARY KEY (key_id), 
	FOREIGN KEY(user_telegram_id) REFERENCES users (user_telegram_id)
)


2024-12-23 11:28:48,900 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2024-12-23 11:28:48,909 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 11:28:48,946 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-23 11:28:48,946 - root - INFO - Инициализация диспетчера...
2024-12-23 11:28:48,947 - root - INFO - Регистрация обработчиков...
2024-12-23 11:28:48,949 - root - INFO - Регистрация main menu команд...
2024-12-23 11:28:49,460 - root - INFO - Команды успешно установлены
2024-12-23 11:28:49,461 - root - INFO - Запуск polling...
2024-12-23 11:28:49,462 - aiogram.dispatcher - INFO - Start polling
2024-12-23 11:28:49,482 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:28:49,489 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-23 11:28:49,490 - sqlalchemy.engine.Engine - INFO - [generated in 0.00101s] ()
2024-12-23 11:28:49,563 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-23 11:29:07,444 - aiogram.event - INFO - Update id=659309207 is handled. Duration 282 ms by bot id=7444575424
2024-12-23 11:32:27,801 - aiogram.event - INFO - Update id=659309208 is handled. Duration 250 ms by bot id=7444575424
2024-12-23 11:32:37,480 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:32:37,485 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:32:37,487 - sqlalchemy.engine.Engine - INFO - [generated in 0.00118s] ('181151262', 1, 0)
2024-12-23 11:32:37,700 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 11:32:37,788 - aiogram.event - INFO - Update id=659309209 is handled. Duration 312 ms by bot id=7444575424
2024-12-23 11:32:39,314 - aiogram.event - INFO - Update id=659309210 is handled. Duration 297 ms by bot id=7444575424
2024-12-23 11:32:40,335 - aiogram.event - INFO - Update id=659309211 is handled. Duration 375 ms by bot id=7444575424
2024-12-23 11:32:46,949 - aiogram.event - INFO - Update id=659309212 is handled. Duration 141 ms by bot id=7444575424
2024-12-23 11:32:47,226 - aiogram.event - INFO - Update id=659309213 is handled. Duration 280 ms by bot id=7444575424
2024-12-23 11:32:53,401 - aiogram.event - INFO - Update id=659309214 is not handled. Duration 0 ms by bot id=7444575424
2024-12-23 11:32:58,043 - aiogram.event - INFO - Update id=659309215 is not handled. Duration 0 ms by bot id=7444575424
2024-12-23 11:38:15,329 - aiogram.event - INFO - Update id=659309216 is handled. Duration 233 ms by bot id=7444575424
2024-12-23 11:38:20,683 - aiogram.event - INFO - Update id=659309217 is handled. Duration 187 ms by bot id=7444575424
2024-12-23 11:38:23,123 - aiogram.event - INFO - Update id=659309218 is handled. Duration 344 ms by bot id=7444575424
2024-12-23 11:38:35,956 - aiogram.event - INFO - Update id=659309219 is handled. Duration 233 ms by bot id=7444575424
2024-12-23 11:38:37,636 - aiogram.event - INFO - Update id=659309220 is handled. Duration 234 ms by bot id=7444575424
2024-12-23 11:38:51,777 - aiogram.event - INFO - Update id=659309221 is handled. Duration 155 ms by bot id=7444575424
2024-12-23 11:38:53,552 - aiogram.event - INFO - Update id=659309222 is handled. Duration 281 ms by bot id=7444575424
2024-12-23 11:38:53,719 - aiogram.event - INFO - Update id=659309223 is handled. Duration 280 ms by bot id=7444575424
2024-12-23 11:38:54,436 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:38:54,439 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:38:54,439 - sqlalchemy.engine.Engine - INFO - [cached since 377s ago] ('181151262', 1, 0)
2024-12-23 11:38:54,447 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (user_telegram_id, subscription_status, use_trial_period) VALUES (?, ?, ?)
2024-12-23 11:38:54,447 - sqlalchemy.engine.Engine - INFO - [generated in 0.00102s] ('181151262', 'active', 0)
2024-12-23 11:38:54,454 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 11:38:54,471 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:38:54,476 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-23 11:38:54,476 - sqlalchemy.engine.Engine - INFO - [generated in 0.00098s] ('181151262',)
2024-12-23 11:38:54,483 - sqlalchemy.engine.Engine - INFO - UPDATE users SET use_trial_period=? WHERE users.user_telegram_id = ?
2024-12-23 11:38:54,484 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] (1, '181151262')
2024-12-23 11:38:54,487 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 11:38:56,018 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:38:56,023 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2024-12-23 11:38:56,024 - sqlalchemy.engine.Engine - INFO - [generated in 0.00163s] ('99', '181151262', '2024-12-25 11:38:56.016978', '2024-12-23 11:38:56.016978', 0)
2024-12-23 11:38:56,031 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 11:38:56,048 - root - INFO - Key created: OutlineKey(key_id='99', name='VPN Key57', password='D9zjOFihE9Bth6UllGl8A7', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpEOXpqT0ZpaEU5QnRoNlVsbEdsOEE3@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2024-12-23 11:38:56,181 - aiogram.event - INFO - Update id=659309224 is handled. Duration 1750 ms by bot id=7444575424
2024-12-23 11:38:58,373 - aiogram.event - INFO - Update id=659309225 is handled. Duration 171 ms by bot id=7444575424
2024-12-23 11:39:00,387 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:39:00,389 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:39:00,389 - sqlalchemy.engine.Engine - INFO - [cached since 382.9s ago] ('851080586', 1, 0)
2024-12-23 11:39:00,393 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (user_telegram_id, subscription_status, use_trial_period) VALUES (?, ?, ?)
2024-12-23 11:39:00,393 - sqlalchemy.engine.Engine - INFO - [cached since 5.947s ago] ('851080586', 'active', 0)
2024-12-23 11:39:00,400 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 11:39:00,415 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:39:00,416 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-23 11:39:00,417 - sqlalchemy.engine.Engine - INFO - [cached since 5.942s ago] ('851080586',)
2024-12-23 11:39:00,421 - sqlalchemy.engine.Engine - INFO - UPDATE users SET use_trial_period=? WHERE users.user_telegram_id = ?
2024-12-23 11:39:00,421 - sqlalchemy.engine.Engine - INFO - [cached since 5.938s ago] (1, '851080586')
2024-12-23 11:39:00,425 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 11:39:01,368 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:39:01,370 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2024-12-23 11:39:01,371 - sqlalchemy.engine.Engine - INFO - [cached since 5.348s ago] ('100', '851080586', '2024-12-25 11:39:01.367506', '2024-12-23 11:39:01.367506', 0)
2024-12-23 11:39:01,377 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-23 11:39:01,393 - root - INFO - Key created: OutlineKey(key_id='100', name='VPN Key58', password='r0omVuJ7jDdyWfJRnCDfqt', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpyMG9tVnVKN2pEZHlXZkpSbkNEZnF0@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2024-12-23 11:39:01,545 - aiogram.event - INFO - Update id=659309226 is handled. Duration 1155 ms by bot id=7444575424
2024-12-23 11:40:31,660 - aiogram.event - INFO - Update id=659309227 is handled. Duration 280 ms by bot id=7444575424
2024-12-23 11:40:33,694 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:40:33,696 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:40:33,696 - sqlalchemy.engine.Engine - INFO - [cached since 476.2s ago] ('181151262', 1, 0)
2024-12-23 11:40:33,705 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-23 11:40:33,705 - sqlalchemy.engine.Engine - INFO - [generated in 0.00096s] ('181151262',)
2024-12-23 11:40:35,305 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-23 11:40:35,412 - aiogram.event - INFO - Update id=659309228 is handled. Duration 1717 ms by bot id=7444575424
2024-12-23 11:40:37,653 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:40:37,658 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:40:37,658 - sqlalchemy.engine.Engine - INFO - [generated in 0.00114s] ('99', 1, 0)
2024-12-23 11:40:37,861 - aiogram.event - INFO - Update id=659309229 is handled. Duration 1421 ms by bot id=7444575424
2024-12-23 11:40:38,995 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:40:38,996 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:40:38,997 - sqlalchemy.engine.Engine - INFO - [cached since 1.339s ago] ('99', 1, 0)
2024-12-23 11:40:40,261 - aiogram.event - INFO - Update id=659309230 is handled. Duration 1281 ms by bot id=7444575424
2024-12-23 11:41:17,178 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:41:17,179 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:41:17,180 - sqlalchemy.engine.Engine - INFO - [cached since 39.52s ago] ('99', 1, 0)
2024-12-23 11:41:17,445 - aiogram.event - INFO - Update id=659309231 is handled. Duration 1219 ms by bot id=7444575424
2024-12-23 11:41:18,578 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:41:18,579 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:41:18,580 - sqlalchemy.engine.Engine - INFO - [cached since 40.92s ago] ('99', 1, 0)
2024-12-23 11:41:19,866 - aiogram.event - INFO - Update id=659309232 is handled. Duration 1296 ms by bot id=7444575424
2024-12-23 11:41:41,195 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:41:41,198 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:41:41,198 - sqlalchemy.engine.Engine - INFO - [cached since 63.54s ago] ('99', 1, 0)
2024-12-23 11:41:41,411 - aiogram.event - INFO - Update id=659309233 is handled. Duration 1250 ms by bot id=7444575424
2024-12-23 11:42:37,796 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:42:37,797 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:42:37,798 - sqlalchemy.engine.Engine - INFO - [cached since 120.1s ago] ('99', 1, 0)
2024-12-23 11:42:39,295 - aiogram.event - INFO - Update id=659309234 is handled. Duration 1500 ms by bot id=7444575424
2024-12-23 11:43:16,326 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-23 11:43:16,327 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-23 11:43:16,328 - sqlalchemy.engine.Engine - INFO - [cached since 158.7s ago] ('99', 1, 0)
2024-12-23 11:43:16,529 - aiogram.event - INFO - Update id=659309235 is handled. Duration 1343 ms by bot id=7444575424
2024-12-23 16:53:49,871 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - Request timeout error
2024-12-23 16:53:49,872 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2024-12-23 16:53:51,146 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7444575424)
2024-12-23 16:53:51,609 - aiogram.event - INFO - Update id=659309239 is handled. Duration 453 ms by bot id=7444575424
2024-12-23 16:53:51,632 - aiogram.event - INFO - Update id=659309236 is handled. Duration 484 ms by bot id=7444575424
2024-12-23 16:53:51,651 - aiogram.event - INFO - Update id=659309237 is handled. Duration 500 ms by bot id=7444575424
2024-12-23 16:53:51,691 - aiogram.event - INFO - Update id=659309238 is handled. Duration 547 ms by bot id=7444575424
2024-12-23 16:53:57,826 - aiogram.dispatcher - INFO - Polling stopped
2024-12-26 15:20:59,655 - root - INFO - Инициализация бота...
2024-12-26 15:21:01,823 - root - INFO - Инициализация бота...
2024-12-26 15:21:01,999 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:21:01,999 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2024-12-26 15:21:01,999 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-26 15:21:02,005 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2024-12-26 15:21:02,005 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-26 15:21:02,006 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2024-12-26 15:21:02,006 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-26 15:21:02,007 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("keys")
2024-12-26 15:21:02,008 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2024-12-26 15:21:02,010 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	user_telegram_id VARCHAR NOT NULL, 
	subscription_status VARCHAR, 
	use_trial_period BOOLEAN, 
	PRIMARY KEY (user_telegram_id)
)


2024-12-26 15:21:02,010 - sqlalchemy.engine.Engine - INFO - [no key 0.00054s] ()
2024-12-26 15:21:02,244 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE keys (
	key_id VARCHAR NOT NULL, 
	user_telegram_id VARCHAR, 
	expiration_date DATETIME, 
	start_date DATETIME, 
	remembering_before_exp BOOLEAN, 
	PRIMARY KEY (key_id), 
	FOREIGN KEY(user_telegram_id) REFERENCES users (user_telegram_id)
)


2024-12-26 15:21:02,245 - sqlalchemy.engine.Engine - INFO - [no key 0.00052s] ()
2024-12-26 15:21:02,411 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-26 15:21:02,511 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2024-12-26 15:21:02,512 - root - INFO - Инициализация диспетчера...
2024-12-26 15:21:02,514 - root - INFO - Регистрация обработчиков...
2024-12-26 15:21:02,518 - root - INFO - Регистрация main menu команд...
2024-12-26 15:21:03,196 - root - INFO - Команды успешно установлены
2024-12-26 15:21:03,196 - root - INFO - Запуск polling...
2024-12-26 15:21:03,197 - aiogram.dispatcher - INFO - Start polling
2024-12-26 15:21:03,208 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:21:03,212 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2024-12-26 15:21:03,213 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] ()
2024-12-26 15:21:03,282 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-26 15:21:12,776 - aiogram.event - INFO - Update id=659309240 is handled. Duration 532 ms by bot id=7444575424
2024-12-26 15:22:28,538 - aiogram.event - INFO - Update id=659309241 is handled. Duration 250 ms by bot id=7444575424
2024-12-26 15:22:44,336 - aiogram.event - INFO - Update id=659309242 is handled. Duration 515 ms by bot id=7444575424
2024-12-26 15:23:19,439 - aiogram.event - INFO - Update id=659309243 is handled. Duration 500 ms by bot id=7444575424
2024-12-26 15:23:23,513 - aiogram.event - INFO - Update id=659309244 is handled. Duration 186 ms by bot id=7444575424
2024-12-26 15:23:28,088 - aiogram.event - INFO - Update id=659309245 is handled. Duration 437 ms by bot id=7444575424
2024-12-26 15:23:32,905 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:23:32,911 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:23:32,911 - sqlalchemy.engine.Engine - INFO - [generated in 0.00125s] ('1311959588', 1, 0)
2024-12-26 15:23:33,321 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-26 15:23:33,404 - aiogram.event - INFO - Update id=659309246 is handled. Duration 500 ms by bot id=7444575424
2024-12-26 15:23:40,163 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:23:40,163 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:23:40,163 - sqlalchemy.engine.Engine - INFO - [cached since 7.253s ago] ('1311959588', 1, 0)
2024-12-26 15:23:40,166 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (user_telegram_id, subscription_status, use_trial_period) VALUES (?, ?, ?)
2024-12-26 15:23:40,167 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] ('1311959588', 'active', 0)
2024-12-26 15:23:40,168 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-26 15:23:40,177 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:23:40,178 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2024-12-26 15:23:40,178 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] ('1311959588',)
2024-12-26 15:23:40,181 - sqlalchemy.engine.Engine - INFO - UPDATE users SET use_trial_period=? WHERE users.user_telegram_id = ?
2024-12-26 15:23:40,181 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] (1, '1311959588')
2024-12-26 15:23:40,182 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-26 15:23:41,438 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:23:41,440 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2024-12-26 15:23:41,440 - sqlalchemy.engine.Engine - INFO - [generated in 0.00071s] ('103', '1311959588', '2024-12-28 15:23:41.437204', '2024-12-26 15:23:41.437204', 0)
2024-12-26 15:23:41,445 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-26 15:23:41,457 - root - INFO - Key created: OutlineKey(key_id='103', name='VPN Key61', password='upW2o3hsntINQNU07RUq8M', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTp1cFcybzNoc250SU5RTlUwN1JVcThN@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2024-12-26 15:23:41,545 - aiogram.event - INFO - Update id=659309247 is handled. Duration 1390 ms by bot id=7444575424
2024-12-26 15:24:25,650 - aiogram.event - INFO - Update id=659309248 is handled. Duration 437 ms by bot id=7444575424
2024-12-26 15:24:37,704 - aiogram.event - INFO - Update id=659309249 is handled. Duration 282 ms by bot id=7444575424
2024-12-26 15:24:41,148 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:24:41,149 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:24:41,149 - sqlalchemy.engine.Engine - INFO - [cached since 68.24s ago] ('1311959588', 1, 0)
2024-12-26 15:24:41,154 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-26 15:24:41,154 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ('1311959588',)
2024-12-26 15:24:42,479 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-26 15:24:42,541 - aiogram.event - INFO - Update id=659309250 is handled. Duration 1406 ms by bot id=7444575424
2024-12-26 15:25:02,060 - aiogram.event - INFO - Update id=659309251 is handled. Duration 375 ms by bot id=7444575424
2024-12-26 15:25:04,595 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:25:04,596 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:25:04,597 - sqlalchemy.engine.Engine - INFO - [cached since 91.69s ago] ('1311959588', 1, 0)
2024-12-26 15:25:04,600 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-26 15:25:04,601 - sqlalchemy.engine.Engine - INFO - [cached since 23.45s ago] ('1311959588',)
2024-12-26 15:25:05,811 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-26 15:25:05,883 - aiogram.event - INFO - Update id=659309252 is handled. Duration 1280 ms by bot id=7444575424
2024-12-26 15:25:08,539 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:25:08,541 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:25:08,542 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] ('103', 1, 0)
2024-12-26 15:25:08,674 - aiogram.event - INFO - Update id=659309253 is handled. Duration 1375 ms by bot id=7444575424
2024-12-26 15:25:12,681 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:25:12,683 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:25:12,683 - sqlalchemy.engine.Engine - INFO - [cached since 4.142s ago] ('103', 1, 0)
2024-12-26 15:25:14,891 - aiogram.event - INFO - Update id=659309254 is handled. Duration 2218 ms by bot id=7444575424
2024-12-26 15:25:40,463 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:25:40,465 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:25:40,465 - sqlalchemy.engine.Engine - INFO - [cached since 31.92s ago] ('103', 1, 0)
2024-12-26 15:25:40,758 - aiogram.event - INFO - Update id=659309255 is handled. Duration 1733 ms by bot id=7444575424
2024-12-26 15:25:43,192 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:25:43,192 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:25:43,192 - sqlalchemy.engine.Engine - INFO - [cached since 34.65s ago] ('103', 1, 0)
2024-12-26 15:25:43,335 - aiogram.event - INFO - Update id=659309256 is handled. Duration 141 ms by bot id=7444575424
2024-12-26 15:25:48,847 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:25:48,848 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:25:48,849 - sqlalchemy.engine.Engine - INFO - [cached since 40.31s ago] ('103', 1, 0)
2024-12-26 15:25:48,972 - aiogram.event - INFO - Update id=659309257 is handled. Duration 1375 ms by bot id=7444575424
2024-12-26 15:25:52,589 - aiogram.event - INFO - Update id=659309258 is handled. Duration 78 ms by bot id=7444575424
2024-12-26 15:26:03,389 - aiogram.event - INFO - Update id=659309259 is handled. Duration 421 ms by bot id=7444575424
2024-12-26 15:26:11,321 - aiogram.event - INFO - Update id=659309260 is handled. Duration 204 ms by bot id=7444575424
2024-12-26 15:26:15,572 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:26:15,573 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:26:15,574 - sqlalchemy.engine.Engine - INFO - [cached since 67.03s ago] ('103', 1, 0)
2024-12-26 15:26:15,731 - aiogram.event - INFO - Update id=659309261 is handled. Duration 1406 ms by bot id=7444575424
2024-12-26 15:26:20,598 - aiogram.event - INFO - Update id=659309262 is handled. Duration 94 ms by bot id=7444575424
2024-12-26 15:26:28,277 - aiogram.event - INFO - Update id=659309263 is handled. Duration 171 ms by bot id=7444575424
2024-12-26 15:26:29,634 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:26:29,635 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:26:29,635 - sqlalchemy.engine.Engine - INFO - [cached since 81.09s ago] ('103', 1, 0)
2024-12-26 15:26:29,636 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-26 15:26:29,638 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:26:29,638 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2024-12-26 15:26:29,639 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] ('103',)
2024-12-26 15:26:30,004 - aiogram.event - INFO - Update id=659309264 is handled. Duration 375 ms by bot id=7444575424
2024-12-26 15:26:34,143 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:26:34,144 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:26:34,144 - sqlalchemy.engine.Engine - INFO - [cached since 85.6s ago] ('103', 1, 0)
2024-12-26 15:26:34,326 - aiogram.event - INFO - Update id=659309265 is handled. Duration 1454 ms by bot id=7444575424
2024-12-26 15:26:39,252 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:26:39,253 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:26:39,253 - sqlalchemy.engine.Engine - INFO - [cached since 90.71s ago] ('103', 1, 0)
2024-12-26 15:26:41,305 - aiogram.event - INFO - Update id=659309266 is handled. Duration 2047 ms by bot id=7444575424
2024-12-26 15:26:46,287 - aiogram.event - INFO - Update id=659309267 is handled. Duration 500 ms by bot id=7444575424
2024-12-26 15:26:47,589 - aiogram.event - INFO - Update id=659309268 is handled. Duration 156 ms by bot id=7444575424
2024-12-26 15:27:01,352 - aiogram.event - INFO - Update id=659309269 is handled. Duration 358 ms by bot id=7444575424
2024-12-26 15:28:22,821 - aiogram.event - INFO - Update id=659309270 is handled. Duration 204 ms by bot id=7444575424
2024-12-26 15:28:44,372 - root - INFO - {
    "message_id": 4451,
    "date": 1735216125,
    "chat": {
        "id": 1311959588,
        "type": "private",
        "title": null,
        "username": "existentioan",
        "first_name": "Tatiana",
        "last_name": "Ko",
        "is_forum": null,
        "accent_color_id": null,
        "active_usernames": null,
        "available_reactions": null,
        "background_custom_emoji_id": null,
        "bio": null,
        "birthdate": null,
        "business_intro": null,
        "business_location": null,
        "business_opening_hours": null,
        "can_set_sticker_set": null,
        "custom_emoji_sticker_set_name": null,
        "description": null,
        "emoji_status_custom_emoji_id": null,
        "emoji_status_expiration_date": null,
        "has_aggressive_anti_spam_enabled": null,
        "has_hidden_members": null,
        "has_private_forwards": null,
        "has_protected_content": null,
        "has_restricted_voice_and_video_messages": null,
        "has_visible_history": null,
        "invite_link": null,
        "join_by_request": null,
        "join_to_send_messages": null,
        "linked_chat_id": null,
        "location": null,
        "message_auto_delete_time": null,
        "permissions": null,
        "personal_chat": null,
        "photo": null,
        "pinned_message": null,
        "profile_accent_color_id": null,
        "profile_background_custom_emoji_id": null,
        "slow_mode_delay": null,
        "sticker_set_name": null,
        "unrestrict_boost_count": null
    },
    "message_thread_id": null,
    "from_user": {
        "id": 1311959588,
        "is_bot": false,
        "first_name": "Tatiana",
        "last_name": "Ko",
        "username": "existentioan",
        "language_code": "ru",
        "is_premium": null,
        "added_to_attachment_menu": null,
        "can_join_groups": null,
        "can_read_all_group_messages": null,
        "supports_inline_queries": null,
        "can_connect_to_business": null,
        "has_main_web_app": null
    },
    "sender_chat": null,
    "sender_boost_count": null,
    "sender_business_bot": null,
    "business_connection_id": null,
    "forward_origin": null,
    "is_topic_message": null,
    "is_automatic_forward": null,
    "reply_to_message": null,
    "external_reply": null,
    "quote": null,
    "reply_to_story": null,
    "via_bot": null,
    "edit_date": null,
    "has_protected_content": null,
    "is_from_offline": null,
    "media_group_id": null,
    "author_signature": null,
    "text": null,
    "entities": null,
    "link_preview_options": null,
    "effect_id": null,
    "animation": null,
    "audio": null,
    "document": null,
    "paid_media": null,
    "photo": null,
    "sticker": null,
    "story": null,
    "video": null,
    "video_note": null,
    "voice": null,
    "caption": null,
    "caption_entities": null,
    "show_caption_above_media": null,
    "has_media_spoiler": null,
    "contact": null,
    "dice": null,
    "game": null,
    "poll": null,
    "venue": null,
    "location": null,
    "new_chat_members": null,
    "left_chat_member": null,
    "new_chat_title": null,
    "new_chat_photo": null,
    "delete_chat_photo": null,
    "group_chat_created": null,
    "supergroup_chat_created": null,
    "channel_chat_created": null,
    "message_auto_delete_timer_changed": null,
    "migrate_to_chat_id": null,
    "migrate_from_chat_id": null,
    "pinned_message": null,
    "invoice": null,
    "successful_payment": {
        "currency": "RUB",
        "total_amount": 14000,
        "invoice_payload": "52c307fb-3cae-4b7e-b24b-78e0c34df131",
        "telegram_payment_charge_id": "7444575424_1311959588_45347",
        "provider_payment_charge_id": "7444575424_1311959588_45347",
        "subscription_expiration_date": null,
        "is_recurring": null,
        "is_first_recurring": null,
        "shipping_option_id": null,
        "order_info": null
    },
    "refunded_payment": null,
    "users_shared": null,
    "chat_shared": null,
    "connected_website": null,
    "write_access_allowed": null,
    "passport_data": null,
    "proximity_alert_triggered": null,
    "boost_added": null,
    "chat_background_set": null,
    "forum_topic_created": null,
    "forum_topic_edited": null,
    "forum_topic_closed": null,
    "forum_topic_reopened": null,
    "general_forum_topic_hidden": null,
    "general_forum_topic_unhidden": null,
    "giveaway_created": null,
    "giveaway": null,
    "giveaway_winners": null,
    "giveaway_completed": null,
    "video_chat_scheduled": null,
    "video_chat_started": null,
    "video_chat_ended": null,
    "video_chat_participants_invited": null,
    "web_app_data": null,
    "reply_markup": null,
    "forward_date": null,
    "forward_from": null,
    "forward_from_chat": null,
    "forward_from_message_id": null,
    "forward_sender_name": null,
    "forward_signature": null,
    "user_shared": null
}
2024-12-26 15:28:45,660 - root - INFO - Key created: OutlineKey(key_id='104', name='VPN Key62', password='cnZd0mRSwNowqzzHDQ2UoP', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpjblpkMG1SU3dOb3dxenpIRFEyVW9Q@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 1311959588
2024-12-26 15:28:45,913 - root - INFO - Key created: OutlineKey(key_id='104', name='VPN Key62', password='cnZd0mRSwNowqzzHDQ2UoP', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpjblpkMG1SU3dOb3dxenpIRFEyVW9Q@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2024-12-26 15:28:45,999 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:28:46,000 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:28:46,000 - sqlalchemy.engine.Engine - INFO - [cached since 313.1s ago] ('1311959588', 1, 0)
2024-12-26 15:28:46,002 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2024-12-26 15:28:46,003 - sqlalchemy.engine.Engine - INFO - [cached since 304.6s ago] ('104', '1311959588', '2025-03-26 15:28:46.001210', '2024-12-26 15:28:46.001210', 0)
2024-12-26 15:28:46,007 - sqlalchemy.engine.Engine - INFO - COMMIT
2024-12-26 15:28:46,020 - aiogram.event - INFO - Update id=659309271 is handled. Duration 1641 ms by bot id=7444575424
2024-12-26 15:28:58,493 - aiogram.event - INFO - Update id=659309272 is handled. Duration 202 ms by bot id=7444575424
2024-12-26 15:28:59,974 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:28:59,976 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:28:59,977 - sqlalchemy.engine.Engine - INFO - [cached since 327.1s ago] ('1311959588', 1, 0)
2024-12-26 15:28:59,980 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-26 15:28:59,981 - sqlalchemy.engine.Engine - INFO - [cached since 258.8s ago] ('1311959588',)
2024-12-26 15:29:03,182 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-26 15:29:03,250 - aiogram.event - INFO - Update id=659309273 is handled. Duration 3280 ms by bot id=7444575424
2024-12-26 15:29:11,087 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:29:11,089 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:29:11,090 - sqlalchemy.engine.Engine - INFO - [cached since 242.5s ago] ('104', 1, 0)
2024-12-26 15:29:11,299 - aiogram.event - INFO - Update id=659309274 is handled. Duration 1608 ms by bot id=7444575424
2024-12-26 15:29:14,772 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:29:14,773 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:29:14,774 - sqlalchemy.engine.Engine - INFO - [cached since 246.2s ago] ('104', 1, 0)
2024-12-26 15:29:15,039 - aiogram.event - INFO - Update id=659309275 is handled. Duration 266 ms by bot id=7444575424
2024-12-26 15:29:20,982 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:29:20,983 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:29:20,983 - sqlalchemy.engine.Engine - INFO - [cached since 252.4s ago] ('104', 1, 0)
2024-12-26 15:29:21,126 - aiogram.event - INFO - Update id=659309276 is handled. Duration 1530 ms by bot id=7444575424
2024-12-26 15:29:23,069 - aiogram.event - INFO - Update id=659309277 is handled. Duration 108 ms by bot id=7444575424
2024-12-26 15:30:46,332 - aiogram.event - INFO - Update id=659309278 is handled. Duration 266 ms by bot id=7444575424
2024-12-26 15:30:50,106 - aiogram.event - INFO - Update id=659309279 is handled. Duration 110 ms by bot id=7444575424
2024-12-26 15:30:52,892 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:30:52,892 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:30:52,892 - sqlalchemy.engine.Engine - INFO - [cached since 344.4s ago] ('104', 1, 0)
2024-12-26 15:30:53,156 - aiogram.event - INFO - Update id=659309280 is handled. Duration 1391 ms by bot id=7444575424
2024-12-26 15:30:55,997 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2024-12-26 15:30:55,998 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2024-12-26 15:30:55,998 - sqlalchemy.engine.Engine - INFO - [cached since 443.1s ago] ('1311959588', 1, 0)
2024-12-26 15:30:56,000 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2024-12-26 15:30:56,000 - sqlalchemy.engine.Engine - INFO - [cached since 374.8s ago] ('1311959588',)
2024-12-26 15:30:58,129 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2024-12-26 15:30:58,129 - aiogram.event - INFO - Update id=659309281 is handled. Duration 2125 ms by bot id=7444575424
2024-12-26 15:31:00,739 - aiogram.event - INFO - Update id=659309282 is handled. Duration 125 ms by bot id=7444575424
2024-12-26 15:31:02,641 - aiogram.event - INFO - Update id=659309283 is handled. Duration 233 ms by bot id=7444575424
2024-12-26 15:31:12,405 - aiogram.event - INFO - Update id=659309284 is handled. Duration 171 ms by bot id=7444575424
2024-12-26 15:31:43,665 - aiogram.dispatcher - INFO - Polling stopped
2024-12-26 15:31:43,927 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2024-12-26 15:31:43,928 - root - INFO - Бот остановлен вручную.
2025-01-06 19:49:08,543 - root - INFO - Инициализация бота...
2025-01-06 19:49:09,513 - root - INFO - Инициализация бота...
2025-01-06 19:49:09,584 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-06 19:49:09,584 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-06 19:49:09,584 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-06 19:49:09,587 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2025-01-06 19:49:09,587 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-06 19:49:09,587 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-06 19:49:09,587 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-06 19:49:09,587 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("keys")
2025-01-06 19:49:09,587 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-06 19:49:09,588 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	user_telegram_id VARCHAR NOT NULL, 
	subscription_status VARCHAR, 
	use_trial_period BOOLEAN, 
	PRIMARY KEY (user_telegram_id)
)


2025-01-06 19:49:09,588 - sqlalchemy.engine.Engine - INFO - [no key 0.00014s] ()
2025-01-06 19:49:09,598 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE keys (
	key_id VARCHAR NOT NULL, 
	user_telegram_id VARCHAR, 
	expiration_date DATETIME, 
	start_date DATETIME, 
	remembering_before_exp BOOLEAN, 
	PRIMARY KEY (key_id), 
	FOREIGN KEY(user_telegram_id) REFERENCES users (user_telegram_id)
)


2025-01-06 19:49:09,598 - sqlalchemy.engine.Engine - INFO - [no key 0.00018s] ()
2025-01-06 19:49:09,605 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-06 19:49:09,651 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-06 19:49:09,651 - root - INFO - Инициализация диспетчера...
2025-01-06 19:49:09,651 - root - INFO - Регистрация обработчиков...
2025-01-06 19:49:09,653 - root - INFO - Регистрация main menu команд...
2025-01-06 19:49:10,260 - root - INFO - Команды успешно установлены
2025-01-06 19:49:10,260 - root - INFO - Запуск polling...
2025-01-06 19:49:10,260 - aiogram.dispatcher - INFO - Start polling
2025-01-06 19:49:10,263 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-06 19:49:10,265 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-06 19:49:10,265 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] ()
2025-01-06 19:49:10,308 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-06 19:49:27,009 - aiogram.event - INFO - Update id=659309287 is handled. Duration 297 ms by bot id=7444575424
2025-01-06 19:49:31,129 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-06 19:49:31,134 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-06 19:49:31,135 - sqlalchemy.engine.Engine - INFO - [generated in 0.00107s] ('528155210', 1, 0)
2025-01-06 19:49:31,303 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-06 19:49:31,394 - aiogram.event - INFO - Update id=659309288 is handled. Duration 265 ms by bot id=7444575424
2025-01-06 19:49:32,844 - aiogram.event - INFO - Update id=659309289 is handled. Duration 327 ms by bot id=7444575424
2025-01-06 19:49:34,854 - aiogram.event - INFO - Update id=659309290 is handled. Duration 515 ms by bot id=7444575424
2025-01-06 19:49:36,268 - aiogram.event - INFO - Update id=659309291 is handled. Duration 562 ms by bot id=7444575424
2025-01-06 19:50:06,845 - aiogram.event - INFO - Update id=659309292 is handled. Duration 562 ms by bot id=7444575424
2025-01-06 19:50:13,245 - root - INFO - {
    "message_id": 4460,
    "date": 1736182215,
    "chat": {
        "id": 528155210,
        "type": "private",
        "title": null,
        "username": "dastroo",
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "is_forum": null,
        "accent_color_id": null,
        "active_usernames": null,
        "available_reactions": null,
        "background_custom_emoji_id": null,
        "bio": null,
        "birthdate": null,
        "business_intro": null,
        "business_location": null,
        "business_opening_hours": null,
        "can_set_sticker_set": null,
        "custom_emoji_sticker_set_name": null,
        "description": null,
        "emoji_status_custom_emoji_id": null,
        "emoji_status_expiration_date": null,
        "has_aggressive_anti_spam_enabled": null,
        "has_hidden_members": null,
        "has_private_forwards": null,
        "has_protected_content": null,
        "has_restricted_voice_and_video_messages": null,
        "has_visible_history": null,
        "invite_link": null,
        "join_by_request": null,
        "join_to_send_messages": null,
        "linked_chat_id": null,
        "location": null,
        "message_auto_delete_time": null,
        "permissions": null,
        "personal_chat": null,
        "photo": null,
        "pinned_message": null,
        "profile_accent_color_id": null,
        "profile_background_custom_emoji_id": null,
        "slow_mode_delay": null,
        "sticker_set_name": null,
        "unrestrict_boost_count": null
    },
    "message_thread_id": null,
    "from_user": {
        "id": 528155210,
        "is_bot": false,
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "username": "dastroo",
        "language_code": "ru",
        "is_premium": null,
        "added_to_attachment_menu": null,
        "can_join_groups": null,
        "can_read_all_group_messages": null,
        "supports_inline_queries": null,
        "can_connect_to_business": null,
        "has_main_web_app": null
    },
    "sender_chat": null,
    "sender_boost_count": null,
    "sender_business_bot": null,
    "business_connection_id": null,
    "forward_origin": null,
    "is_topic_message": null,
    "is_automatic_forward": null,
    "reply_to_message": null,
    "external_reply": null,
    "quote": null,
    "reply_to_story": null,
    "via_bot": null,
    "edit_date": null,
    "has_protected_content": null,
    "is_from_offline": null,
    "media_group_id": null,
    "author_signature": null,
    "text": null,
    "entities": null,
    "link_preview_options": null,
    "effect_id": null,
    "animation": null,
    "audio": null,
    "document": null,
    "paid_media": null,
    "photo": null,
    "sticker": null,
    "story": null,
    "video": null,
    "video_note": null,
    "voice": null,
    "caption": null,
    "caption_entities": null,
    "show_caption_above_media": null,
    "has_media_spoiler": null,
    "contact": null,
    "dice": null,
    "game": null,
    "poll": null,
    "venue": null,
    "location": null,
    "new_chat_members": null,
    "left_chat_member": null,
    "new_chat_title": null,
    "new_chat_photo": null,
    "delete_chat_photo": null,
    "group_chat_created": null,
    "supergroup_chat_created": null,
    "channel_chat_created": null,
    "message_auto_delete_timer_changed": null,
    "migrate_to_chat_id": null,
    "migrate_from_chat_id": null,
    "pinned_message": null,
    "invoice": null,
    "successful_payment": {
        "currency": "RUB",
        "total_amount": 27000,
        "invoice_payload": "ef4d50c9-77f2-4c0b-9770-fb020d2f3b42",
        "telegram_payment_charge_id": "7444575424_528155210_344309",
        "provider_payment_charge_id": "7444575424_528155210_344309",
        "subscription_expiration_date": null,
        "is_recurring": null,
        "is_first_recurring": null,
        "shipping_option_id": null,
        "order_info": null
    },
    "refunded_payment": null,
    "users_shared": null,
    "chat_shared": null,
    "connected_website": null,
    "write_access_allowed": null,
    "passport_data": null,
    "proximity_alert_triggered": null,
    "boost_added": null,
    "chat_background_set": null,
    "forum_topic_created": null,
    "forum_topic_edited": null,
    "forum_topic_closed": null,
    "forum_topic_reopened": null,
    "general_forum_topic_hidden": null,
    "general_forum_topic_unhidden": null,
    "giveaway_created": null,
    "giveaway": null,
    "giveaway_winners": null,
    "giveaway_completed": null,
    "video_chat_scheduled": null,
    "video_chat_started": null,
    "video_chat_ended": null,
    "video_chat_participants_invited": null,
    "web_app_data": null,
    "reply_markup": null,
    "forward_date": null,
    "forward_from": null,
    "forward_from_chat": null,
    "forward_from_message_id": null,
    "forward_sender_name": null,
    "forward_signature": null,
    "user_shared": null
}
2025-01-06 19:50:17,487 - root - INFO - Key created: OutlineKey(key_id='111', name='VPN Key69', password='DYJ5GXt2twlom81cUvc82s', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpEWUo1R1h0MnR3bG9tODFjVXZjODJz@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 528155210
2025-01-06 19:50:18,009 - root - INFO - Key created: OutlineKey(key_id='111', name='VPN Key69', password='DYJ5GXt2twlom81cUvc82s', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpEWUo1R1h0MnR3bG9tODFjVXZjODJz@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2025-01-06 19:50:18,327 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-06 19:50:18,328 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-06 19:50:18,329 - sqlalchemy.engine.Engine - INFO - [cached since 47.2s ago] ('528155210', 1, 0)
2025-01-06 19:50:18,334 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (user_telegram_id, subscription_status, use_trial_period) VALUES (?, ?, ?)
2025-01-06 19:50:18,334 - sqlalchemy.engine.Engine - INFO - [generated in 0.00073s] ('528155210', 'active', 0)
2025-01-06 19:50:18,338 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-06 19:50:18,354 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-06 19:50:18,357 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2025-01-06 19:50:18,357 - sqlalchemy.engine.Engine - INFO - [generated in 0.00081s] ('111', '528155210', '2025-07-05 19:50:18.353778', '2025-01-06 19:50:18.353778', 0)
2025-01-06 19:50:18,360 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-06 19:50:18,372 - aiogram.event - INFO - Update id=659309293 is handled. Duration 5125 ms by bot id=7444575424
2025-01-06 19:50:25,505 - aiogram.event - INFO - Update id=659309294 is handled. Duration 406 ms by bot id=7444575424
2025-01-06 19:50:28,329 - aiogram.event - INFO - Update id=659309295 is handled. Duration 187 ms by bot id=7444575424
2025-01-06 19:50:35,033 - aiogram.dispatcher - INFO - Polling stopped
2025-01-06 19:50:35,287 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-06 19:50:35,290 - root - INFO - Бот остановлен вручную.
2025-01-06 20:21:22,067 - root - INFO - Инициализация бота...
2025-01-06 20:21:23,474 - root - INFO - Инициализация бота...
2025-01-06 20:21:23,612 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-06 20:21:23,613 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-06 20:21:23,613 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-06 20:21:23,616 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2025-01-06 20:21:23,617 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-06 20:21:23,618 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-06 20:21:23,619 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-06 20:21:23,620 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("keys")
2025-01-06 20:21:23,620 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-06 20:21:23,622 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	user_telegram_id VARCHAR NOT NULL, 
	subscription_status VARCHAR, 
	use_trial_period BOOLEAN, 
	PRIMARY KEY (user_telegram_id)
)


2025-01-06 20:21:23,622 - sqlalchemy.engine.Engine - INFO - [no key 0.00052s] ()
2025-01-06 20:21:23,639 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE keys (
	key_id VARCHAR NOT NULL, 
	user_telegram_id VARCHAR, 
	expiration_date DATETIME, 
	start_date DATETIME, 
	remembering_before_exp BOOLEAN, 
	PRIMARY KEY (key_id), 
	FOREIGN KEY(user_telegram_id) REFERENCES users (user_telegram_id)
)


2025-01-06 20:21:23,639 - sqlalchemy.engine.Engine - INFO - [no key 0.00046s] ()
2025-01-06 20:21:23,652 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-06 20:21:23,761 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-06 20:21:23,762 - root - INFO - Инициализация диспетчера...
2025-01-06 20:21:23,766 - root - INFO - Регистрация обработчиков...
2025-01-06 20:21:23,770 - root - INFO - Регистрация main menu команд...
2025-01-06 20:21:24,492 - root - INFO - Команды успешно установлены
2025-01-06 20:21:24,493 - root - INFO - Запуск polling...
2025-01-06 20:21:24,495 - aiogram.dispatcher - INFO - Start polling
2025-01-06 20:21:24,516 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-06 20:21:24,523 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-06 20:21:24,523 - sqlalchemy.engine.Engine - INFO - [generated in 0.00108s] ()
2025-01-06 20:21:24,619 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-06 20:21:32,216 - aiogram.event - INFO - Update id=659309296 is handled. Duration 468 ms by bot id=7444575424
2025-01-06 20:21:40,696 - aiogram.event - INFO - Update id=659309297 is handled. Duration 484 ms by bot id=7444575424
2025-01-06 20:21:42,349 - aiogram.event - INFO - Update id=659309298 is handled. Duration 171 ms by bot id=7444575424
2025-01-06 20:21:44,552 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-06 20:21:44,558 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-06 20:21:44,559 - sqlalchemy.engine.Engine - INFO - [generated in 0.00106s] ('528155210', 1, 0)
2025-01-06 20:21:44,738 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-06 20:21:44,897 - aiogram.event - INFO - Update id=659309299 is handled. Duration 358 ms by bot id=7444575424
2025-01-06 20:22:21,672 - aiogram.dispatcher - INFO - Polling stopped
2025-01-17 13:20:21,414 - root - INFO - Инициализация бота...
2025-01-17 13:20:25,134 - root - INFO - Инициализация бота...
2025-01-17 13:20:25,548 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:20:25,548 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-17 13:20:25,549 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 13:20:25,554 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2025-01-17 13:20:25,554 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 13:20:25,555 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-17 13:20:25,555 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 13:20:25,556 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("keys")
2025-01-17 13:20:25,556 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 13:20:25,557 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	user_telegram_id VARCHAR NOT NULL, 
	subscription_status VARCHAR, 
	use_trial_period BOOLEAN, 
	PRIMARY KEY (user_telegram_id)
)


2025-01-17 13:20:25,558 - sqlalchemy.engine.Engine - INFO - [no key 0.00039s] ()
2025-01-17 13:20:25,572 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE keys (
	key_id VARCHAR NOT NULL, 
	user_telegram_id VARCHAR, 
	expiration_date DATETIME, 
	start_date DATETIME, 
	remembering_before_exp BOOLEAN, 
	PRIMARY KEY (key_id), 
	FOREIGN KEY(user_telegram_id) REFERENCES users (user_telegram_id)
)


2025-01-17 13:20:25,573 - sqlalchemy.engine.Engine - INFO - [no key 0.00048s] ()
2025-01-17 13:20:25,586 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 13:20:25,834 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-17 13:20:25,835 - root - INFO - Инициализация диспетчера...
2025-01-17 13:20:25,837 - root - INFO - Регистрация обработчиков...
2025-01-17 13:20:25,841 - root - INFO - Регистрация main menu команд...
2025-01-17 13:20:26,545 - root - INFO - Команды успешно установлены
2025-01-17 13:20:26,545 - root - INFO - Запуск polling...
2025-01-17 13:20:26,545 - aiogram.dispatcher - INFO - Start polling
2025-01-17 13:20:26,552 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:20:26,555 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-17 13:20:26,556 - sqlalchemy.engine.Engine - INFO - [generated in 0.00039s] ()
2025-01-17 13:20:26,621 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 13:20:29,524 - aiogram.event - INFO - Update id=659309300 is handled. Duration 405 ms by bot id=7444575424
2025-01-17 13:20:35,745 - aiogram.event - INFO - Update id=659309301 is handled. Duration 297 ms by bot id=7444575424
2025-01-17 13:20:36,587 - aiogram.event - INFO - Update id=659309302 is handled. Duration 172 ms by bot id=7444575424
2025-01-17 13:20:36,948 - aiogram.event - INFO - Update id=659309303 is handled. Duration 344 ms by bot id=7444575424
2025-01-17 13:20:37,686 - aiogram.event - INFO - Update id=659309304 is handled. Duration 265 ms by bot id=7444575424
2025-01-17 13:20:42,833 - aiogram.event - INFO - Update id=659309305 is handled. Duration 250 ms by bot id=7444575424
2025-01-17 13:20:45,324 - aiogram.event - INFO - Update id=659309306 is handled. Duration 202 ms by bot id=7444575424
2025-01-17 13:20:46,197 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:20:46,204 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-17 13:20:46,204 - sqlalchemy.engine.Engine - INFO - [generated in 0.00073s] ('181151262', 1, 0)
2025-01-17 13:20:46,366 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-17 13:20:46,443 - aiogram.event - INFO - Update id=659309307 is handled. Duration 250 ms by bot id=7444575424
2025-01-17 13:20:48,042 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:20:48,044 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-17 13:20:48,045 - sqlalchemy.engine.Engine - INFO - [cached since 1.841s ago] ('181151262', 1, 0)
2025-01-17 13:20:48,051 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (user_telegram_id, subscription_status, use_trial_period) VALUES (?, ?, ?)
2025-01-17 13:20:48,053 - sqlalchemy.engine.Engine - INFO - [generated in 0.00098s] ('181151262', 'active', 0)
2025-01-17 13:20:48,057 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 13:20:48,074 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:20:48,078 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 13:20:48,079 - sqlalchemy.engine.Engine - INFO - [generated in 0.00123s] ('181151262',)
2025-01-17 13:20:48,087 - sqlalchemy.engine.Engine - INFO - UPDATE users SET use_trial_period=? WHERE users.user_telegram_id = ?
2025-01-17 13:20:48,087 - sqlalchemy.engine.Engine - INFO - [generated in 0.00104s] (1, '181151262')
2025-01-17 13:20:48,092 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 13:20:50,725 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:20:50,731 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2025-01-17 13:20:50,731 - sqlalchemy.engine.Engine - INFO - [generated in 0.00130s] ('113', '181151262', '2025-01-19 13:20:50.724862', '2025-01-17 13:20:50.724862', 0)
2025-01-17 13:20:50,738 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 13:20:50,758 - root - INFO - Key created: OutlineKey(key_id='113', name='VPN Key61', password='OqjfTx2MFJd3IB8xGW0SDA', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpPcWpmVHgyTUZKZDNJQjh4R1cwU0RB@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2025-01-17 13:20:50,900 - aiogram.event - INFO - Update id=659309308 is handled. Duration 2859 ms by bot id=7444575424
2025-01-17 13:20:53,663 - aiogram.event - INFO - Update id=659309309 is handled. Duration 219 ms by bot id=7444575424
2025-01-17 13:21:05,933 - aiogram.event - INFO - Update id=659309310 is handled. Duration 171 ms by bot id=7444575424
2025-01-17 13:21:07,928 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:21:07,929 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-17 13:21:07,930 - sqlalchemy.engine.Engine - INFO - [cached since 21.73s ago] ('181151262', 1, 0)
2025-01-17 13:21:07,935 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 13:21:07,935 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] ('181151262',)
2025-01-17 13:21:09,893 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-17 13:21:09,965 - aiogram.event - INFO - Update id=659309311 is handled. Duration 2032 ms by bot id=7444575424
2025-01-17 13:21:14,184 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:21:14,188 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-17 13:21:14,189 - sqlalchemy.engine.Engine - INFO - [generated in 0.00140s] ('113', 1, 0)
2025-01-17 13:21:14,408 - aiogram.event - INFO - Update id=659309312 is handled. Duration 2875 ms by bot id=7444575424
2025-01-17 13:21:16,591 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:21:16,592 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-17 13:21:16,592 - sqlalchemy.engine.Engine - INFO - [cached since 2.404s ago] ('113', 1, 0)
2025-01-17 13:21:16,718 - aiogram.event - INFO - Update id=659309313 is handled. Duration 139 ms by bot id=7444575424
2025-01-17 13:21:22,495 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:21:22,496 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-17 13:21:22,497 - sqlalchemy.engine.Engine - INFO - [cached since 8.309s ago] ('113', 1, 0)
2025-01-17 13:21:22,655 - aiogram.event - INFO - Update id=659309314 is handled. Duration 2077 ms by bot id=7444575424
2025-01-17 13:21:32,182 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:21:32,184 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-17 13:21:32,185 - sqlalchemy.engine.Engine - INFO - [cached since 45.98s ago] ('181151262', 1, 0)
2025-01-17 13:21:32,191 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 13:21:32,191 - sqlalchemy.engine.Engine - INFO - [cached since 24.26s ago] ('181151262',)
2025-01-17 13:21:34,225 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-17 13:21:34,226 - aiogram.event - INFO - Update id=659309315 is handled. Duration 2046 ms by bot id=7444575424
2025-01-17 13:21:34,478 - aiogram.event - INFO - Update id=659309316 is handled. Duration 467 ms by bot id=7444575424
2025-01-17 13:21:35,901 - aiogram.event - INFO - Update id=659309317 is handled. Duration 250 ms by bot id=7444575424
2025-01-17 13:21:38,068 - aiogram.event - INFO - Update id=659309318 is handled. Duration 202 ms by bot id=7444575424
2025-01-17 13:21:39,923 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:21:39,924 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-17 13:21:39,924 - sqlalchemy.engine.Engine - INFO - [cached since 53.72s ago] ('181151262', 1, 0)
2025-01-17 13:21:40,014 - aiogram.event - INFO - Update id=659309319 is handled. Duration 109 ms by bot id=7444575424
2025-01-17 13:21:42,084 - aiogram.event - INFO - Update id=659309320 is handled. Duration 110 ms by bot id=7444575424
2025-01-17 13:21:43,133 - aiogram.event - INFO - Update id=659309321 is handled. Duration 188 ms by bot id=7444575424
2025-01-17 13:21:46,272 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:21:46,273 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-17 13:21:46,274 - sqlalchemy.engine.Engine - INFO - [cached since 60.07s ago] ('528155210', 1, 0)
2025-01-17 13:21:46,535 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-17 13:21:46,719 - aiogram.event - INFO - Update id=659309322 is handled. Duration 452 ms by bot id=7444575424
2025-01-17 13:21:48,032 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:21:48,033 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-17 13:21:48,033 - sqlalchemy.engine.Engine - INFO - [cached since 61.83s ago] ('528155210', 1, 0)
2025-01-17 13:21:48,035 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (user_telegram_id, subscription_status, use_trial_period) VALUES (?, ?, ?)
2025-01-17 13:21:48,036 - sqlalchemy.engine.Engine - INFO - [cached since 59.99s ago] ('528155210', 'active', 0)
2025-01-17 13:21:48,041 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 13:21:48,054 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:21:48,055 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 13:21:48,055 - sqlalchemy.engine.Engine - INFO - [cached since 59.98s ago] ('528155210',)
2025-01-17 13:21:48,057 - sqlalchemy.engine.Engine - INFO - UPDATE users SET use_trial_period=? WHERE users.user_telegram_id = ?
2025-01-17 13:21:48,057 - sqlalchemy.engine.Engine - INFO - [cached since 59.97s ago] (1, '528155210')
2025-01-17 13:21:48,059 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 13:21:49,627 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:21:49,629 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2025-01-17 13:21:49,629 - sqlalchemy.engine.Engine - INFO - [cached since 58.9s ago] ('114', '528155210', '2025-01-19 13:21:49.626829', '2025-01-17 13:21:49.626829', 0)
2025-01-17 13:21:49,636 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 13:21:49,651 - root - INFO - Key created: OutlineKey(key_id='114', name='VPN Key62', password='08wdI3Cia4eJ7GchURzPO8', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTowOHdkSTNDaWE0ZUo3R2NoVVJ6UE84@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2025-01-17 13:21:49,802 - aiogram.event - INFO - Update id=659309323 is handled. Duration 1780 ms by bot id=7444575424
2025-01-17 13:21:51,851 - aiogram.event - INFO - Update id=659309324 is handled. Duration 342 ms by bot id=7444575424
2025-01-17 13:22:30,075 - aiogram.event - INFO - Update id=659309325 is handled. Duration 327 ms by bot id=7444575424
2025-01-17 13:23:10,816 - aiogram.dispatcher - INFO - Polling stopped
2025-01-17 13:23:11,081 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 13:23:11,091 - root - INFO - Бот остановлен вручную.
2025-01-17 13:23:17,513 - root - INFO - Инициализация бота...
2025-01-17 13:23:18,242 - root - INFO - Инициализация бота...
2025-01-17 13:23:18,319 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:23:18,319 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-17 13:23:18,320 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 13:23:18,321 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-17 13:23:18,321 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 13:23:18,321 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 13:23:18,357 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-17 13:23:18,357 - root - INFO - Инициализация диспетчера...
2025-01-17 13:23:18,358 - root - INFO - Регистрация обработчиков...
2025-01-17 13:23:18,360 - root - INFO - Регистрация main menu команд...
2025-01-17 13:23:19,912 - root - INFO - Команды успешно установлены
2025-01-17 13:23:19,914 - root - INFO - Запуск polling...
2025-01-17 13:23:19,914 - aiogram.dispatcher - INFO - Start polling
2025-01-17 13:23:19,933 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:23:19,940 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-17 13:23:19,941 - sqlalchemy.engine.Engine - INFO - [generated in 0.00097s] ()
2025-01-17 13:23:19,952 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 13:23:19,952 - sqlalchemy.engine.Engine - INFO - [generated in 0.00098s] ('181151262',)
2025-01-17 13:23:21,674 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 13:23:21,676 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:23:21,680 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 13:23:21,680 - sqlalchemy.engine.Engine - INFO - [generated in 0.00112s] ('181151262',)
2025-01-17 13:23:21,759 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 13:23:22,094 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 13:23:22,095 - sqlalchemy.engine.Engine - INFO - [cached since 0.4156s ago] ('528155210',)
2025-01-17 13:23:22,098 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 13:23:22,099 - sqlalchemy.engine.Engine - INFO - [cached since 2.147s ago] ('528155210',)
2025-01-17 13:23:24,084 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 13:23:24,087 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:23:24,088 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 13:23:24,089 - sqlalchemy.engine.Engine - INFO - [cached since 2.409s ago] ('528155210',)
2025-01-17 13:23:24,548 - aiogram.event - INFO - Update id=659309326 is handled. Duration 2546 ms by bot id=7444575424
2025-01-17 13:23:37,805 - aiogram.event - INFO - Update id=659309327 is handled. Duration 375 ms by bot id=7444575424
2025-01-17 13:23:40,231 - aiogram.event - INFO - Update id=659309328 is handled. Duration 186 ms by bot id=7444575424
2025-01-17 13:23:40,857 - aiogram.event - INFO - Update id=659309329 is handled. Duration 94 ms by bot id=7444575424
2025-01-17 13:23:44,195 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:23:44,199 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-17 13:23:44,200 - sqlalchemy.engine.Engine - INFO - [generated in 0.00103s] ('113', 1, 0)
2025-01-17 13:23:44,473 - aiogram.event - INFO - Update id=659309330 is handled. Duration 2186 ms by bot id=7444575424
2025-01-17 13:24:14,784 - aiogram.event - INFO - Update id=659309331 is handled. Duration 515 ms by bot id=7444575424
2025-01-17 13:24:16,149 - aiogram.event - INFO - Update id=659309332 is handled. Duration 265 ms by bot id=7444575424
2025-01-17 13:24:16,454 - aiogram.event - INFO - Update id=659309333 is handled. Duration 422 ms by bot id=7444575424
2025-01-17 13:24:16,691 - aiogram.event - INFO - Update id=659309334 is handled. Duration 344 ms by bot id=7444575424
2025-01-17 13:24:19,396 - aiogram.event - INFO - Update id=659309335 is handled. Duration 203 ms by bot id=7444575424
2025-01-17 13:24:19,557 - aiogram.event - INFO - Update id=659309336 is handled. Duration 203 ms by bot id=7444575424
2025-01-17 13:24:21,168 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:24:21,170 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-17 13:24:21,170 - sqlalchemy.engine.Engine - INFO - [cached since 36.97s ago] ('113', 1, 0)
2025-01-17 13:24:23,373 - aiogram.event - INFO - Update id=659309337 is handled. Duration 2219 ms by bot id=7444575424
2025-01-17 13:24:33,626 - aiogram.event - INFO - Update id=659309338 is handled. Duration 282 ms by bot id=7444575424
2025-01-17 13:24:46,088 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 13:24:46,091 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-17 13:24:46,092 - sqlalchemy.engine.Engine - INFO - [generated in 0.00104s] ('528155210', 1, 0)
2025-01-17 13:24:46,096 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 13:24:46,096 - sqlalchemy.engine.Engine - INFO - [cached since 86.15s ago] ('528155210',)
2025-01-17 13:24:47,791 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-17 13:24:47,855 - aiogram.event - INFO - Update id=659309339 is handled. Duration 1764 ms by bot id=7444575424
2025-01-17 13:24:49,429 - aiogram.event - INFO - Update id=659309340 is handled. Duration 186 ms by bot id=7444575424
2025-01-17 13:24:52,654 - aiogram.event - INFO - Update id=659309341 is handled. Duration 219 ms by bot id=7444575424
2025-01-17 13:26:14,609 - aiogram.event - INFO - Update id=659309342 is handled. Duration 469 ms by bot id=7444575424
2025-01-17 13:41:51,136 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - Request timeout error
2025-01-17 13:41:51,138 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-17 13:42:02,338 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7444575424)
2025-01-17 13:45:10,196 - aiogram.dispatcher - INFO - Polling stopped
2025-01-17 13:45:10,462 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 13:45:10,469 - root - INFO - Бот остановлен вручную.
2025-01-17 13:45:11,013 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000019CB0E42790>
2025-01-17 14:43:10,668 - root - INFO - Инициализация бота...
2025-01-17 14:43:11,099 - root - INFO - Инициализация бота...
2025-01-17 14:43:11,146 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 14:43:11,147 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-17 14:43:11,147 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 14:43:11,149 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-17 14:43:11,149 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 14:43:11,150 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 14:43:11,174 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-17 14:43:11,174 - root - INFO - Инициализация диспетчера...
2025-01-17 14:43:11,175 - root - INFO - Регистрация обработчиков...
2025-01-17 14:43:11,176 - root - INFO - Регистрация main menu команд...
2025-01-17 14:43:11,757 - root - INFO - Команды успешно установлены
2025-01-17 14:43:11,757 - root - INFO - Запуск polling...
2025-01-17 14:43:11,758 - aiogram.dispatcher - INFO - Start polling
2025-01-17 14:43:11,771 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 14:43:11,775 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-17 14:43:11,775 - sqlalchemy.engine.Engine - INFO - [generated in 0.00039s] ()
2025-01-17 14:43:11,779 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 14:43:11,780 - sqlalchemy.engine.Engine - INFO - [generated in 0.00039s] ('181151262',)
2025-01-17 14:43:13,411 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 14:43:13,413 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 14:43:13,415 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 14:43:13,415 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] ('181151262',)
2025-01-17 14:43:13,482 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 14:43:13,731 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 14:43:13,731 - sqlalchemy.engine.Engine - INFO - [cached since 0.3168s ago] ('528155210',)
2025-01-17 14:43:13,731 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 14:43:13,732 - sqlalchemy.engine.Engine - INFO - [cached since 1.953s ago] ('528155210',)
2025-01-17 14:43:15,165 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 14:43:15,166 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 14:43:15,166 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 14:43:15,166 - sqlalchemy.engine.Engine - INFO - [cached since 1.752s ago] ('528155210',)
2025-01-17 14:43:17,656 - aiogram.event - INFO - Update id=659309343 is handled. Duration 436 ms by bot id=7444575424
2025-01-17 14:43:19,041 - aiogram.event - INFO - Update id=659309344 is handled. Duration 546 ms by bot id=7444575424
2025-01-17 14:43:20,170 - aiogram.event - INFO - Update id=659309345 is handled. Duration 484 ms by bot id=7444575424
2025-01-17 14:45:19,645 - aiogram.event - INFO - Update id=659309346 is handled. Duration 188 ms by bot id=7444575424
2025-01-17 14:45:20,005 - root - INFO - {
    "message_id": 4488,
    "date": 1737114319,
    "chat": {
        "id": 528155210,
        "type": "private",
        "title": null,
        "username": "dastroo",
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "is_forum": null,
        "accent_color_id": null,
        "active_usernames": null,
        "available_reactions": null,
        "background_custom_emoji_id": null,
        "bio": null,
        "birthdate": null,
        "business_intro": null,
        "business_location": null,
        "business_opening_hours": null,
        "can_set_sticker_set": null,
        "custom_emoji_sticker_set_name": null,
        "description": null,
        "emoji_status_custom_emoji_id": null,
        "emoji_status_expiration_date": null,
        "has_aggressive_anti_spam_enabled": null,
        "has_hidden_members": null,
        "has_private_forwards": null,
        "has_protected_content": null,
        "has_restricted_voice_and_video_messages": null,
        "has_visible_history": null,
        "invite_link": null,
        "join_by_request": null,
        "join_to_send_messages": null,
        "linked_chat_id": null,
        "location": null,
        "message_auto_delete_time": null,
        "permissions": null,
        "personal_chat": null,
        "photo": null,
        "pinned_message": null,
        "profile_accent_color_id": null,
        "profile_background_custom_emoji_id": null,
        "slow_mode_delay": null,
        "sticker_set_name": null,
        "unrestrict_boost_count": null
    },
    "message_thread_id": null,
    "from_user": {
        "id": 528155210,
        "is_bot": false,
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "username": "dastroo",
        "language_code": "ru",
        "is_premium": null,
        "added_to_attachment_menu": null,
        "can_join_groups": null,
        "can_read_all_group_messages": null,
        "supports_inline_queries": null,
        "can_connect_to_business": null,
        "has_main_web_app": null
    },
    "sender_chat": null,
    "sender_boost_count": null,
    "sender_business_bot": null,
    "business_connection_id": null,
    "forward_origin": null,
    "is_topic_message": null,
    "is_automatic_forward": null,
    "reply_to_message": null,
    "external_reply": null,
    "quote": null,
    "reply_to_story": null,
    "via_bot": null,
    "edit_date": null,
    "has_protected_content": null,
    "is_from_offline": null,
    "media_group_id": null,
    "author_signature": null,
    "text": null,
    "entities": null,
    "link_preview_options": null,
    "effect_id": null,
    "animation": null,
    "audio": null,
    "document": null,
    "paid_media": null,
    "photo": null,
    "sticker": null,
    "story": null,
    "video": null,
    "video_note": null,
    "voice": null,
    "caption": null,
    "caption_entities": null,
    "show_caption_above_media": null,
    "has_media_spoiler": null,
    "contact": null,
    "dice": null,
    "game": null,
    "poll": null,
    "venue": null,
    "location": null,
    "new_chat_members": null,
    "left_chat_member": null,
    "new_chat_title": null,
    "new_chat_photo": null,
    "delete_chat_photo": null,
    "group_chat_created": null,
    "supergroup_chat_created": null,
    "channel_chat_created": null,
    "message_auto_delete_timer_changed": null,
    "migrate_to_chat_id": null,
    "migrate_from_chat_id": null,
    "pinned_message": null,
    "invoice": null,
    "successful_payment": {
        "currency": "RUB",
        "total_amount": 49000,
        "invoice_payload": "9d84dfa1-a2a9-4118-ba95-bc5bf9b0a3d1",
        "telegram_payment_charge_id": "7444575424_528155210_345269",
        "provider_payment_charge_id": "7444575424_528155210_345269",
        "subscription_expiration_date": null,
        "is_recurring": null,
        "is_first_recurring": null,
        "shipping_option_id": null,
        "order_info": null
    },
    "refunded_payment": null,
    "users_shared": null,
    "chat_shared": null,
    "connected_website": null,
    "write_access_allowed": null,
    "passport_data": null,
    "proximity_alert_triggered": null,
    "boost_added": null,
    "chat_background_set": null,
    "forum_topic_created": null,
    "forum_topic_edited": null,
    "forum_topic_closed": null,
    "forum_topic_reopened": null,
    "general_forum_topic_hidden": null,
    "general_forum_topic_unhidden": null,
    "giveaway_created": null,
    "giveaway": null,
    "giveaway_winners": null,
    "giveaway_completed": null,
    "video_chat_scheduled": null,
    "video_chat_started": null,
    "video_chat_ended": null,
    "video_chat_participants_invited": null,
    "web_app_data": null,
    "reply_markup": null,
    "forward_date": null,
    "forward_from": null,
    "forward_from_chat": null,
    "forward_from_message_id": null,
    "forward_sender_name": null,
    "forward_signature": null,
    "user_shared": null
}
2025-01-17 14:45:22,580 - root - INFO - Key created: OutlineKey(key_id='115', name='VPN Key63', password='ftYuA8ybDkgcXFg8LBSxBu', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpmdFl1QTh5YkRrZ2NYRmc4TEJTeEJ1@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 528155210
2025-01-17 14:45:22,769 - root - INFO - Key created: OutlineKey(key_id='115', name='VPN Key63', password='ftYuA8ybDkgcXFg8LBSxBu', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpmdFl1QTh5YkRrZ2NYRmc4TEJTeEJ1@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2025-01-17 14:45:22,986 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 14:45:22,989 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-17 14:45:22,989 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ('528155210', 1, 0)
2025-01-17 14:45:22,991 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2025-01-17 14:45:22,992 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ('115', '528155210', '2026-01-12 14:45:22.990115', '2025-01-17 14:45:22.990115', 0)
2025-01-17 14:45:22,993 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 14:45:23,002 - aiogram.event - INFO - Update id=659309347 is handled. Duration 3000 ms by bot id=7444575424
2025-01-17 15:00:04,542 - aiogram.dispatcher - INFO - Polling stopped
2025-01-17 15:00:04,800 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 15:00:04,801 - root - INFO - Бот остановлен вручную.
2025-01-17 15:39:03,179 - root - INFO - Инициализация бота...
2025-01-17 15:39:03,746 - root - INFO - Инициализация бота...
2025-01-17 15:39:03,810 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:39:03,810 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-17 15:39:03,810 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 15:39:03,813 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-17 15:39:03,813 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 15:39:03,814 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 15:39:03,851 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-17 15:39:03,851 - root - INFO - Инициализация диспетчера...
2025-01-17 15:39:03,852 - root - INFO - Регистрация обработчиков...
2025-01-17 15:39:03,853 - root - INFO - Регистрация main menu команд...
2025-01-17 15:39:04,160 - root - INFO - Команды успешно установлены
2025-01-17 15:39:04,160 - root - INFO - Запуск polling...
2025-01-17 15:39:04,160 - aiogram.dispatcher - INFO - Start polling
2025-01-17 15:39:04,163 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:39:04,165 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-17 15:39:04,165 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ()
2025-01-17 15:39:04,167 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 15:39:04,167 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ('181151262',)
2025-01-17 15:39:06,043 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 15:39:06,045 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:39:06,047 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 15:39:06,047 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ('181151262',)
2025-01-17 15:39:06,111 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 15:39:06,398 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 15:39:06,398 - sqlalchemy.engine.Engine - INFO - [cached since 0.3515s ago] ('528155210',)
2025-01-17 15:39:06,399 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 15:39:06,399 - sqlalchemy.engine.Engine - INFO - [cached since 2.232s ago] ('528155210',)
2025-01-17 15:39:08,774 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 15:39:08,776 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:39:08,778 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-17 15:39:08,778 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] ('115',)
2025-01-17 15:39:10,563 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 15:39:10,564 - sqlalchemy.engine.Engine - INFO - [cached since 4.517s ago] ('528155210',)
2025-01-17 15:39:10,823 - aiogram.event - INFO - Update id=659309348 is handled. Duration 219 ms by bot id=7444575424
2025-01-17 15:39:12,448 - aiogram.event - INFO - Update id=659309349 is not handled. Duration 155 ms by bot id=7444575424
2025-01-17 15:39:12,449 - aiogram.event - ERROR - Cause exception while process update id=659309349 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 76, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-17 15:40:27,461 - aiogram.dispatcher - INFO - Polling stopped
2025-01-17 15:40:27,714 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 15:40:27,716 - root - INFO - Бот остановлен вручную.
2025-01-17 15:40:27,897 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000023999029B90>
2025-01-17 15:40:31,235 - root - INFO - Инициализация бота...
2025-01-17 15:40:31,621 - root - INFO - Инициализация бота...
2025-01-17 15:40:31,659 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:40:31,659 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-17 15:40:31,660 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 15:40:31,660 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-17 15:40:31,661 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 15:40:31,661 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 15:40:31,691 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-17 15:40:31,691 - root - INFO - Инициализация диспетчера...
2025-01-17 15:40:31,692 - root - INFO - Регистрация обработчиков...
2025-01-17 15:40:31,693 - root - INFO - Регистрация main menu команд...
2025-01-17 15:40:32,190 - root - INFO - Команды успешно установлены
2025-01-17 15:40:32,191 - root - INFO - Запуск polling...
2025-01-17 15:40:32,191 - aiogram.dispatcher - INFO - Start polling
2025-01-17 15:40:32,195 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:40:32,197 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-17 15:40:32,197 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ()
2025-01-17 15:40:32,199 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 15:40:32,199 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] ('181151262',)
2025-01-17 15:40:34,509 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 15:40:34,511 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:40:34,512 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 15:40:34,513 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ('181151262',)
2025-01-17 15:40:34,580 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 15:40:34,804 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 15:40:34,804 - sqlalchemy.engine.Engine - INFO - [cached since 0.2922s ago] ('528155210',)
2025-01-17 15:40:34,805 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 15:40:34,805 - sqlalchemy.engine.Engine - INFO - [cached since 2.605s ago] ('528155210',)
2025-01-17 15:40:36,293 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 15:40:36,295 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:40:36,296 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-17 15:40:36,296 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] ('115',)
2025-01-17 15:40:38,920 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 15:40:38,920 - sqlalchemy.engine.Engine - INFO - [cached since 4.408s ago] ('528155210',)
2025-01-17 15:40:39,249 - aiogram.event - INFO - Update id=659309350 is handled. Duration 280 ms by bot id=7444575424
2025-01-17 15:40:40,442 - aiogram.event - INFO - Update id=659309351 is handled. Duration 155 ms by bot id=7444575424
2025-01-17 15:40:42,679 - aiogram.event - INFO - Update id=659309352 is handled. Duration 155 ms by bot id=7444575424
2025-01-17 15:40:44,561 - aiogram.event - INFO - Update id=659309353 is not handled. Duration 109 ms by bot id=7444575424
2025-01-17 15:40:44,562 - aiogram.event - ERROR - Cause exception while process update id=659309353 by bot id=7444575424
TypeError: Bot.send_invoice() got an unexpected keyword argument 'currently_total_amount'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 76, in handle_period_selection
    await bot.send_invoice(
          ^^^^^^^^^^^^^^^^^
TypeError: Bot.send_invoice() got an unexpected keyword argument 'currently_total_amount'
2025-01-17 15:40:58,999 - aiogram.dispatcher - INFO - Polling stopped
2025-01-17 15:40:59,255 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 15:40:59,256 - root - INFO - Бот остановлен вручную.
2025-01-17 15:40:59,431 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000149D5868890>
2025-01-17 15:40:59,431 - asyncio - ERROR - Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x00000149D93597F0>, 2329141.125)]']
connector: <aiohttp.connector.TCPConnector object at 0x00000149D20D59D0>
2025-01-17 15:41:02,664 - root - INFO - Инициализация бота...
2025-01-17 15:41:02,998 - root - INFO - Инициализация бота...
2025-01-17 15:41:03,031 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:41:03,031 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-17 15:41:03,031 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 15:41:03,032 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-17 15:41:03,032 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 15:41:03,032 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 15:41:03,056 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-17 15:41:03,056 - root - INFO - Инициализация диспетчера...
2025-01-17 15:41:03,057 - root - INFO - Регистрация обработчиков...
2025-01-17 15:41:03,058 - root - INFO - Регистрация main menu команд...
2025-01-17 15:41:03,602 - root - INFO - Команды успешно установлены
2025-01-17 15:41:03,602 - root - INFO - Запуск polling...
2025-01-17 15:41:03,603 - aiogram.dispatcher - INFO - Start polling
2025-01-17 15:41:03,609 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:41:03,611 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-17 15:41:03,611 - sqlalchemy.engine.Engine - INFO - [generated in 0.00021s] ()
2025-01-17 15:41:03,613 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 15:41:03,614 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] ('181151262',)
2025-01-17 15:41:05,447 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 15:41:05,448 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:41:05,450 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 15:41:05,451 - sqlalchemy.engine.Engine - INFO - [generated in 0.00063s] ('181151262',)
2025-01-17 15:41:05,517 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 15:41:05,950 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 15:41:05,950 - sqlalchemy.engine.Engine - INFO - [cached since 0.5005s ago] ('528155210',)
2025-01-17 15:41:05,951 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 15:41:05,951 - sqlalchemy.engine.Engine - INFO - [cached since 2.338s ago] ('528155210',)
2025-01-17 15:41:08,014 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 15:41:08,015 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:41:08,016 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-17 15:41:08,017 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] ('115',)
2025-01-17 15:41:10,062 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 15:41:10,063 - sqlalchemy.engine.Engine - INFO - [cached since 4.613s ago] ('528155210',)
2025-01-17 15:41:12,752 - aiogram.event - INFO - Update id=659309354 is handled. Duration 313 ms by bot id=7444575424
2025-01-17 15:41:14,054 - aiogram.event - INFO - Update id=659309355 is handled. Duration 296 ms by bot id=7444575424
2025-01-17 15:41:15,755 - aiogram.event - INFO - Update id=659309356 is not handled. Duration 1063 ms by bot id=7444575424
2025-01-17 15:41:15,756 - aiogram.event - ERROR - Cause exception while process update id=659309356 by bot id=7444575424
TypeError: Bot.send_invoice() got an unexpected keyword argument 'total_amount'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 76, in handle_period_selection
    await bot.send_invoice(
          ^^^^^^^^^^^^^^^^^
TypeError: Bot.send_invoice() got an unexpected keyword argument 'total_amount'
2025-01-17 15:41:51,579 - aiogram.dispatcher - INFO - Polling stopped
2025-01-17 15:41:51,842 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 15:41:51,846 - root - INFO - Бот остановлен вручную.
2025-01-17 15:41:52,049 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000027DD8988CD0>
2025-01-17 15:41:55,382 - root - INFO - Инициализация бота...
2025-01-17 15:41:55,719 - root - INFO - Инициализация бота...
2025-01-17 15:41:55,751 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:41:55,751 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-17 15:41:55,751 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 15:41:55,752 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-17 15:41:55,752 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 15:41:55,752 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 15:41:55,778 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-17 15:41:55,778 - root - INFO - Инициализация диспетчера...
2025-01-17 15:41:55,778 - root - INFO - Регистрация обработчиков...
2025-01-17 15:41:55,779 - root - INFO - Регистрация main menu команд...
2025-01-17 15:41:56,257 - root - INFO - Команды успешно установлены
2025-01-17 15:41:56,258 - root - INFO - Запуск polling...
2025-01-17 15:41:56,258 - aiogram.dispatcher - INFO - Start polling
2025-01-17 15:41:56,270 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:41:56,274 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-17 15:41:56,274 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ()
2025-01-17 15:41:56,279 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 15:41:56,279 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ('181151262',)
2025-01-17 15:41:58,013 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 15:41:58,014 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:41:58,015 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 15:41:58,015 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] ('181151262',)
2025-01-17 15:41:58,076 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 15:41:58,312 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 15:41:58,313 - sqlalchemy.engine.Engine - INFO - [cached since 0.2982s ago] ('528155210',)
2025-01-17 15:41:58,314 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 15:41:58,314 - sqlalchemy.engine.Engine - INFO - [cached since 2.036s ago] ('528155210',)
2025-01-17 15:42:00,095 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 15:42:00,096 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:42:00,096 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-17 15:42:00,097 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] ('115',)
2025-01-17 15:42:02,064 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 15:42:02,064 - sqlalchemy.engine.Engine - INFO - [cached since 4.049s ago] ('528155210',)
2025-01-17 15:42:02,494 - aiogram.event - INFO - Update id=659309357 is handled. Duration 391 ms by bot id=7444575424
2025-01-17 15:42:02,531 - aiogram.event - INFO - Update id=659309358 is handled. Duration 375 ms by bot id=7444575424
2025-01-17 15:42:03,739 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:42:03,742 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-17 15:42:03,743 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] ('528155210', 1, 0)
2025-01-17 15:42:03,744 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 15:42:03,744 - sqlalchemy.engine.Engine - INFO - [cached since 7.465s ago] ('528155210',)
2025-01-17 15:42:08,179 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-17 15:42:08,252 - aiogram.event - INFO - Update id=659309359 is handled. Duration 4516 ms by bot id=7444575424
2025-01-17 15:42:08,274 - aiogram.event - INFO - Update id=659309360 is handled. Duration 125 ms by bot id=7444575424
2025-01-17 15:42:09,470 - aiogram.event - INFO - Update id=659309361 is handled. Duration 125 ms by bot id=7444575424
2025-01-17 15:42:09,668 - aiogram.event - INFO - Update id=659309362 is handled. Duration 250 ms by bot id=7444575424
2025-01-17 15:42:10,993 - aiogram.event - INFO - Update id=659309363 is handled. Duration 578 ms by bot id=7444575424
2025-01-17 15:42:12,505 - aiogram.event - INFO - Update id=659309364 is handled. Duration 625 ms by bot id=7444575424
2025-01-17 15:43:00,905 - aiogram.event - INFO - Update id=659309365 is handled. Duration 186 ms by bot id=7444575424
2025-01-17 15:43:02,144 - aiogram.event - INFO - Update id=659309366 is handled. Duration 63 ms by bot id=7444575424
2025-01-17 15:43:02,791 - root - INFO - {
    "message_id": 4505,
    "date": 1737117782,
    "chat": {
        "id": 528155210,
        "type": "private",
        "title": null,
        "username": "dastroo",
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "is_forum": null,
        "accent_color_id": null,
        "active_usernames": null,
        "available_reactions": null,
        "background_custom_emoji_id": null,
        "bio": null,
        "birthdate": null,
        "business_intro": null,
        "business_location": null,
        "business_opening_hours": null,
        "can_set_sticker_set": null,
        "custom_emoji_sticker_set_name": null,
        "description": null,
        "emoji_status_custom_emoji_id": null,
        "emoji_status_expiration_date": null,
        "has_aggressive_anti_spam_enabled": null,
        "has_hidden_members": null,
        "has_private_forwards": null,
        "has_protected_content": null,
        "has_restricted_voice_and_video_messages": null,
        "has_visible_history": null,
        "invite_link": null,
        "join_by_request": null,
        "join_to_send_messages": null,
        "linked_chat_id": null,
        "location": null,
        "message_auto_delete_time": null,
        "permissions": null,
        "personal_chat": null,
        "photo": null,
        "pinned_message": null,
        "profile_accent_color_id": null,
        "profile_background_custom_emoji_id": null,
        "slow_mode_delay": null,
        "sticker_set_name": null,
        "unrestrict_boost_count": null
    },
    "message_thread_id": null,
    "from_user": {
        "id": 528155210,
        "is_bot": false,
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "username": "dastroo",
        "language_code": "ru",
        "is_premium": null,
        "added_to_attachment_menu": null,
        "can_join_groups": null,
        "can_read_all_group_messages": null,
        "supports_inline_queries": null,
        "can_connect_to_business": null,
        "has_main_web_app": null
    },
    "sender_chat": null,
    "sender_boost_count": null,
    "sender_business_bot": null,
    "business_connection_id": null,
    "forward_origin": null,
    "is_topic_message": null,
    "is_automatic_forward": null,
    "reply_to_message": null,
    "external_reply": null,
    "quote": null,
    "reply_to_story": null,
    "via_bot": null,
    "edit_date": null,
    "has_protected_content": null,
    "is_from_offline": null,
    "media_group_id": null,
    "author_signature": null,
    "text": null,
    "entities": null,
    "link_preview_options": null,
    "effect_id": null,
    "animation": null,
    "audio": null,
    "document": null,
    "paid_media": null,
    "photo": null,
    "sticker": null,
    "story": null,
    "video": null,
    "video_note": null,
    "voice": null,
    "caption": null,
    "caption_entities": null,
    "show_caption_above_media": null,
    "has_media_spoiler": null,
    "contact": null,
    "dice": null,
    "game": null,
    "poll": null,
    "venue": null,
    "location": null,
    "new_chat_members": null,
    "left_chat_member": null,
    "new_chat_title": null,
    "new_chat_photo": null,
    "delete_chat_photo": null,
    "group_chat_created": null,
    "supergroup_chat_created": null,
    "channel_chat_created": null,
    "message_auto_delete_timer_changed": null,
    "migrate_to_chat_id": null,
    "migrate_from_chat_id": null,
    "pinned_message": null,
    "invoice": null,
    "successful_payment": {
        "currency": "RUB",
        "total_amount": 27000,
        "invoice_payload": "918eb8a7-58a9-4501-aa71-021c95b87203",
        "telegram_payment_charge_id": "7444575424_528155210_345282",
        "provider_payment_charge_id": "2f1c6415-000f-5000-8000-1f917c8e9870",
        "subscription_expiration_date": null,
        "is_recurring": null,
        "is_first_recurring": null,
        "shipping_option_id": null,
        "order_info": null
    },
    "refunded_payment": null,
    "users_shared": null,
    "chat_shared": null,
    "connected_website": null,
    "write_access_allowed": null,
    "passport_data": null,
    "proximity_alert_triggered": null,
    "boost_added": null,
    "chat_background_set": null,
    "forum_topic_created": null,
    "forum_topic_edited": null,
    "forum_topic_closed": null,
    "forum_topic_reopened": null,
    "general_forum_topic_hidden": null,
    "general_forum_topic_unhidden": null,
    "giveaway_created": null,
    "giveaway": null,
    "giveaway_winners": null,
    "giveaway_completed": null,
    "video_chat_scheduled": null,
    "video_chat_started": null,
    "video_chat_ended": null,
    "video_chat_participants_invited": null,
    "web_app_data": null,
    "reply_markup": null,
    "forward_date": null,
    "forward_from": null,
    "forward_from_chat": null,
    "forward_from_message_id": null,
    "forward_sender_name": null,
    "forward_signature": null,
    "user_shared": null
}
2025-01-17 15:43:04,816 - root - INFO - Key created: OutlineKey(key_id='116', name='VPN Key64', password='DDQMtRjDJA7Ipkb1Qbms5E', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpERFFNdFJqREpBN0lwa2IxUWJtczVF@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 528155210
2025-01-17 15:43:04,821 - root - INFO - {
    "message_id": 4506,
    "date": 1737117783,
    "chat": {
        "id": 432629636,
        "type": "private",
        "title": null,
        "username": "asaidar",
        "first_name": "Aydar",
        "last_name": null,
        "is_forum": null,
        "accent_color_id": null,
        "active_usernames": null,
        "available_reactions": null,
        "background_custom_emoji_id": null,
        "bio": null,
        "birthdate": null,
        "business_intro": null,
        "business_location": null,
        "business_opening_hours": null,
        "can_set_sticker_set": null,
        "custom_emoji_sticker_set_name": null,
        "description": null,
        "emoji_status_custom_emoji_id": null,
        "emoji_status_expiration_date": null,
        "has_aggressive_anti_spam_enabled": null,
        "has_hidden_members": null,
        "has_private_forwards": null,
        "has_protected_content": null,
        "has_restricted_voice_and_video_messages": null,
        "has_visible_history": null,
        "invite_link": null,
        "join_by_request": null,
        "join_to_send_messages": null,
        "linked_chat_id": null,
        "location": null,
        "message_auto_delete_time": null,
        "permissions": null,
        "personal_chat": null,
        "photo": null,
        "pinned_message": null,
        "profile_accent_color_id": null,
        "profile_background_custom_emoji_id": null,
        "slow_mode_delay": null,
        "sticker_set_name": null,
        "unrestrict_boost_count": null
    },
    "message_thread_id": null,
    "from_user": {
        "id": 432629636,
        "is_bot": false,
        "first_name": "Aydar",
        "last_name": null,
        "username": "asaidar",
        "language_code": "ru",
        "is_premium": null,
        "added_to_attachment_menu": null,
        "can_join_groups": null,
        "can_read_all_group_messages": null,
        "supports_inline_queries": null,
        "can_connect_to_business": null,
        "has_main_web_app": null
    },
    "sender_chat": null,
    "sender_boost_count": null,
    "sender_business_bot": null,
    "business_connection_id": null,
    "forward_origin": null,
    "is_topic_message": null,
    "is_automatic_forward": null,
    "reply_to_message": null,
    "external_reply": null,
    "quote": null,
    "reply_to_story": null,
    "via_bot": null,
    "edit_date": null,
    "has_protected_content": null,
    "is_from_offline": null,
    "media_group_id": null,
    "author_signature": null,
    "text": null,
    "entities": null,
    "link_preview_options": null,
    "effect_id": null,
    "animation": null,
    "audio": null,
    "document": null,
    "paid_media": null,
    "photo": null,
    "sticker": null,
    "story": null,
    "video": null,
    "video_note": null,
    "voice": null,
    "caption": null,
    "caption_entities": null,
    "show_caption_above_media": null,
    "has_media_spoiler": null,
    "contact": null,
    "dice": null,
    "game": null,
    "poll": null,
    "venue": null,
    "location": null,
    "new_chat_members": null,
    "left_chat_member": null,
    "new_chat_title": null,
    "new_chat_photo": null,
    "delete_chat_photo": null,
    "group_chat_created": null,
    "supergroup_chat_created": null,
    "channel_chat_created": null,
    "message_auto_delete_timer_changed": null,
    "migrate_to_chat_id": null,
    "migrate_from_chat_id": null,
    "pinned_message": null,
    "invoice": null,
    "successful_payment": {
        "currency": "RUB",
        "total_amount": 14000,
        "invoice_payload": "266f21c6-8c25-40b2-98b6-a94f19fa664e",
        "telegram_payment_charge_id": "7444575424_432629636_633489",
        "provider_payment_charge_id": "2f1c6416-000f-5000-b000-1a945b1feff0",
        "subscription_expiration_date": null,
        "is_recurring": null,
        "is_first_recurring": null,
        "shipping_option_id": null,
        "order_info": null
    },
    "refunded_payment": null,
    "users_shared": null,
    "chat_shared": null,
    "connected_website": null,
    "write_access_allowed": null,
    "passport_data": null,
    "proximity_alert_triggered": null,
    "boost_added": null,
    "chat_background_set": null,
    "forum_topic_created": null,
    "forum_topic_edited": null,
    "forum_topic_closed": null,
    "forum_topic_reopened": null,
    "general_forum_topic_hidden": null,
    "general_forum_topic_unhidden": null,
    "giveaway_created": null,
    "giveaway": null,
    "giveaway_winners": null,
    "giveaway_completed": null,
    "video_chat_scheduled": null,
    "video_chat_started": null,
    "video_chat_ended": null,
    "video_chat_participants_invited": null,
    "web_app_data": null,
    "reply_markup": null,
    "forward_date": null,
    "forward_from": null,
    "forward_from_chat": null,
    "forward_from_message_id": null,
    "forward_sender_name": null,
    "forward_signature": null,
    "user_shared": null
}
2025-01-17 15:43:06,621 - root - INFO - Key created: OutlineKey(key_id='117', name='VPN Key65', password='x7WuX0EQsrzFdLiu4cOq8q', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTp4N1d1WDBFUXNyekZkTGl1NGNPcThx@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 432629636
2025-01-17 15:43:06,624 - root - INFO - Key created: OutlineKey(key_id='116', name='VPN Key64', password='DDQMtRjDJA7Ipkb1Qbms5E', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpERFFNdFJqREpBN0lwa2IxUWJtczVF@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2025-01-17 15:43:06,773 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:43:06,773 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-17 15:43:06,774 - sqlalchemy.engine.Engine - INFO - [cached since 63.03s ago] ('528155210', 1, 0)
2025-01-17 15:43:06,779 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2025-01-17 15:43:06,779 - sqlalchemy.engine.Engine - INFO - [generated in 0.00077s] ('116', '528155210', '2025-07-16 15:43:06.775609', '2025-01-17 15:43:06.775609', 0)
2025-01-17 15:43:06,784 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 15:43:06,795 - aiogram.event - INFO - Update id=659309367 is handled. Duration 4000 ms by bot id=7444575424
2025-01-17 15:43:06,958 - root - INFO - Key created: OutlineKey(key_id='117', name='VPN Key65', password='x7WuX0EQsrzFdLiu4cOq8q', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTp4N1d1WDBFUXNyekZkTGl1NGNPcThx@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2025-01-17 15:43:07,202 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:43:07,203 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-17 15:43:07,203 - sqlalchemy.engine.Engine - INFO - [cached since 63.46s ago] ('432629636', 1, 0)
2025-01-17 15:43:07,206 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (user_telegram_id, subscription_status, use_trial_period) VALUES (?, ?, ?)
2025-01-17 15:43:07,206 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] ('432629636', 'active', 0)
2025-01-17 15:43:07,207 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 15:43:07,216 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 15:43:07,216 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2025-01-17 15:43:07,217 - sqlalchemy.engine.Engine - INFO - [cached since 0.4384s ago] ('117', '432629636', '2025-04-17 15:43:07.216613', '2025-01-17 15:43:07.216613', 0)
2025-01-17 15:43:07,218 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 15:43:07,226 - aiogram.event - INFO - Update id=659309368 is handled. Duration 2405 ms by bot id=7444575424
2025-01-17 15:43:12,898 - aiogram.event - INFO - Update id=659309369 is handled. Duration 203 ms by bot id=7444575424
2025-01-17 15:43:22,745 - aiogram.dispatcher - INFO - Polling stopped
2025-01-17 15:43:22,786 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [Errno 1] [SSL: APPLICATION_DATA_AFTER_CLOSE_NOTIFY] application data after close notify (_ssl.c:2702)
2025-01-17 15:43:22,786 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-17 15:43:23,017 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 15:43:23,018 - root - INFO - Бот остановлен вручную.
2025-01-17 15:43:23,192 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000210C66155D0>
2025-01-17 16:42:37,279 - root - INFO - Инициализация бота...
2025-01-17 16:42:38,272 - root - INFO - Инициализация бота...
2025-01-17 16:42:38,374 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 16:42:38,375 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-17 16:42:38,375 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 16:42:38,380 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-17 16:42:38,380 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 16:42:38,381 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 16:42:38,471 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-17 16:42:38,472 - root - INFO - Инициализация диспетчера...
2025-01-17 16:42:38,475 - root - INFO - Регистрация обработчиков...
2025-01-17 16:42:38,487 - root - INFO - Регистрация main menu команд...
2025-01-17 16:42:38,854 - root - INFO - Команды успешно установлены
2025-01-17 16:42:38,854 - root - INFO - Запуск polling...
2025-01-17 16:42:38,855 - aiogram.dispatcher - INFO - Start polling
2025-01-17 16:42:38,869 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 16:42:38,874 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-17 16:42:38,875 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] ()
2025-01-17 16:42:38,883 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 16:42:38,883 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] ('181151262',)
2025-01-17 16:42:41,355 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 16:42:41,357 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 16:42:41,361 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 16:42:41,361 - sqlalchemy.engine.Engine - INFO - [generated in 0.00096s] ('181151262',)
2025-01-17 16:42:41,450 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 16:42:41,672 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 16:42:41,673 - sqlalchemy.engine.Engine - INFO - [cached since 0.313s ago] ('528155210',)
2025-01-17 16:42:41,677 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 16:42:41,678 - sqlalchemy.engine.Engine - INFO - [cached since 2.796s ago] ('528155210',)
2025-01-17 16:42:43,216 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 16:42:43,218 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 16:42:43,222 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-17 16:42:43,223 - sqlalchemy.engine.Engine - INFO - [generated in 0.00099s] ('115',)
2025-01-17 16:42:44,697 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-17 16:42:44,698 - sqlalchemy.engine.Engine - INFO - [cached since 1.477s ago] ('116',)
2025-01-17 16:42:46,968 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 16:42:46,968 - sqlalchemy.engine.Engine - INFO - [cached since 5.608s ago] ('528155210',)
2025-01-17 16:42:47,079 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 16:42:47,079 - sqlalchemy.engine.Engine - INFO - [cached since 5.72s ago] ('432629636',)
2025-01-17 16:42:47,081 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 16:42:47,082 - sqlalchemy.engine.Engine - INFO - [cached since 8.2s ago] ('432629636',)
2025-01-17 16:42:49,843 - aiogram.event - INFO - Update id=659309370 is handled. Duration 2782 ms by bot id=7444575424
2025-01-17 16:42:50,354 - aiogram.event - INFO - Update id=659309371 is handled. Duration 1202 ms by bot id=7444575424
2025-01-17 16:42:53,686 - aiogram.event - INFO - Update id=659309372 is handled. Duration 280 ms by bot id=7444575424
2025-01-17 16:55:47,483 - aiogram.dispatcher - INFO - Polling stopped
2025-01-17 16:55:47,744 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 16:55:47,747 - root - INFO - Бот остановлен вручную.
2025-01-17 16:55:48,145 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000018F7A918450>
2025-01-17 18:00:24,163 - root - INFO - Инициализация бота...
2025-01-17 18:00:25,179 - root - INFO - Инициализация бота...
2025-01-17 18:00:37,426 - root - INFO - Инициализация бота...
2025-01-17 18:00:38,049 - root - INFO - Инициализация бота...
2025-01-17 18:00:56,038 - root - INFO - Инициализация бота...
2025-01-17 18:00:56,907 - root - INFO - Инициализация бота...
2025-01-17 18:01:19,547 - root - INFO - Инициализация бота...
2025-01-17 18:01:20,190 - root - INFO - Инициализация бота...
2025-01-17 18:01:20,260 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 18:01:20,261 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-17 18:01:20,261 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 18:01:20,265 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-17 18:01:20,265 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-17 18:01:20,266 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 18:01:20,310 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-17 18:01:20,311 - root - INFO - Инициализация диспетчера...
2025-01-17 18:01:20,312 - root - INFO - Регистрация обработчиков...
2025-01-17 18:01:20,316 - root - INFO - Регистрация main menu команд...
2025-01-17 18:01:21,136 - root - INFO - Команды успешно установлены
2025-01-17 18:01:21,136 - root - INFO - Запуск polling...
2025-01-17 18:01:21,137 - aiogram.dispatcher - INFO - Start polling
2025-01-17 18:01:21,156 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 18:01:21,170 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-17 18:01:21,170 - sqlalchemy.engine.Engine - INFO - [generated in 0.00108s] ()
2025-01-17 18:01:21,181 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 18:01:21,182 - sqlalchemy.engine.Engine - INFO - [generated in 0.00090s] ('181151262',)
2025-01-17 18:01:24,165 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 18:01:24,168 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 18:01:24,171 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 18:01:24,172 - sqlalchemy.engine.Engine - INFO - [generated in 0.00125s] ('181151262',)
2025-01-17 18:01:24,259 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 18:01:24,672 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 18:01:24,673 - sqlalchemy.engine.Engine - INFO - [cached since 0.502s ago] ('528155210',)
2025-01-17 18:01:24,674 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 18:01:24,674 - sqlalchemy.engine.Engine - INFO - [cached since 3.493s ago] ('528155210',)
2025-01-17 18:01:27,194 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-17 18:01:27,197 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-17 18:01:27,200 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-17 18:01:27,202 - sqlalchemy.engine.Engine - INFO - [generated in 0.00165s] ('115',)
2025-01-17 18:01:29,492 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-17 18:01:29,494 - sqlalchemy.engine.Engine - INFO - [cached since 2.294s ago] ('116',)
2025-01-17 18:01:32,442 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 18:01:32,443 - sqlalchemy.engine.Engine - INFO - [cached since 8.273s ago] ('528155210',)
2025-01-17 18:01:32,598 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-17 18:01:32,598 - sqlalchemy.engine.Engine - INFO - [cached since 8.428s ago] ('432629636',)
2025-01-17 18:01:32,601 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-17 18:01:32,601 - sqlalchemy.engine.Engine - INFO - [cached since 11.42s ago] ('432629636',)
2025-01-17 18:01:35,062 - aiogram.event - INFO - Update id=659309385 is not handled. Duration 0 ms by bot id=7444575424
2025-01-17 18:01:35,587 - aiogram.event - INFO - Update id=659309386 is handled. Duration 438 ms by bot id=7444575424
2025-01-17 18:01:37,031 - aiogram.event - INFO - Update id=659309387 is handled. Duration 171 ms by bot id=7444575424
2025-01-17 18:01:38,018 - aiogram.event - INFO - Update id=659309388 is handled. Duration 218 ms by bot id=7444575424
2025-01-17 18:01:49,184 - aiogram.dispatcher - INFO - Polling stopped
2025-01-17 18:01:49,450 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-17 18:01:49,461 - root - INFO - Бот остановлен вручную.
2025-01-18 12:09:31,024 - root - INFO - Инициализация бота...
2025-01-18 12:09:32,564 - root - INFO - Инициализация бота...
2025-01-18 12:09:32,866 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 12:09:32,867 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 12:09:32,868 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 12:09:32,875 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 12:09:32,875 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 12:09:32,876 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 12:09:32,959 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 12:09:32,960 - root - INFO - Инициализация диспетчера...
2025-01-18 12:09:32,963 - root - INFO - Регистрация обработчиков...
2025-01-18 12:09:32,967 - root - INFO - Регистрация main menu команд...
2025-01-18 12:09:33,331 - root - INFO - Команды успешно установлены
2025-01-18 12:09:33,332 - root - INFO - Запуск polling...
2025-01-18 12:09:33,332 - aiogram.dispatcher - INFO - Start polling
2025-01-18 12:09:33,345 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 12:09:33,351 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 12:09:33,352 - sqlalchemy.engine.Engine - INFO - [generated in 0.00079s] ()
2025-01-18 12:09:33,359 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 12:09:33,359 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] ('181151262',)
2025-01-18 12:09:35,517 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 12:09:35,520 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 12:09:35,523 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 12:09:35,523 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] ('181151262',)
2025-01-18 12:09:35,617 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 12:09:35,954 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 12:09:35,955 - sqlalchemy.engine.Engine - INFO - [cached since 0.4335s ago] ('528155210',)
2025-01-18 12:09:35,960 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 12:09:35,961 - sqlalchemy.engine.Engine - INFO - [cached since 2.602s ago] ('528155210',)
2025-01-18 12:09:37,810 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 12:09:37,815 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 12:09:37,822 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 12:09:37,823 - sqlalchemy.engine.Engine - INFO - [generated in 0.00215s] ('115',)
2025-01-18 12:09:39,611 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 12:09:39,612 - sqlalchemy.engine.Engine - INFO - [cached since 1.791s ago] ('116',)
2025-01-18 12:09:41,322 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 12:09:41,322 - sqlalchemy.engine.Engine - INFO - [cached since 5.8s ago] ('528155210',)
2025-01-18 12:09:41,413 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 12:09:41,413 - sqlalchemy.engine.Engine - INFO - [cached since 5.891s ago] ('432629636',)
2025-01-18 12:09:41,415 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 12:09:41,415 - sqlalchemy.engine.Engine - INFO - [cached since 8.057s ago] ('432629636',)
2025-01-18 13:19:24,720 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [WinError 1236] Подключение к сети было разорвано локальной системой
2025-01-18 13:19:24,747 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-18 13:19:25,823 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Сетевая папка недоступна. За информацией о разрешении проблем в сети обратитесь к справочной системе Windows]
2025-01-18 13:19:25,825 - aiogram.dispatcher - WARNING - Sleep for 1.304339 seconds and try again... (tryings = 1, bot id = 7444575424)
2025-01-18 13:19:27,154 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Сетевая папка недоступна. За информацией о разрешении проблем в сети обратитесь к справочной системе Windows]
2025-01-18 13:19:27,155 - aiogram.dispatcher - WARNING - Sleep for 1.610773 seconds and try again... (tryings = 2, bot id = 7444575424)
2025-01-18 13:19:28,786 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Сетевая папка недоступна. За информацией о разрешении проблем в сети обратитесь к справочной системе Windows]
2025-01-18 13:19:28,787 - aiogram.dispatcher - WARNING - Sleep for 2.119632 seconds and try again... (tryings = 3, bot id = 7444575424)
2025-01-18 13:19:41,140 - aiogram.dispatcher - INFO - Connection established (tryings = 4, bot id = 7444575424)
2025-01-18 13:43:56,536 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-01-18 13:43:56,536 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-18 13:44:01,764 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-01-18 13:44:01,764 - aiogram.dispatcher - WARNING - Sleep for 1.445090 seconds and try again... (tryings = 1, bot id = 7444575424)
2025-01-18 13:44:06,161 - aiogram.dispatcher - INFO - Connection established (tryings = 2, bot id = 7444575424)
2025-01-18 13:44:06,524 - aiogram.event - INFO - Update id=659309389 is handled. Duration 343 ms by bot id=7444575424
2025-01-18 13:44:07,639 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-01-18 13:44:07,639 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-18 13:44:09,905 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7444575424)
2025-01-18 13:44:10,206 - aiogram.event - INFO - Update id=659309391 is handled. Duration 296 ms by bot id=7444575424
2025-01-18 13:44:12,531 - aiogram.event - INFO - Update id=659309392 is handled. Duration 266 ms by bot id=7444575424
2025-01-18 13:44:12,852 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-01-18 13:44:12,852 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-18 13:44:16,174 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7444575424)
2025-01-18 13:44:16,177 - aiogram.event - INFO - Update id=659309394 is not handled. Duration 0 ms by bot id=7444575424
2025-01-18 13:44:17,702 - aiogram.event - INFO - Update id=659309395 is handled. Duration 171 ms by bot id=7444575424
2025-01-18 13:44:18,025 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-01-18 13:44:18,025 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-18 13:44:20,749 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7444575424)
2025-01-18 13:44:21,063 - aiogram.event - INFO - Update id=659309397 is handled. Duration 311 ms by bot id=7444575424
2025-01-18 13:44:21,398 - aiogram.event - INFO - Update id=659309398 is not handled. Duration 0 ms by bot id=7444575424
2025-01-18 13:44:22,263 - aiogram.event - INFO - Update id=659309399 is not handled. Duration 233 ms by bot id=7444575424
2025-01-18 13:44:22,265 - aiogram.event - ERROR - Cause exception while process update id=659309399 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 76, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 13:44:23,165 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-01-18 13:44:23,165 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-18 13:44:25,040 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7444575424)
2025-01-18 13:44:25,042 - aiogram.event - INFO - Update id=659309400 is not handled. Duration 0 ms by bot id=7444575424
2025-01-18 13:44:25,993 - aiogram.event - INFO - Update id=659309401 is handled. Duration 202 ms by bot id=7444575424
2025-01-18 13:44:27,144 - aiogram.event - INFO - Update id=659309402 is handled. Duration 250 ms by bot id=7444575424
2025-01-18 13:44:28,338 - aiogram.event - INFO - Update id=659309403 is handled. Duration 328 ms by bot id=7444575424
2025-01-18 13:44:28,764 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-01-18 13:44:28,765 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-18 13:44:31,267 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7444575424)
2025-01-18 13:44:31,431 - aiogram.event - INFO - Update id=659309404 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 13:44:33,055 - aiogram.event - INFO - Update id=659309405 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 13:44:34,024 - aiogram.event - INFO - Update id=659309406 is not handled. Duration 171 ms by bot id=7444575424
2025-01-18 13:44:34,025 - aiogram.event - ERROR - Cause exception while process update id=659309406 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 76, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 13:44:34,772 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-01-18 13:44:34,772 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-18 13:44:36,001 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7444575424)
2025-01-18 13:44:36,173 - aiogram.event - INFO - Update id=659309407 is handled. Duration 171 ms by bot id=7444575424
2025-01-18 13:44:37,588 - aiogram.event - INFO - Update id=659309408 is handled. Duration 202 ms by bot id=7444575424
2025-01-18 13:44:39,172 - aiogram.event - INFO - Update id=659309409 is handled. Duration 343 ms by bot id=7444575424
2025-01-18 13:44:40,436 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 13:44:40,702 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 13:44:40,726 - root - INFO - Бот остановлен вручную.
2025-01-18 14:02:55,988 - root - INFO - Инициализация бота...
2025-01-18 14:02:57,327 - root - INFO - Инициализация бота...
2025-01-18 14:02:57,488 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 14:02:57,488 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 14:02:57,488 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 14:02:57,490 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 14:02:57,490 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 14:02:57,490 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 14:02:57,547 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 14:02:57,547 - root - INFO - Инициализация диспетчера...
2025-01-18 14:02:57,548 - root - INFO - Регистрация обработчиков...
2025-01-18 14:02:57,549 - root - INFO - Регистрация main menu команд...
2025-01-18 14:02:57,938 - root - INFO - Команды успешно установлены
2025-01-18 14:02:57,938 - root - INFO - Запуск polling...
2025-01-18 14:02:57,938 - aiogram.dispatcher - INFO - Start polling
2025-01-18 14:02:57,945 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 14:02:57,947 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 14:02:57,947 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] ()
2025-01-18 14:02:57,951 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 14:02:57,951 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ('181151262',)
2025-01-18 14:03:00,150 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 14:03:00,153 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 14:03:00,155 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 14:03:00,157 - sqlalchemy.engine.Engine - INFO - [generated in 0.00089s] ('181151262',)
2025-01-18 14:03:00,220 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 14:03:00,675 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 14:03:00,676 - sqlalchemy.engine.Engine - INFO - [cached since 0.5202s ago] ('528155210',)
2025-01-18 14:03:00,676 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 14:03:00,676 - sqlalchemy.engine.Engine - INFO - [cached since 2.726s ago] ('528155210',)
2025-01-18 14:03:02,783 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 14:03:02,783 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 14:03:02,784 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 14:03:02,784 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] ('115',)
2025-01-18 14:03:04,926 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 14:03:04,926 - sqlalchemy.engine.Engine - INFO - [cached since 2.143s ago] ('116',)
2025-01-18 14:03:06,233 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 14:03:06,233 - sqlalchemy.engine.Engine - INFO - [cached since 6.078s ago] ('528155210',)
2025-01-18 14:03:06,235 - aiogram.event - INFO - Update id=659309517 is handled. Duration 5937 ms by bot id=7444575424
2025-01-18 14:03:06,360 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 14:03:06,360 - sqlalchemy.engine.Engine - INFO - [cached since 6.205s ago] ('432629636',)
2025-01-18 14:03:06,361 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 14:03:06,361 - sqlalchemy.engine.Engine - INFO - [cached since 8.411s ago] ('432629636',)
2025-01-18 14:03:08,032 - aiogram.event - INFO - Update id=659309518 is handled. Duration 1797 ms by bot id=7444575424
2025-01-18 14:03:08,548 - root - INFO - Sending invoice with currency=RUB, amount={LabeledPrice(label='Ключ от VPN', amount=5000)}
2025-01-18 14:03:08,697 - aiogram.event - INFO - Update id=659309519 is not handled. Duration 139 ms by bot id=7444575424
2025-01-18 14:03:08,697 - aiogram.event - ERROR - Cause exception while process update id=659309519 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 77, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 14:03:12,375 - aiogram.event - INFO - Update id=659309520 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 14:03:13,820 - aiogram.event - INFO - Update id=659309521 is handled. Duration 405 ms by bot id=7444575424
2025-01-18 14:03:14,831 - root - INFO - Sending invoice with currency=RUB, amount={LabeledPrice(label='Ключ от VPN', amount=5000)}
2025-01-18 14:03:14,981 - aiogram.event - INFO - Update id=659309522 is not handled. Duration 156 ms by bot id=7444575424
2025-01-18 14:03:14,982 - aiogram.event - ERROR - Cause exception while process update id=659309522 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 77, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 14:03:30,579 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 14:03:30,833 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 14:03:30,835 - root - INFO - Бот остановлен вручную.
2025-01-18 14:03:31,005 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000149C8709590>
2025-01-18 14:03:31,006 - asyncio - ERROR - Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x00000149CC4BD6A0>, 74101.39)]']
connector: <aiohttp.connector.TCPConnector object at 0x00000149C5235B90>
2025-01-18 14:03:34,148 - root - INFO - Инициализация бота...
2025-01-18 14:03:34,502 - root - INFO - Инициализация бота...
2025-01-18 14:03:34,539 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 14:03:34,539 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 14:03:34,539 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 14:03:34,540 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 14:03:34,540 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 14:03:34,540 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 14:03:34,563 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 14:03:34,563 - root - INFO - Инициализация диспетчера...
2025-01-18 14:03:34,564 - root - INFO - Регистрация обработчиков...
2025-01-18 14:03:34,565 - root - INFO - Регистрация main menu команд...
2025-01-18 14:03:35,028 - root - INFO - Команды успешно установлены
2025-01-18 14:03:35,028 - root - INFO - Запуск polling...
2025-01-18 14:03:35,028 - aiogram.dispatcher - INFO - Start polling
2025-01-18 14:03:35,038 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 14:03:35,043 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 14:03:35,043 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ()
2025-01-18 14:03:35,048 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 14:03:35,048 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] ('181151262',)
2025-01-18 14:03:37,704 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 14:03:37,706 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 14:03:37,707 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 14:03:37,707 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] ('181151262',)
2025-01-18 14:03:37,766 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 14:03:38,163 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 14:03:38,163 - sqlalchemy.engine.Engine - INFO - [cached since 0.4569s ago] ('528155210',)
2025-01-18 14:03:38,164 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 14:03:38,164 - sqlalchemy.engine.Engine - INFO - [cached since 3.118s ago] ('528155210',)
2025-01-18 14:03:39,729 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 14:03:39,730 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 14:03:39,731 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 14:03:39,731 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] ('115',)
2025-01-18 14:03:41,465 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 14:03:41,466 - sqlalchemy.engine.Engine - INFO - [cached since 1.735s ago] ('116',)
2025-01-18 14:03:42,724 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 14:03:42,724 - sqlalchemy.engine.Engine - INFO - [cached since 5.018s ago] ('528155210',)
2025-01-18 14:03:42,731 - aiogram.event - INFO - Update id=659309523 is handled. Duration 4889 ms by bot id=7444575424
2025-01-18 14:03:42,920 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 14:03:42,921 - sqlalchemy.engine.Engine - INFO - [cached since 5.214s ago] ('432629636',)
2025-01-18 14:03:42,921 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 14:03:42,922 - sqlalchemy.engine.Engine - INFO - [cached since 7.874s ago] ('432629636',)
2025-01-18 14:03:44,108 - aiogram.event - INFO - Update id=659309524 is handled. Duration 1375 ms by bot id=7444575424
2025-01-18 14:03:44,950 - root - INFO - Sending invoice with currency=RUB, amount={LabeledPrice(label='Ключ от VPN', amount=5000)}
2025-01-18 14:03:45,127 - aiogram.event - INFO - Update id=659309525 is not handled. Duration 188 ms by bot id=7444575424
2025-01-18 14:03:45,127 - aiogram.event - ERROR - Cause exception while process update id=659309525 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 78, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 14:03:47,134 - aiogram.event - INFO - Update id=659309526 is handled. Duration 218 ms by bot id=7444575424
2025-01-18 14:03:48,733 - aiogram.event - INFO - Update id=659309527 is handled. Duration 468 ms by bot id=7444575424
2025-01-18 14:03:49,613 - root - INFO - Sending invoice with currency=RUB, amount={LabeledPrice(label='Ключ от VPN', amount=5000)}
2025-01-18 14:03:49,808 - aiogram.event - INFO - Update id=659309528 is not handled. Duration 202 ms by bot id=7444575424
2025-01-18 14:03:49,808 - aiogram.event - ERROR - Cause exception while process update id=659309528 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 78, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 14:04:04,520 - aiogram.event - INFO - Update id=659309529 is handled. Duration 203 ms by bot id=7444575424
2025-01-18 14:04:08,777 - aiogram.event - INFO - Update id=659309530 is handled. Duration 219 ms by bot id=7444575424
2025-01-18 14:04:10,781 - root - INFO - Sending invoice with currency=RUB, amount={LabeledPrice(label='Ключ от VPN', amount=5000)}
2025-01-18 14:04:10,958 - aiogram.event - INFO - Update id=659309531 is not handled. Duration 171 ms by bot id=7444575424
2025-01-18 14:04:10,958 - aiogram.event - ERROR - Cause exception while process update id=659309531 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 78, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 14:05:37,042 - aiogram.event - INFO - Update id=659309532 is handled. Duration 437 ms by bot id=7444575424
2025-01-18 14:05:38,844 - aiogram.event - INFO - Update id=659309533 is handled. Duration 187 ms by bot id=7444575424
2025-01-18 14:05:39,974 - root - INFO - Sending invoice with currency=RUB, amount={LabeledPrice(label='Ключ от VPN', amount=14000)}
2025-01-18 14:05:40,220 - aiogram.event - INFO - Update id=659309534 is handled. Duration 250 ms by bot id=7444575424
2025-01-18 14:05:51,735 - aiogram.event - INFO - Update id=659309535 is handled. Duration 202 ms by bot id=7444575424
2025-01-18 14:05:53,247 - aiogram.event - INFO - Update id=659309536 is handled. Duration 141 ms by bot id=7444575424
2025-01-18 14:05:54,555 - root - INFO - Sending invoice with currency=RUB, amount={LabeledPrice(label='Ключ от VPN', amount=5000)}
2025-01-18 14:05:54,696 - aiogram.event - INFO - Update id=659309537 is not handled. Duration 139 ms by bot id=7444575424
2025-01-18 14:05:54,696 - aiogram.event - ERROR - Cause exception while process update id=659309537 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 78, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 14:06:19,438 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 14:06:19,702 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 14:06:19,704 - root - INFO - Бот остановлен вручную.
2025-01-18 14:06:19,885 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001FD85217D50>
2025-01-18 14:06:23,044 - root - INFO - Инициализация бота...
2025-01-18 14:06:23,384 - root - INFO - Инициализация бота...
2025-01-18 14:06:23,416 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 14:06:23,417 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 14:06:23,417 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 14:06:23,417 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 14:06:23,417 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 14:06:23,418 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 14:06:23,438 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 14:06:23,438 - root - INFO - Инициализация диспетчера...
2025-01-18 14:06:23,438 - root - INFO - Регистрация обработчиков...
2025-01-18 14:06:23,439 - root - INFO - Регистрация main menu команд...
2025-01-18 14:06:23,854 - root - INFO - Команды успешно установлены
2025-01-18 14:06:23,854 - root - INFO - Запуск polling...
2025-01-18 14:06:23,855 - aiogram.dispatcher - INFO - Start polling
2025-01-18 14:06:23,862 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 14:06:23,865 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 14:06:23,866 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ()
2025-01-18 14:06:23,870 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 14:06:23,871 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] ('181151262',)
2025-01-18 14:06:26,046 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 14:06:26,046 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 14:06:26,047 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 14:06:26,047 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ('181151262',)
2025-01-18 14:06:26,104 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 14:06:26,516 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 14:06:26,516 - sqlalchemy.engine.Engine - INFO - [cached since 0.4693s ago] ('528155210',)
2025-01-18 14:06:26,516 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 14:06:26,517 - sqlalchemy.engine.Engine - INFO - [cached since 2.647s ago] ('528155210',)
2025-01-18 14:06:27,795 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 14:06:27,796 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 14:06:27,797 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 14:06:27,797 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ('115',)
2025-01-18 14:06:29,866 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 14:06:29,866 - sqlalchemy.engine.Engine - INFO - [cached since 2.07s ago] ('116',)
2025-01-18 14:06:31,324 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 14:06:31,324 - sqlalchemy.engine.Engine - INFO - [cached since 5.278s ago] ('528155210',)
2025-01-18 14:06:31,591 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 14:06:31,591 - sqlalchemy.engine.Engine - INFO - [cached since 5.545s ago] ('432629636',)
2025-01-18 14:06:31,592 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 14:06:31,592 - sqlalchemy.engine.Engine - INFO - [cached since 7.723s ago] ('432629636',)
2025-01-18 14:06:32,975 - aiogram.event - INFO - Update id=659309538 is handled. Duration 1625 ms by bot id=7444575424
2025-01-18 14:06:33,655 - aiogram.event - INFO - Update id=659309539 is handled. Duration 187 ms by bot id=7444575424
2025-01-18 14:06:34,574 - root - INFO - Sending invoice with currency=RUB, amount={LabeledPrice(label='Ключ от VPN', amount=5000)}
2025-01-18 14:06:34,715 - aiogram.event - INFO - Update id=659309540 is not handled. Duration 141 ms by bot id=7444575424
2025-01-18 14:06:34,715 - aiogram.event - ERROR - Cause exception while process update id=659309540 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 76, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 14:08:29,629 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 14:08:29,888 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 14:08:29,890 - root - INFO - Бот остановлен вручную.
2025-01-18 14:08:30,199 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002D06A4BA750>
2025-01-18 14:08:36,711 - root - INFO - Инициализация бота...
2025-01-18 14:08:37,420 - root - INFO - Инициализация бота...
2025-01-18 14:08:37,519 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 14:08:37,520 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 14:08:37,520 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 14:08:37,522 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 14:08:37,522 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 14:08:37,524 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 14:08:37,562 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 14:08:37,562 - root - INFO - Инициализация диспетчера...
2025-01-18 14:08:37,563 - root - INFO - Регистрация обработчиков...
2025-01-18 14:08:37,564 - root - INFO - Регистрация main menu команд...
2025-01-18 14:08:38,105 - root - INFO - Команды успешно установлены
2025-01-18 14:08:38,106 - root - INFO - Запуск polling...
2025-01-18 14:08:38,106 - aiogram.dispatcher - INFO - Start polling
2025-01-18 14:08:38,130 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 14:08:38,136 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 14:08:38,137 - sqlalchemy.engine.Engine - INFO - [generated in 0.00088s] ()
2025-01-18 14:08:38,146 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 14:08:38,147 - sqlalchemy.engine.Engine - INFO - [generated in 0.00087s] ('181151262',)
2025-01-18 14:08:40,135 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 14:08:40,137 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 14:08:40,140 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 14:08:40,141 - sqlalchemy.engine.Engine - INFO - [generated in 0.00090s] ('181151262',)
2025-01-18 14:08:40,214 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 14:08:40,603 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 14:08:40,604 - sqlalchemy.engine.Engine - INFO - [cached since 0.4634s ago] ('528155210',)
2025-01-18 14:08:40,606 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 14:08:40,607 - sqlalchemy.engine.Engine - INFO - [cached since 2.461s ago] ('528155210',)
2025-01-18 14:08:42,235 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 14:08:42,238 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 14:08:42,242 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 14:08:42,242 - sqlalchemy.engine.Engine - INFO - [generated in 0.00101s] ('115',)
2025-01-18 14:08:44,089 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 14:08:44,090 - sqlalchemy.engine.Engine - INFO - [cached since 1.849s ago] ('116',)
2025-01-18 14:08:45,913 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 14:08:45,914 - sqlalchemy.engine.Engine - INFO - [cached since 5.774s ago] ('528155210',)
2025-01-18 14:08:45,929 - aiogram.event - INFO - Update id=659309541 is handled. Duration 5562 ms by bot id=7444575424
2025-01-18 14:08:46,101 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 14:08:46,102 - sqlalchemy.engine.Engine - INFO - [cached since 5.961s ago] ('432629636',)
2025-01-18 14:08:46,105 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 14:08:46,106 - sqlalchemy.engine.Engine - INFO - [cached since 7.959s ago] ('432629636',)
2025-01-18 14:08:47,940 - aiogram.event - INFO - Update id=659309542 is handled. Duration 2014 ms by bot id=7444575424
2025-01-18 14:08:51,409 - aiogram.event - INFO - Update id=659309543 is handled. Duration 219 ms by bot id=7444575424
2025-01-18 14:08:52,909 - aiogram.event - INFO - Update id=659309544 is handled. Duration 266 ms by bot id=7444575424
2025-01-18 14:08:53,786 - root - INFO - Sending invoice with currency=RUB, amount={LabeledPrice(label='Ключ от VPN', amount=5000)}
2025-01-18 14:08:54,147 - aiogram.event - INFO - Update id=659309545 is not handled. Duration 358 ms by bot id=7444575424
2025-01-18 14:08:54,148 - aiogram.event - ERROR - Cause exception while process update id=659309545 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 76, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 19:26:46,798 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - Request timeout error
2025-01-18 19:26:46,799 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-18 19:26:58,765 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7444575424)
2025-01-18 19:28:19,983 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - Request timeout error
2025-01-18 19:28:19,983 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-18 19:28:30,355 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:28:30,614 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:28:30,626 - root - INFO - Бот остановлен вручную.
2025-01-18 19:28:31,064 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001D28E22CED0>
2025-01-18 19:28:38,165 - root - INFO - Инициализация бота...
2025-01-18 19:28:39,093 - root - INFO - Инициализация бота...
2025-01-18 19:28:39,208 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:28:39,209 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:28:39,209 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:28:39,212 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:28:39,212 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:28:39,213 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:28:39,271 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:28:39,271 - root - INFO - Инициализация диспетчера...
2025-01-18 19:28:39,273 - root - INFO - Регистрация обработчиков...
2025-01-18 19:28:39,275 - root - INFO - Регистрация main menu команд...
2025-01-18 19:28:40,113 - root - INFO - Команды успешно установлены
2025-01-18 19:28:40,113 - root - INFO - Запуск polling...
2025-01-18 19:28:40,113 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:28:40,123 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:28:40,125 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:28:40,126 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ()
2025-01-18 19:28:40,131 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:28:40,131 - sqlalchemy.engine.Engine - INFO - [generated in 0.00068s] ('181151262',)
2025-01-18 19:28:42,960 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:28:42,962 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:28:42,963 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:28:42,964 - sqlalchemy.engine.Engine - INFO - [generated in 0.00071s] ('181151262',)
2025-01-18 19:28:43,049 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:28:43,417 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:28:43,418 - sqlalchemy.engine.Engine - INFO - [cached since 0.455s ago] ('528155210',)
2025-01-18 19:28:43,420 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:28:43,420 - sqlalchemy.engine.Engine - INFO - [cached since 3.289s ago] ('528155210',)
2025-01-18 19:28:45,266 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:28:45,270 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:28:45,274 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:28:45,276 - sqlalchemy.engine.Engine - INFO - [generated in 0.00210s] ('115',)
2025-01-18 19:28:46,874 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:28:46,874 - sqlalchemy.engine.Engine - INFO - [cached since 1.601s ago] ('116',)
2025-01-18 19:28:48,242 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:28:48,243 - sqlalchemy.engine.Engine - INFO - [cached since 5.28s ago] ('528155210',)
2025-01-18 19:28:48,542 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:28:48,543 - sqlalchemy.engine.Engine - INFO - [cached since 5.58s ago] ('432629636',)
2025-01-18 19:28:48,546 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:28:48,548 - sqlalchemy.engine.Engine - INFO - [cached since 8.417s ago] ('432629636',)
2025-01-18 19:28:55,010 - aiogram.event - INFO - Update id=659309548 is handled. Duration 531 ms by bot id=7444575424
2025-01-18 19:28:56,201 - aiogram.event - INFO - Update id=659309549 is handled. Duration 343 ms by bot id=7444575424
2025-01-18 19:28:57,154 - root - INFO - Sending invoice with currency=RUB, amount={LabeledPrice(label='Ключ от VPN', amount=5000)}
2025-01-18 19:28:57,308 - aiogram.event - INFO - Update id=659309550 is not handled. Duration 155 ms by bot id=7444575424
2025-01-18 19:28:57,309 - aiogram.event - ERROR - Cause exception while process update id=659309550 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 76, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 19:30:39,877 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:30:40,141 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:30:40,146 - root - INFO - Бот остановлен вручную.
2025-01-18 19:30:40,678 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000019483AC7DD0>
2025-01-18 19:30:47,586 - root - INFO - Инициализация бота...
2025-01-18 19:30:48,242 - root - INFO - Инициализация бота...
2025-01-18 19:30:48,329 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:30:48,330 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:30:48,330 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:30:48,332 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:30:48,333 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:30:48,334 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:30:48,379 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:30:48,380 - root - INFO - Инициализация диспетчера...
2025-01-18 19:30:48,380 - root - INFO - Регистрация обработчиков...
2025-01-18 19:30:48,382 - root - INFO - Регистрация main menu команд...
2025-01-18 19:30:50,171 - root - INFO - Команды успешно установлены
2025-01-18 19:30:50,172 - root - INFO - Запуск polling...
2025-01-18 19:30:50,174 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:30:50,193 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:30:50,201 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:30:50,202 - sqlalchemy.engine.Engine - INFO - [generated in 0.00113s] ()
2025-01-18 19:30:50,213 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:30:50,214 - sqlalchemy.engine.Engine - INFO - [generated in 0.00103s] ('181151262',)
2025-01-18 19:30:52,856 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:30:52,858 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:30:52,861 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:30:52,862 - sqlalchemy.engine.Engine - INFO - [generated in 0.00126s] ('181151262',)
2025-01-18 19:30:52,949 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:30:53,351 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:30:53,352 - sqlalchemy.engine.Engine - INFO - [cached since 0.4908s ago] ('528155210',)
2025-01-18 19:30:53,354 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:30:53,355 - sqlalchemy.engine.Engine - INFO - [cached since 3.143s ago] ('528155210',)
2025-01-18 19:30:56,282 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:30:56,285 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:30:56,289 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:30:56,291 - sqlalchemy.engine.Engine - INFO - [generated in 0.00096s] ('115',)
2025-01-18 19:30:58,490 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:30:58,491 - sqlalchemy.engine.Engine - INFO - [cached since 2.203s ago] ('116',)
2025-01-18 19:31:02,177 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:31:02,177 - sqlalchemy.engine.Engine - INFO - [cached since 9.316s ago] ('528155210',)
2025-01-18 19:31:02,422 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:31:02,424 - sqlalchemy.engine.Engine - INFO - [cached since 9.563s ago] ('432629636',)
2025-01-18 19:31:02,429 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:31:02,430 - sqlalchemy.engine.Engine - INFO - [cached since 12.22s ago] ('432629636',)
2025-01-18 19:31:04,807 - aiogram.event - INFO - Update id=659309551 is handled. Duration 421 ms by bot id=7444575424
2025-01-18 19:31:05,961 - aiogram.event - INFO - Update id=659309552 is handled. Duration 202 ms by bot id=7444575424
2025-01-18 19:31:06,850 - root - INFO - Sending invoice with currency=RUB, amount={'label': 'Ключ от VPN', 'amount': 5000}
2025-01-18 19:31:06,942 - aiogram.event - INFO - Update id=659309553 is not handled. Duration 92 ms by bot id=7444575424
2025-01-18 19:31:06,943 - aiogram.event - ERROR - Cause exception while process update id=659309553 by bot id=7444575424
ValidationError: 1 validation error for SendInvoice
prices
  Input should be a valid list [type=list_type, input_value={'label': 'Ключ от VPN', 'amount': 5000}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/list_type
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 77, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2738, in send_invoice
    call = SendInvoice(
           ^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\pydantic\main.py", line 212, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for SendInvoice
prices
  Input should be a valid list [type=list_type, input_value={'label': 'Ключ от VPN', 'amount': 5000}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/list_type
2025-01-18 19:31:36,766 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:31:37,035 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:31:37,054 - root - INFO - Бот остановлен вручную.
2025-01-18 19:31:37,413 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000246612CE790>
2025-01-18 19:31:45,995 - root - INFO - Инициализация бота...
2025-01-18 19:31:46,725 - root - INFO - Инициализация бота...
2025-01-18 19:31:46,781 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:31:46,781 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:31:46,781 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:31:46,783 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:31:46,783 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:31:46,783 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:31:46,819 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:31:46,820 - root - INFO - Инициализация диспетчера...
2025-01-18 19:31:46,821 - root - INFO - Регистрация обработчиков...
2025-01-18 19:31:46,822 - root - INFO - Регистрация main menu команд...
2025-01-18 19:31:47,161 - root - INFO - Команды успешно установлены
2025-01-18 19:31:47,162 - root - INFO - Запуск polling...
2025-01-18 19:31:47,163 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:31:47,181 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:31:47,188 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:31:47,189 - sqlalchemy.engine.Engine - INFO - [generated in 0.00086s] ()
2025-01-18 19:31:47,199 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:31:47,199 - sqlalchemy.engine.Engine - INFO - [generated in 0.00089s] ('181151262',)
2025-01-18 19:31:50,198 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:31:50,201 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:31:50,205 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:31:50,205 - sqlalchemy.engine.Engine - INFO - [generated in 0.00100s] ('181151262',)
2025-01-18 19:31:50,329 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:31:50,731 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:31:50,731 - sqlalchemy.engine.Engine - INFO - [cached since 0.5271s ago] ('528155210',)
2025-01-18 19:31:50,732 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:31:50,732 - sqlalchemy.engine.Engine - INFO - [cached since 3.534s ago] ('528155210',)
2025-01-18 19:31:52,885 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:31:52,887 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:31:52,890 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:31:52,891 - sqlalchemy.engine.Engine - INFO - [generated in 0.00098s] ('115',)
2025-01-18 19:31:54,981 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:31:54,981 - sqlalchemy.engine.Engine - INFO - [cached since 2.091s ago] ('116',)
2025-01-18 19:31:56,166 - root - ERROR - Ошибка проверки базы данных: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
2025-01-18 19:31:56,167 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-5' coro=<DbProcessor.check_db() done, defined at C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py:65> exception=ConnectionError(ProtocolError('Connection aborted.', RemoteDisconnected('Remote end closed connection without response')))>
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\connectionpool.py", line 789, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\connectionpool.py", line 536, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\connection.py", line 507, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 1378, in getresponse
    response.begin()
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 318, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\connectionpool.py", line 843, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\util\retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\util\util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\connectionpool.py", line 789, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\connectionpool.py", line 536, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\connection.py", line 507, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 1378, in getresponse
    response.begin()
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 318, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
urllib3.exceptions.ProtocolError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py", line 74, in check_db
    key_info = outline_processor.get_key_info(key.key_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\utils\outline_processor.py", line 17, in get_key_info
    return self.client.get_key(key_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\outline_vpn\outline_vpn.py", line 117, in get_key
    response_metrics = self.session.get(
                       ^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\requests\adapters.py", line 682, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
2025-01-18 19:31:56,359 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-01-18 19:31:56,359 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-18 19:32:02,427 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:32:02,684 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:32:02,687 - root - INFO - Бот остановлен вручную.
2025-01-18 19:32:10,170 - root - INFO - Инициализация бота...
2025-01-18 19:32:11,092 - root - INFO - Инициализация бота...
2025-01-18 19:32:11,182 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:32:11,183 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:32:11,183 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:32:11,185 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:32:11,185 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:32:11,186 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:32:11,249 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:32:11,249 - root - INFO - Инициализация диспетчера...
2025-01-18 19:32:11,251 - root - INFO - Регистрация обработчиков...
2025-01-18 19:32:11,254 - root - INFO - Регистрация main menu команд...
2025-01-18 19:32:23,342 - root - ERROR - Ошибка при установке команд: HTTP Client says - ClientConnectorDNSError: Cannot connect to host api.telegram.org:443 ssl:default [getaddrinfo failed]
2025-01-18 19:32:23,343 - root - INFO - Запуск polling...
2025-01-18 19:32:23,344 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:32:23,366 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:32:23,375 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:32:23,376 - sqlalchemy.engine.Engine - INFO - [generated in 0.00175s] ()
2025-01-18 19:32:23,389 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:32:23,390 - sqlalchemy.engine.Engine - INFO - [generated in 0.00111s] ('181151262',)
2025-01-18 19:32:25,314 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:32:25,316 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:32:25,319 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:32:25,320 - sqlalchemy.engine.Engine - INFO - [generated in 0.00092s] ('181151262',)
2025-01-18 19:32:37,385 - root - ERROR - Ошибка проверки базы данных: HTTP Client says - ClientConnectorDNSError: Cannot connect to host api.telegram.org:443 ssl:default [getaddrinfo failed]
2025-01-18 19:32:37,386 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-3' coro=<DbProcessor.check_db() done, defined at C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py:65> exception=TelegramNetworkError('HTTP Client says - ClientConnectorDNSError: Cannot connect to host api.telegram.org:443 ssl:default [getaddrinfo failed]')>
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1335, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 989, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1020, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\resolver.py", line 38, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 867, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 962, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno 11001] getaddrinfo failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 181, in make_request
    async with session.post(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 1360, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 663, in _request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 538, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1050, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1341, in _create_direct_connection
    raise ClientConnectorDNSError(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorDNSError: Cannot connect to host api.telegram.org:443 ssl:default [getaddrinfo failed]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py", line 94, in check_db
    await send_message_subscription_expired(
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\utils\send_message.py", line 48, in send_message_subscription_expired
    await bot.send_message(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2962, in send_message
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 188, in make_request
    raise TelegramNetworkError(method=method, message=f"{type(e).__name__}: {e}")
aiogram.exceptions.TelegramNetworkError: HTTP Client says - ClientConnectorDNSError: Cannot connect to host api.telegram.org:443 ssl:default [getaddrinfo failed]
2025-01-18 19:32:37,481 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:32:37,748 - root - ERROR - Произошла ошибка при запуске бота: HTTP Client says - ClientConnectorDNSError: Cannot connect to host api.telegram.org:443 ssl:default [getaddrinfo failed]
2025-01-18 19:32:38,065 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000253D4DD18D0>
2025-01-18 19:32:59,573 - root - INFO - Инициализация бота...
2025-01-18 19:33:00,334 - root - INFO - Инициализация бота...
2025-01-18 19:33:00,428 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:33:00,428 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:33:00,429 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:33:00,431 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:33:00,431 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:33:00,432 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:33:00,481 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:33:00,481 - root - INFO - Инициализация диспетчера...
2025-01-18 19:33:00,483 - root - INFO - Регистрация обработчиков...
2025-01-18 19:33:00,485 - root - INFO - Регистрация main menu команд...
2025-01-18 19:33:01,059 - root - INFO - Команды успешно установлены
2025-01-18 19:33:01,059 - root - INFO - Запуск polling...
2025-01-18 19:33:01,060 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:33:01,078 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:33:01,086 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:33:01,087 - sqlalchemy.engine.Engine - INFO - [generated in 0.00091s] ()
2025-01-18 19:33:01,098 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:33:01,099 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] ('181151262',)
2025-01-18 19:33:04,799 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:33:04,802 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:33:04,804 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:33:04,805 - sqlalchemy.engine.Engine - INFO - [generated in 0.00095s] ('181151262',)
2025-01-18 19:33:04,923 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:33:05,407 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:33:05,409 - sqlalchemy.engine.Engine - INFO - [cached since 0.6038s ago] ('528155210',)
2025-01-18 19:33:05,412 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:33:05,413 - sqlalchemy.engine.Engine - INFO - [cached since 4.315s ago] ('528155210',)
2025-01-18 19:33:07,836 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:33:07,838 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:33:07,842 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:33:07,843 - sqlalchemy.engine.Engine - INFO - [generated in 0.00097s] ('115',)
2025-01-18 19:33:09,543 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:33:09,543 - sqlalchemy.engine.Engine - INFO - [cached since 1.702s ago] ('116',)
2025-01-18 19:33:12,194 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:33:12,195 - sqlalchemy.engine.Engine - INFO - [cached since 7.391s ago] ('528155210',)
2025-01-18 19:33:12,209 - aiogram.event - INFO - Update id=659309554 is handled. Duration 7093 ms by bot id=7444575424
2025-01-18 19:33:12,404 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:33:12,406 - sqlalchemy.engine.Engine - INFO - [cached since 7.601s ago] ('432629636',)
2025-01-18 19:33:12,410 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:33:12,411 - sqlalchemy.engine.Engine - INFO - [cached since 11.31s ago] ('432629636',)
2025-01-18 19:33:15,021 - aiogram.event - INFO - Update id=659309555 is handled. Duration 2812 ms by bot id=7444575424
2025-01-18 19:33:15,175 - aiogram.event - INFO - Update id=659309556 is handled. Duration 140 ms by bot id=7444575424
2025-01-18 19:33:15,561 - aiogram.event - INFO - Update id=659309557 is handled. Duration 421 ms by bot id=7444575424
2025-01-18 19:33:16,647 - aiogram.event - INFO - Update id=659309558 is handled. Duration 171 ms by bot id=7444575424
2025-01-18 19:33:18,014 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=5000)]
2025-01-18 19:33:18,182 - aiogram.event - INFO - Update id=659309559 is not handled. Duration 171 ms by bot id=7444575424
2025-01-18 19:33:18,183 - aiogram.event - ERROR - Cause exception while process update id=659309559 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 77, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 19:33:27,982 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:33:28,070 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [Errno 1] [SSL: APPLICATION_DATA_AFTER_CLOSE_NOTIFY] application data after close notify (_ssl.c:2702)
2025-01-18 19:33:28,071 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-18 19:33:28,247 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:33:28,253 - root - INFO - Бот остановлен вручную.
2025-01-18 19:33:28,758 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001731DC62190>
2025-01-18 19:33:28,759 - asyncio - ERROR - Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x000001731DC5D550>, 93907.421)]']
connector: <aiohttp.connector.TCPConnector object at 0x000001731DC80CD0>
2025-01-18 19:33:35,351 - root - INFO - Инициализация бота...
2025-01-18 19:33:36,620 - root - INFO - Инициализация бота...
2025-01-18 19:33:36,726 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:33:36,726 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:33:36,727 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:33:36,728 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:33:36,728 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:33:36,729 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:33:36,779 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:33:36,779 - root - INFO - Инициализация диспетчера...
2025-01-18 19:33:36,780 - root - INFO - Регистрация обработчиков...
2025-01-18 19:33:36,783 - root - INFO - Регистрация main menu команд...
2025-01-18 19:33:37,331 - root - INFO - Команды успешно установлены
2025-01-18 19:33:37,333 - root - INFO - Запуск polling...
2025-01-18 19:33:37,334 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:33:37,354 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:33:37,362 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:33:37,362 - sqlalchemy.engine.Engine - INFO - [generated in 0.00137s] ()
2025-01-18 19:33:37,377 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:33:37,378 - sqlalchemy.engine.Engine - INFO - [generated in 0.00139s] ('181151262',)
2025-01-18 19:33:40,795 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:33:40,799 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:33:40,802 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:33:40,803 - sqlalchemy.engine.Engine - INFO - [generated in 0.00097s] ('181151262',)
2025-01-18 19:33:41,184 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:33:41,558 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:33:41,558 - sqlalchemy.engine.Engine - INFO - [cached since 0.756s ago] ('528155210',)
2025-01-18 19:33:41,559 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:33:41,560 - sqlalchemy.engine.Engine - INFO - [cached since 4.184s ago] ('528155210',)
2025-01-18 19:33:43,969 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:33:43,973 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:33:43,980 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:33:43,981 - sqlalchemy.engine.Engine - INFO - [generated in 0.00236s] ('115',)
2025-01-18 19:33:46,628 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:33:46,629 - sqlalchemy.engine.Engine - INFO - [cached since 2.65s ago] ('116',)
2025-01-18 19:33:49,463 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:33:49,464 - sqlalchemy.engine.Engine - INFO - [cached since 8.662s ago] ('528155210',)
2025-01-18 19:33:49,666 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:33:49,668 - sqlalchemy.engine.Engine - INFO - [cached since 8.866s ago] ('432629636',)
2025-01-18 19:33:49,673 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:33:49,674 - sqlalchemy.engine.Engine - INFO - [cached since 12.3s ago] ('432629636',)
2025-01-18 19:33:52,701 - aiogram.event - INFO - Update id=659309560 is handled. Duration 437 ms by bot id=7444575424
2025-01-18 19:33:54,230 - aiogram.event - INFO - Update id=659309561 is handled. Duration 250 ms by bot id=7444575424
2025-01-18 19:33:54,909 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=49000)]
2025-01-18 19:33:55,210 - aiogram.event - INFO - Update id=659309562 is handled. Duration 296 ms by bot id=7444575424
2025-01-18 19:33:57,925 - aiogram.event - INFO - Update id=659309563 is handled. Duration 281 ms by bot id=7444575424
2025-01-18 19:33:59,939 - aiogram.event - INFO - Update id=659309564 is handled. Duration 671 ms by bot id=7444575424
2025-01-18 19:34:00,513 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=5000)]
2025-01-18 19:34:00,696 - aiogram.event - INFO - Update id=659309565 is not handled. Duration 171 ms by bot id=7444575424
2025-01-18 19:34:00,696 - aiogram.event - ERROR - Cause exception while process update id=659309565 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 77, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 19:34:02,306 - aiogram.event - INFO - Update id=659309566 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 19:34:03,655 - aiogram.event - INFO - Update id=659309567 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 19:34:04,454 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=27000)]
2025-01-18 19:34:04,697 - aiogram.event - INFO - Update id=659309568 is handled. Duration 233 ms by bot id=7444575424
2025-01-18 19:35:09,671 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:35:09,933 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:35:09,938 - root - INFO - Бот остановлен вручную.
2025-01-18 19:35:10,448 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001D425739F50>
2025-01-18 19:35:17,466 - root - INFO - Инициализация бота...
2025-01-18 19:35:18,293 - root - INFO - Инициализация бота...
2025-01-18 19:35:18,357 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:35:18,359 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:35:18,359 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:35:18,360 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:35:18,360 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:35:18,361 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:35:18,411 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:35:18,411 - root - INFO - Инициализация диспетчера...
2025-01-18 19:35:18,413 - root - INFO - Регистрация обработчиков...
2025-01-18 19:35:18,415 - root - INFO - Регистрация main menu команд...
2025-01-18 19:35:18,876 - root - INFO - Команды успешно установлены
2025-01-18 19:35:18,876 - root - INFO - Запуск polling...
2025-01-18 19:35:18,876 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:35:18,895 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:35:18,901 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:35:18,901 - sqlalchemy.engine.Engine - INFO - [generated in 0.00084s] ()
2025-01-18 19:35:18,912 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:35:18,912 - sqlalchemy.engine.Engine - INFO - [generated in 0.00088s] ('181151262',)
2025-01-18 19:35:20,792 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:35:20,795 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:35:20,798 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:35:20,799 - sqlalchemy.engine.Engine - INFO - [generated in 0.00098s] ('181151262',)
2025-01-18 19:35:21,094 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:35:21,337 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:35:21,338 - sqlalchemy.engine.Engine - INFO - [cached since 0.5406s ago] ('528155210',)
2025-01-18 19:35:21,341 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:35:21,342 - sqlalchemy.engine.Engine - INFO - [cached since 2.43s ago] ('528155210',)
2025-01-18 19:35:23,591 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:35:23,593 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:35:23,596 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:35:23,597 - sqlalchemy.engine.Engine - INFO - [generated in 0.00100s] ('115',)
2025-01-18 19:35:26,061 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:35:26,062 - sqlalchemy.engine.Engine - INFO - [cached since 2.466s ago] ('116',)
2025-01-18 19:35:28,330 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:35:28,331 - sqlalchemy.engine.Engine - INFO - [cached since 7.533s ago] ('528155210',)
2025-01-18 19:35:28,599 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:35:28,600 - sqlalchemy.engine.Engine - INFO - [cached since 7.802s ago] ('432629636',)
2025-01-18 19:35:28,602 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:35:28,603 - sqlalchemy.engine.Engine - INFO - [cached since 9.692s ago] ('432629636',)
2025-01-18 19:35:31,401 - aiogram.event - INFO - Update id=659309569 is handled. Duration 437 ms by bot id=7444575424
2025-01-18 19:35:32,879 - aiogram.event - INFO - Update id=659309570 is handled. Duration 422 ms by bot id=7444575424
2025-01-18 19:35:33,486 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=49000)]
2025-01-18 19:35:33,721 - aiogram.event - INFO - Update id=659309571 is handled. Duration 235 ms by bot id=7444575424
2025-01-18 19:35:35,676 - aiogram.event - INFO - Update id=659309572 is handled. Duration 171 ms by bot id=7444575424
2025-01-18 19:35:36,746 - aiogram.event - INFO - Update id=659309573 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 19:35:37,721 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=15000)]
2025-01-18 19:35:38,054 - aiogram.event - INFO - Update id=659309574 is handled. Duration 327 ms by bot id=7444575424
2025-01-18 19:35:48,019 - aiogram.event - INFO - Update id=659309575 is handled. Duration 250 ms by bot id=7444575424
2025-01-18 19:35:49,541 - aiogram.event - INFO - Update id=659309576 is handled. Duration 390 ms by bot id=7444575424
2025-01-18 19:35:50,445 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=14000)]
2025-01-18 19:35:51,079 - aiogram.event - INFO - Update id=659309577 is handled. Duration 641 ms by bot id=7444575424
2025-01-18 19:36:10,452 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:36:10,577 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [Errno 1] [SSL: APPLICATION_DATA_AFTER_CLOSE_NOTIFY] application data after close notify (_ssl.c:2702)
2025-01-18 19:36:10,578 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-18 19:36:10,709 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:36:10,715 - root - INFO - Бот остановлен вручную.
2025-01-18 19:36:11,158 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001AFCD7B2690>
2025-01-18 19:36:17,693 - root - INFO - Инициализация бота...
2025-01-18 19:36:18,388 - root - INFO - Инициализация бота...
2025-01-18 19:36:18,460 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:36:18,461 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:36:18,461 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:36:18,463 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:36:18,464 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:36:18,465 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:36:18,514 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:36:18,514 - root - INFO - Инициализация диспетчера...
2025-01-18 19:36:18,516 - root - INFO - Регистрация обработчиков...
2025-01-18 19:36:18,518 - root - INFO - Регистрация main menu команд...
2025-01-18 19:36:18,889 - root - INFO - Команды успешно установлены
2025-01-18 19:36:18,889 - root - INFO - Запуск polling...
2025-01-18 19:36:18,890 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:36:18,907 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:36:18,913 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:36:18,914 - sqlalchemy.engine.Engine - INFO - [generated in 0.00114s] ()
2025-01-18 19:36:18,925 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:36:18,925 - sqlalchemy.engine.Engine - INFO - [generated in 0.00100s] ('181151262',)
2025-01-18 19:36:22,115 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:36:22,118 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:36:22,121 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:36:22,122 - sqlalchemy.engine.Engine - INFO - [generated in 0.00110s] ('181151262',)
2025-01-18 19:36:22,207 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:36:22,719 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:36:22,720 - sqlalchemy.engine.Engine - INFO - [cached since 0.5984s ago] ('528155210',)
2025-01-18 19:36:22,723 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:36:22,723 - sqlalchemy.engine.Engine - INFO - [cached since 3.799s ago] ('528155210',)
2025-01-18 19:36:25,090 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:36:25,093 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:36:25,098 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:36:25,098 - sqlalchemy.engine.Engine - INFO - [generated in 0.00122s] ('115',)
2025-01-18 19:36:28,171 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:36:28,172 - sqlalchemy.engine.Engine - INFO - [cached since 3.074s ago] ('116',)
2025-01-18 19:36:30,367 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:36:30,368 - sqlalchemy.engine.Engine - INFO - [cached since 8.246s ago] ('528155210',)
2025-01-18 19:36:30,620 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:36:30,621 - sqlalchemy.engine.Engine - INFO - [cached since 8.5s ago] ('432629636',)
2025-01-18 19:36:30,625 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:36:30,626 - sqlalchemy.engine.Engine - INFO - [cached since 11.7s ago] ('432629636',)
2025-01-18 19:36:43,321 - aiogram.event - INFO - Update id=659309578 is handled. Duration 546 ms by bot id=7444575424
2025-01-18 19:36:44,530 - aiogram.event - INFO - Update id=659309579 is handled. Duration 281 ms by bot id=7444575424
2025-01-18 19:36:45,550 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=9000)]
2025-01-18 19:36:46,222 - aiogram.event - INFO - Update id=659309580 is handled. Duration 672 ms by bot id=7444575424
2025-01-18 19:36:56,282 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:36:56,545 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:36:56,549 - root - INFO - Бот остановлен вручную.
2025-01-18 19:36:56,969 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001BFA0B39110>
2025-01-18 19:37:03,237 - root - INFO - Инициализация бота...
2025-01-18 19:37:04,062 - root - INFO - Инициализация бота...
2025-01-18 19:37:04,115 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:37:04,115 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:37:04,116 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:37:04,117 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:37:04,117 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:37:04,118 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:37:04,148 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:37:04,148 - root - INFO - Инициализация диспетчера...
2025-01-18 19:37:04,149 - root - INFO - Регистрация обработчиков...
2025-01-18 19:37:04,150 - root - INFO - Регистрация main menu команд...
2025-01-18 19:37:04,645 - root - INFO - Команды успешно установлены
2025-01-18 19:37:04,646 - root - INFO - Запуск polling...
2025-01-18 19:37:04,647 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:37:04,670 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:37:04,678 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:37:04,679 - sqlalchemy.engine.Engine - INFO - [generated in 0.00092s] ()
2025-01-18 19:37:04,690 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:37:04,691 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] ('181151262',)
2025-01-18 19:37:08,937 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:37:08,939 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:37:08,942 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:37:08,943 - sqlalchemy.engine.Engine - INFO - [generated in 0.00090s] ('181151262',)
2025-01-18 19:37:09,029 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:37:09,388 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:37:09,389 - sqlalchemy.engine.Engine - INFO - [cached since 0.4471s ago] ('528155210',)
2025-01-18 19:37:09,391 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:37:09,392 - sqlalchemy.engine.Engine - INFO - [cached since 4.702s ago] ('528155210',)
2025-01-18 19:37:12,043 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:37:12,046 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:37:12,050 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:37:12,050 - sqlalchemy.engine.Engine - INFO - [generated in 0.00102s] ('115',)
2025-01-18 19:37:14,872 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:37:14,872 - sqlalchemy.engine.Engine - INFO - [cached since 2.823s ago] ('116',)
2025-01-18 19:37:18,324 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:37:18,324 - sqlalchemy.engine.Engine - INFO - [cached since 9.382s ago] ('528155210',)
2025-01-18 19:37:18,464 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:37:18,466 - sqlalchemy.engine.Engine - INFO - [cached since 9.523s ago] ('432629636',)
2025-01-18 19:37:18,469 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:37:18,470 - sqlalchemy.engine.Engine - INFO - [cached since 13.78s ago] ('432629636',)
2025-01-18 19:37:24,172 - aiogram.event - INFO - Update id=659309581 is handled. Duration 718 ms by bot id=7444575424
2025-01-18 19:37:25,562 - aiogram.event - INFO - Update id=659309582 is handled. Duration 250 ms by bot id=7444575424
2025-01-18 19:37:26,728 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=4000)]
2025-01-18 19:37:27,198 - aiogram.event - INFO - Update id=659309583 is not handled. Duration 467 ms by bot id=7444575424
2025-01-18 19:37:27,198 - aiogram.event - ERROR - Cause exception while process update id=659309583 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 77, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 19:37:35,199 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:37:35,454 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:37:35,462 - root - INFO - Бот остановлен вручную.
2025-01-18 19:37:35,997 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001D3080629D0>
2025-01-18 19:37:35,999 - asyncio - ERROR - Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x000001D310249550>, 94153.484)]']
connector: <aiohttp.connector.TCPConnector object at 0x000001D30C766B90>
2025-01-18 19:37:42,991 - root - INFO - Инициализация бота...
2025-01-18 19:37:43,789 - root - INFO - Инициализация бота...
2025-01-18 19:37:43,840 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:37:43,841 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:37:43,841 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:37:43,842 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:37:43,843 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:37:43,844 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:37:43,885 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:37:43,886 - root - INFO - Инициализация диспетчера...
2025-01-18 19:37:43,887 - root - INFO - Регистрация обработчиков...
2025-01-18 19:37:43,889 - root - INFO - Регистрация main menu команд...
2025-01-18 19:37:44,270 - root - INFO - Команды успешно установлены
2025-01-18 19:37:44,271 - root - INFO - Запуск polling...
2025-01-18 19:37:44,272 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:37:44,288 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:37:44,295 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:37:44,295 - sqlalchemy.engine.Engine - INFO - [generated in 0.00087s] ()
2025-01-18 19:37:44,305 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:37:44,306 - sqlalchemy.engine.Engine - INFO - [generated in 0.00109s] ('181151262',)
2025-01-18 19:37:46,637 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:37:46,640 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:37:46,644 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:37:46,645 - sqlalchemy.engine.Engine - INFO - [generated in 0.00106s] ('181151262',)
2025-01-18 19:37:46,827 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:37:47,169 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:37:47,171 - sqlalchemy.engine.Engine - INFO - [cached since 0.527s ago] ('528155210',)
2025-01-18 19:37:47,176 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:37:47,177 - sqlalchemy.engine.Engine - INFO - [cached since 2.872s ago] ('528155210',)
2025-01-18 19:37:49,316 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:37:49,318 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:37:49,322 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:37:49,322 - sqlalchemy.engine.Engine - INFO - [generated in 0.00095s] ('115',)
2025-01-18 19:37:51,792 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:37:51,793 - sqlalchemy.engine.Engine - INFO - [cached since 2.472s ago] ('116',)
2025-01-18 19:37:53,595 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:37:53,596 - sqlalchemy.engine.Engine - INFO - [cached since 6.952s ago] ('528155210',)
2025-01-18 19:37:53,776 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:37:53,776 - sqlalchemy.engine.Engine - INFO - [cached since 7.132s ago] ('432629636',)
2025-01-18 19:37:53,779 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:37:53,780 - sqlalchemy.engine.Engine - INFO - [cached since 9.475s ago] ('432629636',)
2025-01-18 19:37:56,968 - aiogram.event - INFO - Update id=659309584 is handled. Duration 593 ms by bot id=7444575424
2025-01-18 19:37:57,919 - aiogram.event - INFO - Update id=659309585 is handled. Duration 235 ms by bot id=7444575424
2025-01-18 19:37:59,058 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=6000)]
2025-01-18 19:37:59,357 - aiogram.event - INFO - Update id=659309586 is handled. Duration 312 ms by bot id=7444575424
2025-01-18 19:38:05,806 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:38:06,070 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:38:06,075 - root - INFO - Бот остановлен вручную.
2025-01-18 19:38:06,418 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001D9ACD7C410>
2025-01-18 19:38:06,419 - asyncio - ERROR - Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x000001D9B085D550>, 94188.796)]']
connector: <aiohttp.connector.TCPConnector object at 0x000001D9A95D5DD0>
2025-01-18 19:38:12,738 - root - INFO - Инициализация бота...
2025-01-18 19:38:13,496 - root - INFO - Инициализация бота...
2025-01-18 19:38:13,565 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:38:13,565 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:38:13,566 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:38:13,567 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:38:13,568 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:38:13,569 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:38:13,631 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:38:13,631 - root - INFO - Инициализация диспетчера...
2025-01-18 19:38:13,633 - root - INFO - Регистрация обработчиков...
2025-01-18 19:38:13,636 - root - INFO - Регистрация main menu команд...
2025-01-18 19:38:14,324 - root - INFO - Команды успешно установлены
2025-01-18 19:38:14,325 - root - INFO - Запуск polling...
2025-01-18 19:38:14,325 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:38:14,341 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:38:14,347 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:38:14,348 - sqlalchemy.engine.Engine - INFO - [generated in 0.00081s] ()
2025-01-18 19:38:14,358 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:38:14,359 - sqlalchemy.engine.Engine - INFO - [generated in 0.00089s] ('181151262',)
2025-01-18 19:38:17,531 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:38:17,534 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:38:17,537 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:38:17,537 - sqlalchemy.engine.Engine - INFO - [generated in 0.00096s] ('181151262',)
2025-01-18 19:38:17,630 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:38:18,055 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:38:18,055 - sqlalchemy.engine.Engine - INFO - [cached since 0.5189s ago] ('528155210',)
2025-01-18 19:38:18,059 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:38:18,059 - sqlalchemy.engine.Engine - INFO - [cached since 3.701s ago] ('528155210',)
2025-01-18 19:38:20,767 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:38:20,770 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:38:20,774 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:38:20,775 - sqlalchemy.engine.Engine - INFO - [generated in 0.00108s] ('115',)
2025-01-18 19:38:23,006 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:38:23,007 - sqlalchemy.engine.Engine - INFO - [cached since 2.234s ago] ('116',)
2025-01-18 19:38:25,607 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:38:25,608 - sqlalchemy.engine.Engine - INFO - [cached since 8.072s ago] ('528155210',)
2025-01-18 19:38:25,822 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:38:25,823 - sqlalchemy.engine.Engine - INFO - [cached since 8.287s ago] ('432629636',)
2025-01-18 19:38:25,826 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:38:25,827 - sqlalchemy.engine.Engine - INFO - [cached since 11.47s ago] ('432629636',)
2025-01-18 19:38:28,824 - aiogram.event - INFO - Update id=659309587 is handled. Duration 500 ms by bot id=7444575424
2025-01-18 19:38:30,038 - aiogram.event - INFO - Update id=659309588 is handled. Duration 219 ms by bot id=7444575424
2025-01-18 19:38:31,152 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=5000)]
2025-01-18 19:38:31,372 - aiogram.event - INFO - Update id=659309589 is not handled. Duration 235 ms by bot id=7444575424
2025-01-18 19:38:31,373 - aiogram.event - ERROR - Cause exception while process update id=659309589 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 77, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 19:39:20,325 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:39:20,589 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:39:20,594 - root - INFO - Бот остановлен вручную.
2025-01-18 19:39:21,011 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002D465776790>
2025-01-18 19:39:27,385 - root - INFO - Инициализация бота...
2025-01-18 19:39:28,162 - root - INFO - Инициализация бота...
2025-01-18 19:39:28,215 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:39:28,216 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:39:28,216 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:39:28,217 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:39:28,217 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:39:28,218 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:39:28,267 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:39:28,268 - root - INFO - Инициализация диспетчера...
2025-01-18 19:39:28,269 - root - INFO - Регистрация обработчиков...
2025-01-18 19:39:28,271 - root - INFO - Регистрация main menu команд...
2025-01-18 19:39:28,748 - root - INFO - Команды успешно установлены
2025-01-18 19:39:28,749 - root - INFO - Запуск polling...
2025-01-18 19:39:28,750 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:39:28,768 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:39:28,776 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:39:28,776 - sqlalchemy.engine.Engine - INFO - [generated in 0.00090s] ()
2025-01-18 19:39:28,788 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:39:28,788 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] ('181151262',)
2025-01-18 19:39:32,021 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:39:32,024 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:39:32,027 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:39:32,028 - sqlalchemy.engine.Engine - INFO - [generated in 0.00104s] ('181151262',)
2025-01-18 19:39:32,108 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:39:32,520 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:39:32,521 - sqlalchemy.engine.Engine - INFO - [cached since 0.4951s ago] ('528155210',)
2025-01-18 19:39:32,524 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:39:32,524 - sqlalchemy.engine.Engine - INFO - [cached since 3.737s ago] ('528155210',)
2025-01-18 19:39:34,108 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:39:34,111 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:39:34,114 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:39:34,115 - sqlalchemy.engine.Engine - INFO - [generated in 0.00098s] ('115',)
2025-01-18 19:39:36,120 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:39:36,120 - sqlalchemy.engine.Engine - INFO - [cached since 2.007s ago] ('116',)
2025-01-18 19:39:38,505 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:39:38,506 - sqlalchemy.engine.Engine - INFO - [cached since 6.479s ago] ('528155210',)
2025-01-18 19:39:38,646 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:39:38,647 - sqlalchemy.engine.Engine - INFO - [cached since 6.62s ago] ('432629636',)
2025-01-18 19:39:38,650 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:39:38,650 - sqlalchemy.engine.Engine - INFO - [cached since 9.863s ago] ('432629636',)
2025-01-18 19:39:41,740 - aiogram.event - INFO - Update id=659309590 is handled. Duration 483 ms by bot id=7444575424
2025-01-18 19:39:43,155 - aiogram.event - INFO - Update id=659309591 is handled. Duration 328 ms by bot id=7444575424
2025-01-18 19:39:44,042 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=5000)]
2025-01-18 19:39:44,278 - aiogram.event - INFO - Update id=659309592 is not handled. Duration 250 ms by bot id=7444575424
2025-01-18 19:39:44,278 - aiogram.event - ERROR - Cause exception while process update id=659309592 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 77, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 19:41:20,298 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:41:20,556 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:41:20,561 - root - INFO - Бот остановлен вручную.
2025-01-18 19:41:21,091 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002B6EEEC7890>
2025-01-18 19:41:30,540 - root - INFO - Инициализация бота...
2025-01-18 19:41:31,337 - root - INFO - Инициализация бота...
2025-01-18 19:41:31,400 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:41:31,400 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:41:31,400 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:41:31,402 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:41:31,402 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:41:31,402 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:41:31,434 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:41:31,434 - root - INFO - Инициализация диспетчера...
2025-01-18 19:41:31,435 - root - INFO - Регистрация обработчиков...
2025-01-18 19:41:31,436 - root - INFO - Регистрация main menu команд...
2025-01-18 19:41:31,882 - root - INFO - Команды успешно установлены
2025-01-18 19:41:31,883 - root - INFO - Запуск polling...
2025-01-18 19:41:31,884 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:41:31,901 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:41:31,908 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:41:31,909 - sqlalchemy.engine.Engine - INFO - [generated in 0.00090s] ()
2025-01-18 19:41:31,919 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:41:31,920 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] ('181151262',)
2025-01-18 19:41:34,393 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:41:34,395 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:41:34,398 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:41:34,399 - sqlalchemy.engine.Engine - INFO - [generated in 0.00099s] ('181151262',)
2025-01-18 19:41:34,479 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:41:34,921 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:41:34,923 - sqlalchemy.engine.Engine - INFO - [cached since 0.5243s ago] ('528155210',)
2025-01-18 19:41:34,924 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:41:34,925 - sqlalchemy.engine.Engine - INFO - [cached since 3.006s ago] ('528155210',)
2025-01-18 19:41:37,513 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:41:37,516 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:41:37,519 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:41:37,520 - sqlalchemy.engine.Engine - INFO - [generated in 0.00130s] ('115',)
2025-01-18 19:41:40,539 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:41:40,541 - sqlalchemy.engine.Engine - INFO - [cached since 3.021s ago] ('116',)
2025-01-18 19:41:43,028 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:41:43,029 - sqlalchemy.engine.Engine - INFO - [cached since 8.63s ago] ('528155210',)
2025-01-18 19:41:43,198 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:41:43,198 - sqlalchemy.engine.Engine - INFO - [cached since 8.8s ago] ('432629636',)
2025-01-18 19:41:43,200 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:41:43,200 - sqlalchemy.engine.Engine - INFO - [cached since 11.28s ago] ('432629636',)
2025-01-18 19:41:45,681 - aiogram.event - INFO - Update id=659309593 is handled. Duration 625 ms by bot id=7444575424
2025-01-18 19:41:46,888 - aiogram.event - INFO - Update id=659309594 is handled. Duration 328 ms by bot id=7444575424
2025-01-18 19:41:48,065 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=3000)]
2025-01-18 19:41:48,297 - aiogram.event - INFO - Update id=659309595 is not handled. Duration 235 ms by bot id=7444575424
2025-01-18 19:41:48,298 - aiogram.event - ERROR - Cause exception while process update id=659309595 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 77, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 19:46:24,384 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:46:24,641 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:46:24,648 - root - INFO - Бот остановлен вручную.
2025-01-18 19:46:25,207 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000023D6FDA6F50>
2025-01-18 19:46:31,486 - root - INFO - Инициализация бота...
2025-01-18 19:46:32,318 - root - INFO - Инициализация бота...
2025-01-18 19:46:32,395 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:46:32,395 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:46:32,396 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:46:32,397 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:46:32,398 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:46:32,399 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:46:32,456 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:46:32,457 - root - INFO - Инициализация диспетчера...
2025-01-18 19:46:32,458 - root - INFO - Регистрация обработчиков...
2025-01-18 19:46:32,461 - root - INFO - Регистрация main menu команд...
2025-01-18 19:46:32,918 - root - INFO - Команды успешно установлены
2025-01-18 19:46:32,918 - root - INFO - Запуск polling...
2025-01-18 19:46:32,919 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:46:32,935 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:46:32,942 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:46:32,943 - sqlalchemy.engine.Engine - INFO - [generated in 0.00107s] ()
2025-01-18 19:46:32,953 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:46:32,953 - sqlalchemy.engine.Engine - INFO - [generated in 0.00087s] ('181151262',)
2025-01-18 19:46:35,446 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:46:35,448 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:46:35,451 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:46:35,451 - sqlalchemy.engine.Engine - INFO - [generated in 0.00106s] ('181151262',)
2025-01-18 19:46:35,525 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:46:35,951 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:46:35,952 - sqlalchemy.engine.Engine - INFO - [cached since 0.5017s ago] ('528155210',)
2025-01-18 19:46:35,955 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:46:35,956 - sqlalchemy.engine.Engine - INFO - [cached since 3.004s ago] ('528155210',)
2025-01-18 19:46:38,930 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:46:38,932 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:46:38,935 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:46:38,936 - sqlalchemy.engine.Engine - INFO - [generated in 0.00097s] ('115',)
2025-01-18 19:46:41,385 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:46:41,387 - sqlalchemy.engine.Engine - INFO - [cached since 2.452s ago] ('116',)
2025-01-18 19:46:43,844 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:46:43,845 - sqlalchemy.engine.Engine - INFO - [cached since 8.394s ago] ('528155210',)
2025-01-18 19:46:44,011 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:46:44,012 - sqlalchemy.engine.Engine - INFO - [cached since 8.561s ago] ('432629636',)
2025-01-18 19:46:44,017 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:46:44,018 - sqlalchemy.engine.Engine - INFO - [cached since 11.06s ago] ('432629636',)
2025-01-18 19:46:55,519 - aiogram.event - INFO - Update id=659309596 is handled. Duration 625 ms by bot id=7444575424
2025-01-18 19:46:56,746 - aiogram.event - INFO - Update id=659309597 is handled. Duration 360 ms by bot id=7444575424
2025-01-18 19:46:57,594 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=6000)]
2025-01-18 19:46:58,196 - aiogram.event - INFO - Update id=659309598 is handled. Duration 592 ms by bot id=7444575424
2025-01-18 19:47:04,483 - aiogram.event - INFO - Update id=659309599 is handled. Duration 422 ms by bot id=7444575424
2025-01-18 19:47:06,097 - aiogram.event - INFO - Update id=659309600 is handled. Duration 172 ms by bot id=7444575424
2025-01-18 19:47:07,244 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=6000)]
2025-01-18 19:47:07,571 - aiogram.event - INFO - Update id=659309601 is handled. Duration 327 ms by bot id=7444575424
2025-01-18 19:47:13,017 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:47:13,278 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:47:13,282 - root - INFO - Бот остановлен вручную.
2025-01-18 19:47:13,585 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002680EE21C50>
2025-01-18 19:47:19,699 - root - INFO - Инициализация бота...
2025-01-18 19:47:20,516 - root - INFO - Инициализация бота...
2025-01-18 19:47:20,607 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:47:20,607 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:47:20,607 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:47:20,609 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:47:20,611 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:47:20,611 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:47:20,669 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:47:20,669 - root - INFO - Инициализация диспетчера...
2025-01-18 19:47:20,670 - root - INFO - Регистрация обработчиков...
2025-01-18 19:47:20,673 - root - INFO - Регистрация main menu команд...
2025-01-18 19:47:21,066 - root - INFO - Команды успешно установлены
2025-01-18 19:47:21,066 - root - INFO - Запуск polling...
2025-01-18 19:47:21,067 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:47:21,082 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:47:21,088 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:47:21,088 - sqlalchemy.engine.Engine - INFO - [generated in 0.00079s] ()
2025-01-18 19:47:21,098 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:47:21,099 - sqlalchemy.engine.Engine - INFO - [generated in 0.00096s] ('181151262',)
2025-01-18 19:47:23,401 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:47:23,404 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:47:23,406 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:47:23,407 - sqlalchemy.engine.Engine - INFO - [generated in 0.00093s] ('181151262',)
2025-01-18 19:47:23,524 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:47:23,870 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:47:23,872 - sqlalchemy.engine.Engine - INFO - [cached since 0.465s ago] ('528155210',)
2025-01-18 19:47:23,876 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:47:23,877 - sqlalchemy.engine.Engine - INFO - [cached since 2.779s ago] ('528155210',)
2025-01-18 19:47:26,207 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:47:26,210 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:47:26,213 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:47:26,214 - sqlalchemy.engine.Engine - INFO - [generated in 0.00106s] ('115',)
2025-01-18 19:47:28,697 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:47:28,697 - sqlalchemy.engine.Engine - INFO - [cached since 2.484s ago] ('116',)
2025-01-18 19:47:31,263 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:47:31,264 - sqlalchemy.engine.Engine - INFO - [cached since 7.857s ago] ('528155210',)
2025-01-18 19:47:31,407 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:47:31,408 - sqlalchemy.engine.Engine - INFO - [cached since 8.001s ago] ('432629636',)
2025-01-18 19:47:31,410 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:47:31,411 - sqlalchemy.engine.Engine - INFO - [cached since 10.31s ago] ('432629636',)
2025-01-18 19:47:50,160 - aiogram.event - INFO - Update id=659309602 is handled. Duration 516 ms by bot id=7444575424
2025-01-18 19:47:51,240 - aiogram.event - INFO - Update id=659309603 is handled. Duration 139 ms by bot id=7444575424
2025-01-18 19:47:52,016 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=5000)]
2025-01-18 19:47:52,182 - aiogram.event - INFO - Update id=659309604 is not handled. Duration 171 ms by bot id=7444575424
2025-01-18 19:47:52,183 - aiogram.event - ERROR - Cause exception while process update id=659309604 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 77, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 19:47:53,631 - aiogram.event - INFO - Update id=659309605 is handled. Duration 266 ms by bot id=7444575424
2025-01-18 19:47:55,130 - aiogram.event - INFO - Update id=659309606 is handled. Duration 218 ms by bot id=7444575424
2025-01-18 19:47:55,786 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=5000)]
2025-01-18 19:47:56,003 - aiogram.event - INFO - Update id=659309607 is not handled. Duration 218 ms by bot id=7444575424
2025-01-18 19:47:56,004 - aiogram.event - ERROR - Cause exception while process update id=659309607 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 77, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 19:48:01,491 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:48:01,741 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:48:01,746 - root - INFO - Бот остановлен вручную.
2025-01-18 19:48:02,264 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002077D157050>
2025-01-18 19:48:08,793 - root - INFO - Инициализация бота...
2025-01-18 19:48:09,631 - root - INFO - Инициализация бота...
2025-01-18 19:48:09,726 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:48:09,726 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:48:09,726 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:48:09,728 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:48:09,728 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:48:09,729 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:48:09,787 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:48:09,788 - root - INFO - Инициализация диспетчера...
2025-01-18 19:48:09,789 - root - INFO - Регистрация обработчиков...
2025-01-18 19:48:09,791 - root - INFO - Регистрация main menu команд...
2025-01-18 19:48:10,166 - root - INFO - Команды успешно установлены
2025-01-18 19:48:10,167 - root - INFO - Запуск polling...
2025-01-18 19:48:10,168 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:48:10,184 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:48:10,190 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:48:10,191 - sqlalchemy.engine.Engine - INFO - [generated in 0.00103s] ()
2025-01-18 19:48:10,200 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:48:10,201 - sqlalchemy.engine.Engine - INFO - [generated in 0.00086s] ('181151262',)
2025-01-18 19:48:12,420 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:48:12,423 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:48:12,426 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:48:12,426 - sqlalchemy.engine.Engine - INFO - [generated in 0.00091s] ('181151262',)
2025-01-18 19:48:12,506 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:48:12,733 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:48:12,735 - sqlalchemy.engine.Engine - INFO - [cached since 0.3089s ago] ('528155210',)
2025-01-18 19:48:12,737 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:48:12,738 - sqlalchemy.engine.Engine - INFO - [cached since 2.537s ago] ('528155210',)
2025-01-18 19:48:15,490 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:48:15,493 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:48:15,496 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:48:15,497 - sqlalchemy.engine.Engine - INFO - [generated in 0.00104s] ('115',)
2025-01-18 19:48:17,652 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:48:17,653 - sqlalchemy.engine.Engine - INFO - [cached since 2.157s ago] ('116',)
2025-01-18 19:48:19,332 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:48:19,333 - sqlalchemy.engine.Engine - INFO - [cached since 6.907s ago] ('528155210',)
2025-01-18 19:48:19,517 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:48:19,518 - sqlalchemy.engine.Engine - INFO - [cached since 7.093s ago] ('432629636',)
2025-01-18 19:48:19,520 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:48:19,521 - sqlalchemy.engine.Engine - INFO - [cached since 9.321s ago] ('432629636',)
2025-01-18 19:48:22,528 - aiogram.event - INFO - Update id=659309608 is handled. Duration 9875 ms by bot id=7444575424
2025-01-18 19:48:22,939 - aiogram.event - INFO - Update id=659309609 is handled. Duration 405 ms by bot id=7444575424
2025-01-18 19:48:23,838 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=3000)]
2025-01-18 19:48:24,047 - aiogram.event - INFO - Update id=659309610 is not handled. Duration 218 ms by bot id=7444575424
2025-01-18 19:48:24,048 - aiogram.event - ERROR - Cause exception while process update id=659309610 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 77, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 19:48:33,503 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:48:33,760 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:48:33,765 - root - INFO - Бот остановлен вручную.
2025-01-18 19:48:34,260 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002613D11F7D0>
2025-01-18 19:48:34,260 - asyncio - ERROR - Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x0000026140BFD6A0>, 94814.546)]']
connector: <aiohttp.connector.TCPConnector object at 0x00000261409D2B90>
2025-01-18 19:48:40,408 - root - INFO - Инициализация бота...
2025-01-18 19:48:41,052 - root - INFO - Инициализация бота...
2025-01-18 19:48:41,136 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:48:41,137 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:48:41,137 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:48:41,138 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:48:41,138 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:48:41,139 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:48:41,179 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:48:41,179 - root - INFO - Инициализация диспетчера...
2025-01-18 19:48:41,180 - root - INFO - Регистрация обработчиков...
2025-01-18 19:48:41,183 - root - INFO - Регистрация main menu команд...
2025-01-18 19:48:41,693 - root - INFO - Команды успешно установлены
2025-01-18 19:48:41,694 - root - INFO - Запуск polling...
2025-01-18 19:48:41,694 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:48:41,714 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:48:41,720 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:48:41,721 - sqlalchemy.engine.Engine - INFO - [generated in 0.00118s] ()
2025-01-18 19:48:41,731 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:48:41,733 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] ('181151262',)
2025-01-18 19:48:43,876 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:48:43,879 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:48:43,882 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:48:43,883 - sqlalchemy.engine.Engine - INFO - [generated in 0.00095s] ('181151262',)
2025-01-18 19:48:43,969 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:48:44,277 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:48:44,277 - sqlalchemy.engine.Engine - INFO - [cached since 0.396s ago] ('528155210',)
2025-01-18 19:48:44,280 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:48:44,280 - sqlalchemy.engine.Engine - INFO - [cached since 2.549s ago] ('528155210',)
2025-01-18 19:48:45,876 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:48:45,878 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:48:45,881 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:48:45,882 - sqlalchemy.engine.Engine - INFO - [generated in 0.00096s] ('115',)
2025-01-18 19:48:47,935 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:48:47,936 - sqlalchemy.engine.Engine - INFO - [cached since 2.055s ago] ('116',)
2025-01-18 19:48:50,306 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:48:50,307 - sqlalchemy.engine.Engine - INFO - [cached since 6.426s ago] ('528155210',)
2025-01-18 19:48:50,497 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:48:50,497 - sqlalchemy.engine.Engine - INFO - [cached since 6.615s ago] ('432629636',)
2025-01-18 19:48:50,501 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:48:50,501 - sqlalchemy.engine.Engine - INFO - [cached since 8.769s ago] ('432629636',)
2025-01-18 19:48:54,426 - aiogram.event - INFO - Update id=659309611 is handled. Duration 1485 ms by bot id=7444575424
2025-01-18 19:48:55,637 - aiogram.event - INFO - Update id=659309612 is handled. Duration 171 ms by bot id=7444575424
2025-01-18 19:48:56,471 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=5100)]
2025-01-18 19:48:56,657 - aiogram.event - INFO - Update id=659309613 is not handled. Duration 187 ms by bot id=7444575424
2025-01-18 19:48:56,657 - aiogram.event - ERROR - Cause exception while process update id=659309613 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 77, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 19:49:03,228 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:49:03,502 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:49:03,510 - root - INFO - Бот остановлен вручную.
2025-01-18 19:49:03,930 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002C05F0DFB90>
2025-01-18 19:49:03,930 - asyncio - ERROR - Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x000002C06632D6A0>, 94845.515)]']
connector: <aiohttp.connector.TCPConnector object at 0x000002C05F0DF150>
2025-01-18 19:49:10,583 - root - INFO - Инициализация бота...
2025-01-18 19:49:11,290 - root - INFO - Инициализация бота...
2025-01-18 19:49:11,357 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:49:11,358 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:49:11,358 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:49:11,359 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:49:11,359 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:49:11,360 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:49:11,396 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:49:11,396 - root - INFO - Инициализация диспетчера...
2025-01-18 19:49:11,397 - root - INFO - Регистрация обработчиков...
2025-01-18 19:49:11,399 - root - INFO - Регистрация main menu команд...
2025-01-18 19:49:11,818 - root - INFO - Команды успешно установлены
2025-01-18 19:49:11,819 - root - INFO - Запуск polling...
2025-01-18 19:49:11,819 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:49:11,837 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:49:11,844 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:49:11,845 - sqlalchemy.engine.Engine - INFO - [generated in 0.00096s] ()
2025-01-18 19:49:11,855 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:49:11,857 - sqlalchemy.engine.Engine - INFO - [generated in 0.00194s] ('181151262',)
2025-01-18 19:49:14,108 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:49:14,110 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:49:14,113 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:49:14,114 - sqlalchemy.engine.Engine - INFO - [generated in 0.00108s] ('181151262',)
2025-01-18 19:49:14,197 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:49:14,605 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:49:14,606 - sqlalchemy.engine.Engine - INFO - [cached since 0.4928s ago] ('528155210',)
2025-01-18 19:49:14,609 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:49:14,609 - sqlalchemy.engine.Engine - INFO - [cached since 2.755s ago] ('528155210',)
2025-01-18 19:49:16,343 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:49:16,346 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:49:16,349 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:49:16,349 - sqlalchemy.engine.Engine - INFO - [generated in 0.00096s] ('115',)
2025-01-18 19:49:18,388 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:49:18,389 - sqlalchemy.engine.Engine - INFO - [cached since 2.041s ago] ('116',)
2025-01-18 19:49:20,925 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:49:20,925 - sqlalchemy.engine.Engine - INFO - [cached since 6.812s ago] ('528155210',)
2025-01-18 19:49:21,089 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:49:21,090 - sqlalchemy.engine.Engine - INFO - [cached since 6.977s ago] ('432629636',)
2025-01-18 19:49:21,093 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:49:21,093 - sqlalchemy.engine.Engine - INFO - [cached since 9.239s ago] ('432629636',)
2025-01-18 19:49:27,774 - aiogram.event - INFO - Update id=659309614 is handled. Duration 406 ms by bot id=7444575424
2025-01-18 19:49:28,710 - aiogram.event - INFO - Update id=659309615 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 19:49:29,514 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=5500)]
2025-01-18 19:49:29,670 - aiogram.event - INFO - Update id=659309616 is not handled. Duration 156 ms by bot id=7444575424
2025-01-18 19:49:29,671 - aiogram.event - ERROR - Cause exception while process update id=659309616 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 77, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 19:51:08,234 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:51:08,496 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:51:08,502 - root - INFO - Бот остановлен вручную.
2025-01-18 19:51:08,999 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002268AE0FAD0>
2025-01-18 19:51:16,208 - root - INFO - Инициализация бота...
2025-01-18 19:51:17,164 - root - INFO - Инициализация бота...
2025-01-18 19:51:17,218 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:51:17,218 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:51:17,218 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:51:17,219 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:51:17,219 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:51:17,220 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:51:17,258 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:51:17,258 - root - INFO - Инициализация диспетчера...
2025-01-18 19:51:17,259 - root - INFO - Регистрация обработчиков...
2025-01-18 19:51:17,261 - root - INFO - Регистрация main menu команд...
2025-01-18 19:51:17,767 - root - INFO - Команды успешно установлены
2025-01-18 19:51:17,767 - root - INFO - Запуск polling...
2025-01-18 19:51:17,768 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:51:17,785 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:51:17,791 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:51:17,792 - sqlalchemy.engine.Engine - INFO - [generated in 0.00079s] ()
2025-01-18 19:51:17,801 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:51:17,802 - sqlalchemy.engine.Engine - INFO - [generated in 0.00087s] ('181151262',)
2025-01-18 19:51:20,065 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:51:20,068 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:51:20,072 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:51:20,073 - sqlalchemy.engine.Engine - INFO - [generated in 0.00104s] ('181151262',)
2025-01-18 19:51:20,163 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:51:20,498 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:51:20,498 - sqlalchemy.engine.Engine - INFO - [cached since 0.4259s ago] ('528155210',)
2025-01-18 19:51:20,500 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:51:20,500 - sqlalchemy.engine.Engine - INFO - [cached since 2.699s ago] ('528155210',)
2025-01-18 19:51:23,092 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:51:23,093 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:51:23,094 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:51:23,095 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] ('115',)
2025-01-18 19:51:24,776 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:51:24,777 - sqlalchemy.engine.Engine - INFO - [cached since 1.683s ago] ('116',)
2025-01-18 19:51:27,232 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:51:27,232 - sqlalchemy.engine.Engine - INFO - [cached since 7.16s ago] ('528155210',)
2025-01-18 19:51:27,408 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:51:27,409 - sqlalchemy.engine.Engine - INFO - [cached since 7.337s ago] ('432629636',)
2025-01-18 19:51:27,411 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:51:27,411 - sqlalchemy.engine.Engine - INFO - [cached since 9.61s ago] ('432629636',)
2025-01-18 19:51:34,484 - aiogram.event - INFO - Update id=659309617 is handled. Duration 375 ms by bot id=7444575424
2025-01-18 19:51:35,461 - aiogram.event - INFO - Update id=659309618 is handled. Duration 218 ms by bot id=7444575424
2025-01-18 19:51:36,229 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=5900)]
2025-01-18 19:51:36,495 - aiogram.event - INFO - Update id=659309619 is not handled. Duration 281 ms by bot id=7444575424
2025-01-18 19:51:36,496 - aiogram.event - ERROR - Cause exception while process update id=659309619 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 77, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 19:51:43,792 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:51:44,046 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:51:44,053 - root - INFO - Бот остановлен вручную.
2025-01-18 19:51:44,405 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002DA65F4F790>
2025-01-18 19:51:44,407 - asyncio - ERROR - Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x000002DA6D19D6A0>, 95002.437)]']
connector: <aiohttp.connector.TCPConnector object at 0x000002DA65F4FF90>
2025-01-18 19:51:51,994 - root - INFO - Инициализация бота...
2025-01-18 19:51:52,781 - root - INFO - Инициализация бота...
2025-01-18 19:51:52,842 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:51:52,842 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:51:52,843 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:51:52,844 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:51:52,844 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:51:52,845 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:51:52,885 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:51:52,885 - root - INFO - Инициализация диспетчера...
2025-01-18 19:51:52,886 - root - INFO - Регистрация обработчиков...
2025-01-18 19:51:52,888 - root - INFO - Регистрация main menu команд...
2025-01-18 19:51:53,373 - root - INFO - Команды успешно установлены
2025-01-18 19:51:53,373 - root - INFO - Запуск polling...
2025-01-18 19:51:53,374 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:51:53,391 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:51:53,397 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:51:53,399 - sqlalchemy.engine.Engine - INFO - [generated in 0.00087s] ()
2025-01-18 19:51:53,408 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:51:53,409 - sqlalchemy.engine.Engine - INFO - [generated in 0.00089s] ('181151262',)
2025-01-18 19:51:55,353 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:51:55,355 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:51:55,359 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:51:55,360 - sqlalchemy.engine.Engine - INFO - [generated in 0.00146s] ('181151262',)
2025-01-18 19:51:55,438 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:51:55,816 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:51:55,817 - sqlalchemy.engine.Engine - INFO - [cached since 0.4582s ago] ('528155210',)
2025-01-18 19:51:55,821 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:51:55,822 - sqlalchemy.engine.Engine - INFO - [cached since 2.413s ago] ('528155210',)
2025-01-18 19:51:58,264 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:51:58,266 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:51:58,267 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:51:58,267 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('115',)
2025-01-18 19:52:00,566 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:52:00,566 - sqlalchemy.engine.Engine - INFO - [cached since 2.3s ago] ('116',)
2025-01-18 19:52:02,835 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:52:02,835 - sqlalchemy.engine.Engine - INFO - [cached since 7.477s ago] ('528155210',)
2025-01-18 19:52:03,099 - aiogram.event - INFO - Update id=659309620 is handled. Duration 7500 ms by bot id=7444575424
2025-01-18 19:52:03,130 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:52:03,130 - sqlalchemy.engine.Engine - INFO - [cached since 7.771s ago] ('432629636',)
2025-01-18 19:52:03,131 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:52:03,132 - sqlalchemy.engine.Engine - INFO - [cached since 9.724s ago] ('432629636',)
2025-01-18 19:52:09,344 - aiogram.event - INFO - Update id=659309621 is handled. Duration 328 ms by bot id=7444575424
2025-01-18 19:52:11,042 - aiogram.event - INFO - Update id=659309622 is handled. Duration 406 ms by bot id=7444575424
2025-01-18 19:52:13,279 - aiogram.event - INFO - Update id=659309623 is handled. Duration 266 ms by bot id=7444575424
2025-01-18 19:52:14,880 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=6000)]
2025-01-18 19:52:15,178 - aiogram.event - INFO - Update id=659309624 is handled. Duration 296 ms by bot id=7444575424
2025-01-18 19:55:10,113 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:56:29,444 - root - INFO - Инициализация бота...
2025-01-18 19:56:30,422 - root - INFO - Инициализация бота...
2025-01-18 19:56:30,494 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:56:30,494 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 19:56:30,494 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:56:30,496 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 19:56:30,496 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 19:56:30,498 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:56:30,547 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 19:56:30,547 - root - INFO - Инициализация диспетчера...
2025-01-18 19:56:30,548 - root - INFO - Регистрация обработчиков...
2025-01-18 19:56:30,550 - root - INFO - Регистрация main menu команд...
2025-01-18 19:56:31,955 - root - INFO - Команды успешно установлены
2025-01-18 19:56:31,955 - root - INFO - Запуск polling...
2025-01-18 19:56:31,956 - aiogram.dispatcher - INFO - Start polling
2025-01-18 19:56:31,963 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:56:31,967 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 19:56:31,968 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ()
2025-01-18 19:56:31,974 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:56:31,974 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] ('181151262',)
2025-01-18 19:56:34,611 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:56:34,612 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:56:34,614 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:56:34,614 - sqlalchemy.engine.Engine - INFO - [generated in 0.00052s] ('181151262',)
2025-01-18 19:56:34,684 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:56:35,226 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:56:35,227 - sqlalchemy.engine.Engine - INFO - [cached since 0.6133s ago] ('528155210',)
2025-01-18 19:56:35,229 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:56:35,230 - sqlalchemy.engine.Engine - INFO - [cached since 3.257s ago] ('528155210',)
2025-01-18 19:56:37,197 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 19:56:37,200 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 19:56:37,203 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:56:37,204 - sqlalchemy.engine.Engine - INFO - [generated in 0.00088s] ('115',)
2025-01-18 19:56:39,577 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 19:56:39,578 - sqlalchemy.engine.Engine - INFO - [cached since 2.374s ago] ('116',)
2025-01-18 19:56:41,881 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:56:41,882 - sqlalchemy.engine.Engine - INFO - [cached since 7.269s ago] ('528155210',)
2025-01-18 19:56:42,128 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 19:56:42,128 - sqlalchemy.engine.Engine - INFO - [cached since 7.515s ago] ('432629636',)
2025-01-18 19:56:42,131 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 19:56:42,133 - sqlalchemy.engine.Engine - INFO - [cached since 10.16s ago] ('432629636',)
2025-01-18 19:56:45,102 - aiogram.event - INFO - Update id=659309625 is handled. Duration 485 ms by bot id=7444575424
2025-01-18 19:56:46,891 - aiogram.event - INFO - Update id=659309626 is handled. Duration 187 ms by bot id=7444575424
2025-01-18 19:56:47,566 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=5000)]
2025-01-18 19:56:47,732 - aiogram.event - INFO - Update id=659309627 is not handled. Duration 172 ms by bot id=7444575424
2025-01-18 19:56:47,732 - aiogram.event - ERROR - Cause exception while process update id=659309627 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 77, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 19:59:51,474 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 19:59:51,735 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 19:59:51,742 - root - INFO - Бот остановлен вручную.
2025-01-18 19:59:52,264 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001FD8B181590>
2025-01-18 20:00:01,086 - root - INFO - Инициализация бота...
2025-01-18 20:00:02,155 - root - INFO - Инициализация бота...
2025-01-18 20:00:02,324 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 20:00:02,325 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 20:00:02,326 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 20:00:02,329 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 20:00:02,330 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 20:00:02,332 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 20:00:02,424 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 20:00:02,424 - root - INFO - Инициализация диспетчера...
2025-01-18 20:00:02,425 - root - INFO - Регистрация обработчиков...
2025-01-18 20:00:02,428 - root - INFO - Регистрация main menu команд...
2025-01-18 20:00:03,173 - root - INFO - Команды успешно установлены
2025-01-18 20:00:03,174 - root - INFO - Запуск polling...
2025-01-18 20:00:03,174 - aiogram.dispatcher - INFO - Start polling
2025-01-18 20:00:03,184 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 20:00:03,187 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 20:00:03,187 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ()
2025-01-18 20:00:03,193 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 20:00:03,193 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] ('181151262',)
2025-01-18 20:00:06,888 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 20:00:06,890 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 20:00:06,893 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 20:00:06,894 - sqlalchemy.engine.Engine - INFO - [generated in 0.00091s] ('181151262',)
2025-01-18 20:00:07,025 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 20:00:07,537 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 20:00:07,538 - sqlalchemy.engine.Engine - INFO - [cached since 0.6443s ago] ('528155210',)
2025-01-18 20:00:07,542 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 20:00:07,543 - sqlalchemy.engine.Engine - INFO - [cached since 4.351s ago] ('528155210',)
2025-01-18 20:00:11,266 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 20:00:11,268 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 20:00:11,272 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 20:00:11,273 - sqlalchemy.engine.Engine - INFO - [generated in 0.00143s] ('115',)
2025-01-18 20:00:15,886 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 20:00:15,886 - sqlalchemy.engine.Engine - INFO - [cached since 4.615s ago] ('116',)
2025-01-18 20:00:19,544 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 20:00:19,546 - sqlalchemy.engine.Engine - INFO - [cached since 12.65s ago] ('528155210',)
2025-01-18 20:00:19,791 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 20:00:19,792 - sqlalchemy.engine.Engine - INFO - [cached since 12.9s ago] ('432629636',)
2025-01-18 20:00:19,795 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 20:00:19,796 - sqlalchemy.engine.Engine - INFO - [cached since 16.6s ago] ('432629636',)
2025-01-18 20:00:27,821 - aiogram.event - INFO - Update id=659309628 is handled. Duration 608 ms by bot id=7444575424
2025-01-18 20:00:29,054 - aiogram.event - INFO - Update id=659309629 is handled. Duration 360 ms by bot id=7444575424
2025-01-18 20:00:29,581 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=5000)]
2025-01-18 20:00:29,807 - aiogram.event - INFO - Update id=659309630 is not handled. Duration 233 ms by bot id=7444575424
2025-01-18 20:00:29,809 - aiogram.event - ERROR - Cause exception while process update id=659309630 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 77, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: CURRENCY_TOTAL_AMOUNT_INVALID
2025-01-18 20:02:41,101 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 20:02:41,359 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 20:02:41,369 - root - INFO - Бот остановлен вручную.
2025-01-18 20:02:41,696 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000023386946F50>
2025-01-18 20:02:50,920 - root - INFO - Инициализация бота...
2025-01-18 20:02:52,670 - root - INFO - Инициализация бота...
2025-01-18 20:02:52,961 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 20:02:52,963 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 20:02:52,964 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 20:02:52,977 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 20:02:52,983 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 20:02:52,992 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 20:02:53,103 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 20:02:53,103 - root - INFO - Инициализация диспетчера...
2025-01-18 20:02:53,104 - root - INFO - Регистрация обработчиков...
2025-01-18 20:02:53,105 - root - INFO - Регистрация main menu команд...
2025-01-18 20:02:53,606 - root - INFO - Команды успешно установлены
2025-01-18 20:02:53,607 - root - INFO - Запуск polling...
2025-01-18 20:02:53,608 - aiogram.dispatcher - INFO - Start polling
2025-01-18 20:02:53,633 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 20:02:53,642 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 20:02:53,643 - sqlalchemy.engine.Engine - INFO - [generated in 0.00105s] ()
2025-01-18 20:02:53,653 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 20:02:53,654 - sqlalchemy.engine.Engine - INFO - [generated in 0.00116s] ('181151262',)
2025-01-18 20:02:56,244 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 20:02:56,246 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 20:02:56,247 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 20:02:56,247 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ('181151262',)
2025-01-18 20:02:56,318 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA_connect'
2025-01-18 20:02:56,723 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 20:02:56,724 - sqlalchemy.engine.Engine - INFO - [cached since 0.4768s ago] ('528155210',)
2025-01-18 20:02:56,725 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 20:02:56,725 - sqlalchemy.engine.Engine - INFO - [cached since 3.072s ago] ('528155210',)
2025-01-18 20:02:59,302 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 20:02:59,303 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 20:02:59,305 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 20:02:59,306 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] ('115',)
2025-01-18 20:03:01,855 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 20:03:01,855 - sqlalchemy.engine.Engine - INFO - [cached since 2.55s ago] ('116',)
2025-01-18 20:03:04,001 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 20:03:04,002 - sqlalchemy.engine.Engine - INFO - [cached since 7.755s ago] ('528155210',)
2025-01-18 20:03:04,167 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 20:03:04,168 - sqlalchemy.engine.Engine - INFO - [cached since 7.922s ago] ('432629636',)
2025-01-18 20:03:04,171 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 20:03:04,172 - sqlalchemy.engine.Engine - INFO - [cached since 10.52s ago] ('432629636',)
2025-01-18 20:03:10,024 - aiogram.event - INFO - Update id=659309631 is handled. Duration 562 ms by bot id=7444575424
2025-01-18 20:03:11,348 - aiogram.event - INFO - Update id=659309632 is handled. Duration 625 ms by bot id=7444575424
2025-01-18 20:03:11,962 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 20:03:12,324 - aiogram.event - INFO - Update id=659309633 is handled. Duration 375 ms by bot id=7444575424
2025-01-18 20:03:19,761 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 21:57:01,649 - root - INFO - Инициализация бота...
2025-01-18 21:57:02,971 - root - INFO - Инициализация бота...
2025-01-18 21:57:03,111 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 21:57:03,112 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 21:57:03,112 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 21:57:03,118 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 21:57:03,119 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 21:57:03,120 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 21:57:03,190 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 21:57:03,191 - root - INFO - Инициализация диспетчера...
2025-01-18 21:57:03,192 - root - INFO - Регистрация обработчиков...
2025-01-18 21:57:03,197 - root - INFO - Регистрация main menu команд...
2025-01-18 21:57:04,624 - root - INFO - Команды успешно установлены
2025-01-18 21:57:04,625 - root - INFO - Запуск polling...
2025-01-18 21:57:04,625 - aiogram.dispatcher - INFO - Start polling
2025-01-18 21:57:04,649 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 21:57:04,661 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 21:57:04,662 - sqlalchemy.engine.Engine - INFO - [generated in 0.00115s] ()
2025-01-18 21:57:04,677 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 21:57:04,678 - sqlalchemy.engine.Engine - INFO - [generated in 0.00120s] ('181151262',)
2025-01-18 21:57:08,413 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 21:57:08,418 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 21:57:08,421 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 21:57:08,422 - sqlalchemy.engine.Engine - INFO - [generated in 0.00107s] ('181151262',)
2025-01-18 21:57:08,512 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 21:57:09,065 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 21:57:09,067 - sqlalchemy.engine.Engine - INFO - [cached since 0.6464s ago] ('528155210',)
2025-01-18 21:57:09,070 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 21:57:09,071 - sqlalchemy.engine.Engine - INFO - [cached since 4.394s ago] ('528155210',)
2025-01-18 21:57:12,621 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 21:57:12,625 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 21:57:12,631 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 21:57:12,632 - sqlalchemy.engine.Engine - INFO - [generated in 0.00195s] ('115',)
2025-01-18 21:57:16,914 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 21:57:16,915 - sqlalchemy.engine.Engine - INFO - [cached since 4.284s ago] ('116',)
2025-01-18 21:57:19,783 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 21:57:19,784 - sqlalchemy.engine.Engine - INFO - [cached since 11.36s ago] ('528155210',)
2025-01-18 21:57:19,795 - aiogram.event - INFO - Update id=659309746 is handled. Duration 11110 ms by bot id=7444575424
2025-01-18 21:57:19,797 - aiogram.event - INFO - Update id=659309747 is handled. Duration 11110 ms by bot id=7444575424
2025-01-18 21:57:20,165 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 21:57:20,165 - sqlalchemy.engine.Engine - INFO - [cached since 11.75s ago] ('432629636',)
2025-01-18 21:57:20,165 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 21:57:20,173 - sqlalchemy.engine.Engine - INFO - [cached since 15.5s ago] ('432629636',)
2025-01-18 21:57:23,447 - aiogram.event - INFO - Update id=659309748 is handled. Duration 3656 ms by bot id=7444575424
2025-01-18 21:57:23,617 - aiogram.event - INFO - Update id=659309749 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 21:57:27,156 - aiogram.event - INFO - Update id=659309750 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 21:57:29,380 - aiogram.event - INFO - Update id=659309751 is handled. Duration 375 ms by bot id=7444575424
2025-01-18 21:57:31,887 - aiogram.event - INFO - Update id=659309752 is handled. Duration 203 ms by bot id=7444575424
2025-01-18 21:57:32,556 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 21:57:32,965 - aiogram.event - INFO - Update id=659309753 is handled. Duration 422 ms by bot id=7444575424
2025-01-18 21:57:38,310 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:03:33,831 - root - INFO - Инициализация бота...
2025-01-18 22:03:34,279 - root - INFO - Инициализация бота...
2025-01-18 22:03:34,325 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:03:34,327 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:03:34,327 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:03:34,327 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:03:34,328 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:03:34,328 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:03:55,724 - root - INFO - Инициализация бота...
2025-01-18 22:03:56,071 - root - INFO - Инициализация бота...
2025-01-18 22:03:56,104 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:03:56,104 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:03:56,104 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:03:56,104 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:03:56,105 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:03:56,105 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:03:56,148 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:03:56,148 - root - INFO - Инициализация диспетчера...
2025-01-18 22:03:56,148 - root - INFO - Регистрация обработчиков...
2025-01-18 22:03:56,149 - root - INFO - Регистрация main menu команд...
2025-01-18 22:03:56,531 - root - INFO - Команды успешно установлены
2025-01-18 22:03:56,531 - root - INFO - Запуск polling...
2025-01-18 22:03:56,531 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:03:56,536 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:03:56,537 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:03:56,537 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ()
2025-01-18 22:03:56,540 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:03:56,540 - sqlalchemy.engine.Engine - INFO - [generated in 0.00021s] ('181151262',)
2025-01-18 22:03:58,813 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:03:58,813 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:03:58,814 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:03:58,814 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ('181151262',)
2025-01-18 22:03:58,912 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:03:59,149 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:03:59,150 - sqlalchemy.engine.Engine - INFO - [cached since 0.3364s ago] ('528155210',)
2025-01-18 22:03:59,150 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:03:59,151 - sqlalchemy.engine.Engine - INFO - [cached since 2.611s ago] ('528155210',)
2025-01-18 22:04:03,188 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:04:03,188 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:04:03,189 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:04:03,189 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ('115',)
2025-01-18 22:04:06,847 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:04:06,848 - sqlalchemy.engine.Engine - INFO - [cached since 3.659s ago] ('116',)
2025-01-18 22:04:09,087 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:04:09,087 - sqlalchemy.engine.Engine - INFO - [cached since 10.27s ago] ('528155210',)
2025-01-18 22:04:09,208 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:04:09,208 - sqlalchemy.engine.Engine - INFO - [cached since 10.39s ago] ('432629636',)
2025-01-18 22:04:09,209 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:04:09,209 - sqlalchemy.engine.Engine - INFO - [cached since 12.67s ago] ('432629636',)
2025-01-18 22:04:12,252 - aiogram.event - INFO - Update id=659309754 is handled. Duration 343 ms by bot id=7444575424
2025-01-18 22:04:13,894 - aiogram.event - INFO - Update id=659309755 is handled. Duration 187 ms by bot id=7444575424
2025-01-18 22:04:15,912 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=24000)]
2025-01-18 22:04:16,216 - aiogram.event - INFO - Update id=659309756 is handled. Duration 312 ms by bot id=7444575424
2025-01-18 22:07:51,085 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:07:51,348 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:07:51,350 - root - INFO - Бот остановлен вручную.
2025-01-18 22:07:51,524 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001D222EE6790>
2025-01-18 22:07:55,183 - root - INFO - Инициализация бота...
2025-01-18 22:07:55,668 - root - INFO - Инициализация бота...
2025-01-18 22:07:55,714 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:07:55,714 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:07:55,715 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:07:55,716 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:07:55,716 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:07:55,716 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:07:55,750 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:07:55,750 - root - INFO - Инициализация диспетчера...
2025-01-18 22:07:55,750 - root - INFO - Регистрация обработчиков...
2025-01-18 22:07:55,751 - root - INFO - Регистрация main menu команд...
2025-01-18 22:07:56,243 - root - INFO - Команды успешно установлены
2025-01-18 22:07:56,243 - root - INFO - Запуск polling...
2025-01-18 22:07:56,243 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:07:56,249 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:07:56,251 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:07:56,251 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] ()
2025-01-18 22:07:56,254 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:07:56,255 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] ('181151262',)
2025-01-18 22:07:58,248 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:07:58,249 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:07:58,249 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:07:58,250 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] ('181151262',)
2025-01-18 22:07:58,307 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:07:58,678 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:07:58,678 - sqlalchemy.engine.Engine - INFO - [cached since 0.4285s ago] ('528155210',)
2025-01-18 22:07:58,679 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:07:58,679 - sqlalchemy.engine.Engine - INFO - [cached since 2.425s ago] ('528155210',)
2025-01-18 22:08:00,854 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:08:00,855 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:08:00,856 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:08:00,857 - sqlalchemy.engine.Engine - INFO - [generated in 0.00039s] ('115',)
2025-01-18 22:08:02,917 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:08:02,917 - sqlalchemy.engine.Engine - INFO - [cached since 2.06s ago] ('116',)
2025-01-18 22:08:04,993 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:08:04,994 - sqlalchemy.engine.Engine - INFO - [cached since 6.744s ago] ('528155210',)
2025-01-18 22:08:05,208 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:08:05,209 - sqlalchemy.engine.Engine - INFO - [cached since 6.959s ago] ('432629636',)
2025-01-18 22:08:05,210 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:08:05,210 - sqlalchemy.engine.Engine - INFO - [cached since 8.955s ago] ('432629636',)
2025-01-18 22:08:20,368 - aiogram.event - INFO - Update id=659309757 is handled. Duration 343 ms by bot id=7444575424
2025-01-18 22:08:22,006 - aiogram.event - INFO - Update id=659309758 is not handled. Duration 0 ms by bot id=7444575424
2025-01-18 22:08:22,006 - aiogram.event - ERROR - Cause exception while process update id=659309758 by bot id=7444575424
AttributeError: 'CallbackQuery' object has no attribute 'delete_message'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\main_menu_router.py", line 44, in main_menu_handler
    await buy_key_menu(callback, state)
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 39, in buy_key_menu
    await callback.delete_message()
          ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\pydantic\main.py", line 856, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'CallbackQuery' object has no attribute 'delete_message'
2025-01-18 22:11:35,316 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:11:35,569 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:11:35,570 - root - INFO - Бот остановлен вручную.
2025-01-18 22:11:35,739 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000018224A6A450>
2025-01-18 22:11:39,098 - root - INFO - Инициализация бота...
2025-01-18 22:11:39,501 - root - INFO - Инициализация бота...
2025-01-18 22:11:39,540 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:11:39,541 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:11:39,541 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:11:39,542 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:11:39,542 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:11:39,542 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:11:39,567 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:11:39,567 - root - INFO - Инициализация диспетчера...
2025-01-18 22:11:39,568 - root - INFO - Регистрация обработчиков...
2025-01-18 22:11:39,569 - root - INFO - Регистрация main menu команд...
2025-01-18 22:11:39,989 - root - INFO - Команды успешно установлены
2025-01-18 22:11:39,990 - root - INFO - Запуск polling...
2025-01-18 22:11:39,990 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:11:39,995 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:11:39,996 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:11:39,997 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ()
2025-01-18 22:11:40,000 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:11:40,000 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ('181151262',)
2025-01-18 22:11:43,229 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:11:43,229 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:11:43,230 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:11:43,230 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ('181151262',)
2025-01-18 22:11:43,374 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:11:43,820 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:11:43,820 - sqlalchemy.engine.Engine - INFO - [cached since 0.5903s ago] ('528155210',)
2025-01-18 22:11:43,821 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:11:43,821 - sqlalchemy.engine.Engine - INFO - [cached since 3.821s ago] ('528155210',)
2025-01-18 22:11:47,444 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:11:47,444 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:11:47,445 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:11:47,445 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] ('115',)
2025-01-18 22:11:50,074 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:11:50,074 - sqlalchemy.engine.Engine - INFO - [cached since 2.629s ago] ('116',)
2025-01-18 22:11:52,849 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:11:52,849 - sqlalchemy.engine.Engine - INFO - [cached since 9.62s ago] ('528155210',)
2025-01-18 22:11:53,026 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:11:53,026 - sqlalchemy.engine.Engine - INFO - [cached since 9.796s ago] ('432629636',)
2025-01-18 22:11:53,027 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:11:53,027 - sqlalchemy.engine.Engine - INFO - [cached since 13.03s ago] ('432629636',)
2025-01-18 22:11:55,091 - aiogram.event - INFO - Update id=659309759 is handled. Duration 2218 ms by bot id=7444575424
2025-01-18 22:11:55,362 - aiogram.event - INFO - Update id=659309760 is handled. Duration 468 ms by bot id=7444575424
2025-01-18 22:11:57,760 - aiogram.event - INFO - Update id=659309761 is handled. Duration 468 ms by bot id=7444575424
2025-01-18 22:11:58,734 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=9000)]
2025-01-18 22:11:58,920 - aiogram.event - INFO - Update id=659309762 is not handled. Duration 187 ms by bot id=7444575424
2025-01-18 22:11:58,921 - aiogram.event - ERROR - Cause exception while process update id=659309762 by bot id=7444575424
AttributeError: 'Bot' object has no attribute 'send_messgae'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 88, in handle_period_selection
    await bot.send_messgae(reply_markup=get_back_button_to_buy_key())
          ^^^^^^^^^^^^^^^^
AttributeError: 'Bot' object has no attribute 'send_messgae'
2025-01-18 22:13:19,692 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:13:19,823 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [Errno 1] [SSL: APPLICATION_DATA_AFTER_CLOSE_NOTIFY] application data after close notify (_ssl.c:2702)
2025-01-18 22:13:19,823 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-18 22:13:19,935 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:13:19,939 - root - INFO - Бот остановлен вручную.
2025-01-18 22:13:20,128 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001DAD1846790>
2025-01-18 22:13:24,266 - root - INFO - Инициализация бота...
2025-01-18 22:13:24,705 - root - INFO - Инициализация бота...
2025-01-18 22:13:24,747 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:13:24,747 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:13:24,747 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:13:24,748 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:13:24,748 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:13:24,749 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:13:24,776 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:13:24,776 - root - INFO - Инициализация диспетчера...
2025-01-18 22:13:24,777 - root - INFO - Регистрация обработчиков...
2025-01-18 22:13:24,778 - root - INFO - Регистрация main menu команд...
2025-01-18 22:13:25,171 - root - INFO - Команды успешно установлены
2025-01-18 22:13:25,171 - root - INFO - Запуск polling...
2025-01-18 22:13:25,171 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:13:25,176 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:13:25,177 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:13:25,178 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] ()
2025-01-18 22:13:25,181 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:13:25,181 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ('181151262',)
2025-01-18 22:13:29,538 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:13:29,539 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:13:29,540 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:13:29,540 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] ('181151262',)
2025-01-18 22:13:29,623 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:13:30,079 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:13:30,079 - sqlalchemy.engine.Engine - INFO - [cached since 0.5402s ago] ('528155210',)
2025-01-18 22:13:30,080 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:13:30,080 - sqlalchemy.engine.Engine - INFO - [cached since 4.9s ago] ('528155210',)
2025-01-18 22:13:34,696 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:13:34,697 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:13:34,699 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:13:34,699 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ('115',)
2025-01-18 22:13:39,658 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:13:39,658 - sqlalchemy.engine.Engine - INFO - [cached since 4.96s ago] ('116',)
2025-01-18 22:13:43,039 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:13:43,040 - sqlalchemy.engine.Engine - INFO - [cached since 13.5s ago] ('528155210',)
2025-01-18 22:13:43,185 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:13:43,185 - sqlalchemy.engine.Engine - INFO - [cached since 13.65s ago] ('432629636',)
2025-01-18 22:13:43,186 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:13:43,186 - sqlalchemy.engine.Engine - INFO - [cached since 18.01s ago] ('432629636',)
2025-01-18 22:13:56,420 - aiogram.event - INFO - Update id=659309763 is handled. Duration 437 ms by bot id=7444575424
2025-01-18 22:14:00,481 - aiogram.event - INFO - Update id=659309764 is handled. Duration 343 ms by bot id=7444575424
2025-01-18 22:14:02,842 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 22:14:03,021 - aiogram.event - INFO - Update id=659309765 is not handled. Duration 171 ms by bot id=7444575424
2025-01-18 22:14:03,021 - aiogram.event - ERROR - Cause exception while process update id=659309765 by bot id=7444575424
TypeError: Bot.send_message() missing 2 required positional arguments: 'chat_id' and 'text'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 88, in handle_period_selection
    await bot.send_message(reply_markup=get_back_button_to_buy_key())
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Bot.send_message() missing 2 required positional arguments: 'chat_id' and 'text'
2025-01-18 22:14:34,596 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:14:34,849 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:14:34,850 - root - INFO - Бот остановлен вручную.
2025-01-18 22:14:35,027 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001C8FFC62990>
2025-01-18 22:14:38,118 - root - INFO - Инициализация бота...
2025-01-18 22:14:38,478 - root - INFO - Инициализация бота...
2025-01-18 22:14:38,511 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:14:38,511 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:14:38,511 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:14:38,512 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:14:38,512 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:14:38,512 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:14:38,533 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:14:38,534 - root - INFO - Инициализация диспетчера...
2025-01-18 22:14:38,534 - root - INFO - Регистрация обработчиков...
2025-01-18 22:14:38,535 - root - INFO - Регистрация main menu команд...
2025-01-18 22:14:41,548 - root - INFO - Команды успешно установлены
2025-01-18 22:14:41,548 - root - INFO - Запуск polling...
2025-01-18 22:14:41,548 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:14:41,552 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:14:41,554 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:14:41,554 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] ()
2025-01-18 22:14:41,556 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:14:41,557 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ('181151262',)
2025-01-18 22:14:44,099 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:14:44,100 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:14:44,101 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:14:44,102 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ('181151262',)
2025-01-18 22:14:44,186 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:14:44,473 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:14:44,473 - sqlalchemy.engine.Engine - INFO - [cached since 0.3711s ago] ('528155210',)
2025-01-18 22:14:44,474 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:14:44,474 - sqlalchemy.engine.Engine - INFO - [cached since 2.917s ago] ('528155210',)
2025-01-18 22:14:47,063 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:14:47,064 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:14:47,065 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:14:47,066 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ('115',)
2025-01-18 22:14:49,974 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:14:49,974 - sqlalchemy.engine.Engine - INFO - [cached since 2.909s ago] ('116',)
2025-01-18 22:14:52,300 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:14:52,301 - sqlalchemy.engine.Engine - INFO - [cached since 8.2s ago] ('528155210',)
2025-01-18 22:14:52,451 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:14:52,451 - sqlalchemy.engine.Engine - INFO - [cached since 8.349s ago] ('432629636',)
2025-01-18 22:14:52,452 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:14:52,452 - sqlalchemy.engine.Engine - INFO - [cached since 10.9s ago] ('432629636',)
2025-01-18 22:14:56,565 - aiogram.event - INFO - Update id=659309766 is handled. Duration 358 ms by bot id=7444575424
2025-01-18 22:14:58,223 - aiogram.event - INFO - Update id=659309767 is handled. Duration 485 ms by bot id=7444575424
2025-01-18 22:14:59,059 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=24000)]
2025-01-18 22:14:59,631 - aiogram.event - INFO - Update id=659309768 is handled. Duration 563 ms by bot id=7444575424
2025-01-18 22:15:05,696 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:15:05,960 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:15:05,963 - root - INFO - Бот остановлен вручную.
2025-01-18 22:15:06,136 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002220D9BAB90>
2025-01-18 22:15:06,137 - asyncio - ERROR - Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x000002221149D780>, 103607.484)]']
connector: <aiohttp.connector.TCPConnector object at 0x0000022211362690>
2025-01-18 22:15:09,941 - root - INFO - Инициализация бота...
2025-01-18 22:15:10,296 - root - INFO - Инициализация бота...
2025-01-18 22:15:10,328 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:15:10,328 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:15:10,328 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:15:10,329 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:15:10,329 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:15:10,329 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:15:10,349 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:15:10,349 - root - INFO - Инициализация диспетчера...
2025-01-18 22:15:10,350 - root - INFO - Регистрация обработчиков...
2025-01-18 22:15:10,351 - root - INFO - Регистрация main menu команд...
2025-01-18 22:15:10,767 - root - INFO - Команды успешно установлены
2025-01-18 22:15:10,767 - root - INFO - Запуск polling...
2025-01-18 22:15:10,767 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:15:10,771 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:15:10,772 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:15:10,772 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ()
2025-01-18 22:15:10,775 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:15:10,775 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] ('181151262',)
2025-01-18 22:15:15,636 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:15:15,637 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:15:15,638 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:15:15,638 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ('181151262',)
2025-01-18 22:15:15,698 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:15:15,985 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:15:15,985 - sqlalchemy.engine.Engine - INFO - [cached since 0.3481s ago] ('528155210',)
2025-01-18 22:15:15,986 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:15:15,986 - sqlalchemy.engine.Engine - INFO - [cached since 5.212s ago] ('528155210',)
2025-01-18 22:15:19,747 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:15:19,747 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:15:19,748 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:15:19,748 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] ('115',)
2025-01-18 22:15:24,163 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:15:24,164 - sqlalchemy.engine.Engine - INFO - [cached since 4.416s ago] ('116',)
2025-01-18 22:15:28,933 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:15:28,933 - sqlalchemy.engine.Engine - INFO - [cached since 13.3s ago] ('528155210',)
2025-01-18 22:15:29,254 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:15:29,254 - sqlalchemy.engine.Engine - INFO - [cached since 13.62s ago] ('432629636',)
2025-01-18 22:15:29,254 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:15:29,254 - sqlalchemy.engine.Engine - INFO - [cached since 18.48s ago] ('432629636',)
2025-01-18 22:15:36,734 - aiogram.event - INFO - Update id=659309769 is handled. Duration 1827 ms by bot id=7444575424
2025-01-18 22:15:37,590 - aiogram.event - INFO - Update id=659309770 is handled. Duration 250 ms by bot id=7444575424
2025-01-18 22:15:38,734 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=24000)]
2025-01-18 22:15:39,072 - aiogram.event - INFO - Update id=659309771 is not handled. Duration 343 ms by bot id=7444575424
2025-01-18 22:15:39,072 - aiogram.event - ERROR - Cause exception while process update id=659309771 by bot id=7444575424
TypeError: Bot.send_message() missing 1 required positional argument: 'text'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 88, in handle_period_selection
    await bot.send_message(
          ^^^^^^^^^^^^^^^^^
TypeError: Bot.send_message() missing 1 required positional argument: 'text'
2025-01-18 22:17:09,125 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:17:09,230 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [Errno 1] [SSL: APPLICATION_DATA_AFTER_CLOSE_NOTIFY] application data after close notify (_ssl.c:2702)
2025-01-18 22:17:09,230 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-18 22:17:09,376 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:17:09,380 - root - INFO - Бот остановлен вручную.
2025-01-18 22:17:09,612 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000173539C1B10>
2025-01-18 22:17:12,817 - root - INFO - Инициализация бота...
2025-01-18 22:17:13,247 - root - INFO - Инициализация бота...
2025-01-18 22:17:13,289 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:17:13,290 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:17:13,290 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:17:13,291 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:17:13,291 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:17:13,291 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:17:13,319 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:17:13,319 - root - INFO - Инициализация диспетчера...
2025-01-18 22:17:13,320 - root - INFO - Регистрация обработчиков...
2025-01-18 22:17:13,321 - root - INFO - Регистрация main menu команд...
2025-01-18 22:17:13,842 - root - INFO - Команды успешно установлены
2025-01-18 22:17:13,842 - root - INFO - Запуск polling...
2025-01-18 22:17:13,843 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:17:13,852 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:17:13,855 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:17:13,855 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] ()
2025-01-18 22:17:13,859 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:17:13,859 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] ('181151262',)
2025-01-18 22:17:18,605 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:17:18,606 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:17:18,606 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:17:18,607 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ('181151262',)
2025-01-18 22:17:18,666 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:17:19,053 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:17:19,053 - sqlalchemy.engine.Engine - INFO - [cached since 0.4466s ago] ('528155210',)
2025-01-18 22:17:19,054 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:17:19,054 - sqlalchemy.engine.Engine - INFO - [cached since 5.196s ago] ('528155210',)
2025-01-18 22:17:21,184 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:17:21,185 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:17:21,185 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:17:21,186 - sqlalchemy.engine.Engine - INFO - [generated in 0.00021s] ('115',)
2025-01-18 22:17:23,694 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:17:23,695 - sqlalchemy.engine.Engine - INFO - [cached since 2.509s ago] ('116',)
2025-01-18 22:17:26,710 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:17:26,710 - sqlalchemy.engine.Engine - INFO - [cached since 8.103s ago] ('528155210',)
2025-01-18 22:17:26,880 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:17:26,880 - sqlalchemy.engine.Engine - INFO - [cached since 8.273s ago] ('432629636',)
2025-01-18 22:17:26,881 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:17:26,881 - sqlalchemy.engine.Engine - INFO - [cached since 13.02s ago] ('432629636',)
2025-01-18 22:17:36,083 - aiogram.event - INFO - Update id=659309772 is handled. Duration 687 ms by bot id=7444575424
2025-01-18 22:17:37,209 - aiogram.event - INFO - Update id=659309773 is handled. Duration 437 ms by bot id=7444575424
2025-01-18 22:17:37,877 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=24000)]
2025-01-18 22:17:38,111 - aiogram.event - INFO - Update id=659309774 is not handled. Duration 233 ms by bot id=7444575424
2025-01-18 22:17:38,112 - aiogram.event - ERROR - Cause exception while process update id=659309774 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: REPLY_MARKUP_BUY_EMPTY
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 76, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: REPLY_MARKUP_BUY_EMPTY
2025-01-18 22:19:31,480 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:19:31,732 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:19:31,734 - root - INFO - Бот остановлен вручную.
2025-01-18 22:19:31,936 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001DAAC46A610>
2025-01-18 22:19:38,946 - root - INFO - Инициализация бота...
2025-01-18 22:19:39,537 - root - INFO - Инициализация бота...
2025-01-18 22:19:39,594 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:19:39,594 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:19:39,594 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:19:39,595 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:19:39,596 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:19:39,596 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:19:39,631 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:19:39,632 - root - INFO - Инициализация диспетчера...
2025-01-18 22:19:39,633 - root - INFO - Регистрация обработчиков...
2025-01-18 22:19:39,634 - root - INFO - Регистрация main menu команд...
2025-01-18 22:19:40,079 - root - INFO - Команды успешно установлены
2025-01-18 22:19:40,079 - root - INFO - Запуск polling...
2025-01-18 22:19:40,079 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:19:40,086 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:19:40,088 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:19:40,089 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] ()
2025-01-18 22:19:40,093 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:19:40,093 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] ('181151262',)
2025-01-18 22:19:42,796 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:19:42,797 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:19:42,797 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:19:42,798 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] ('181151262',)
2025-01-18 22:19:42,857 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:19:45,190 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:19:45,190 - sqlalchemy.engine.Engine - INFO - [cached since 2.392s ago] ('528155210',)
2025-01-18 22:19:45,191 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:19:45,191 - sqlalchemy.engine.Engine - INFO - [cached since 5.098s ago] ('528155210',)
2025-01-18 22:19:47,189 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:19:47,191 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:19:47,192 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:19:47,193 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('115',)
2025-01-18 22:19:49,322 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:19:49,322 - sqlalchemy.engine.Engine - INFO - [cached since 2.13s ago] ('116',)
2025-01-18 22:19:51,491 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:19:51,491 - sqlalchemy.engine.Engine - INFO - [cached since 8.693s ago] ('528155210',)
2025-01-18 22:19:51,762 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:19:51,762 - sqlalchemy.engine.Engine - INFO - [cached since 8.965s ago] ('432629636',)
2025-01-18 22:19:51,764 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:19:51,765 - sqlalchemy.engine.Engine - INFO - [cached since 11.67s ago] ('432629636',)
2025-01-18 22:19:55,108 - aiogram.event - INFO - Update id=659309775 is handled. Duration 297 ms by bot id=7444575424
2025-01-18 22:19:56,471 - aiogram.event - INFO - Update id=659309776 is handled. Duration 141 ms by bot id=7444575424
2025-01-18 22:19:57,189 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=69000)]
2025-01-18 22:19:57,324 - aiogram.event - INFO - Update id=659309777 is not handled. Duration 141 ms by bot id=7444575424
2025-01-18 22:19:57,324 - aiogram.event - ERROR - Cause exception while process update id=659309777 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: REPLY_MARKUP_BUY_EMPTY
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 76, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: REPLY_MARKUP_BUY_EMPTY
2025-01-18 22:20:24,244 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:20:24,510 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:20:24,511 - root - INFO - Бот остановлен вручную.
2025-01-18 22:20:24,686 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002293DEB5310>
2025-01-18 22:20:28,754 - root - INFO - Инициализация бота...
2025-01-18 22:20:29,184 - root - INFO - Инициализация бота...
2025-01-18 22:20:29,231 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:20:29,231 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:20:29,231 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:20:29,232 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:20:29,232 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:20:29,233 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:20:29,261 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:20:29,261 - root - INFO - Инициализация диспетчера...
2025-01-18 22:20:29,262 - root - INFO - Регистрация обработчиков...
2025-01-18 22:20:29,264 - root - INFO - Регистрация main menu команд...
2025-01-18 22:20:29,760 - root - INFO - Команды успешно установлены
2025-01-18 22:20:29,760 - root - INFO - Запуск polling...
2025-01-18 22:20:29,761 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:20:29,769 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:20:29,772 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:20:29,772 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] ()
2025-01-18 22:20:29,776 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:20:29,777 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] ('181151262',)
2025-01-18 22:20:33,036 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:20:33,037 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:20:33,039 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:20:33,039 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] ('181151262',)
2025-01-18 22:20:33,097 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:20:33,516 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:20:33,516 - sqlalchemy.engine.Engine - INFO - [cached since 0.4786s ago] ('528155210',)
2025-01-18 22:20:33,517 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:20:33,517 - sqlalchemy.engine.Engine - INFO - [cached since 3.741s ago] ('528155210',)
2025-01-18 22:20:36,284 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:20:36,284 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:20:36,285 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:20:36,285 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] ('115',)
2025-01-18 22:20:38,714 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:20:38,715 - sqlalchemy.engine.Engine - INFO - [cached since 2.429s ago] ('116',)
2025-01-18 22:20:42,363 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:20:42,363 - sqlalchemy.engine.Engine - INFO - [cached since 9.325s ago] ('528155210',)
2025-01-18 22:20:42,583 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:20:42,583 - sqlalchemy.engine.Engine - INFO - [cached since 9.545s ago] ('432629636',)
2025-01-18 22:20:42,585 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:20:42,585 - sqlalchemy.engine.Engine - INFO - [cached since 12.81s ago] ('432629636',)
2025-01-18 22:20:46,347 - aiogram.event - INFO - Update id=659309778 is handled. Duration 312 ms by bot id=7444575424
2025-01-18 22:20:47,548 - aiogram.event - INFO - Update id=659309779 is handled. Duration 125 ms by bot id=7444575424
2025-01-18 22:20:48,232 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 22:20:48,596 - aiogram.event - INFO - Update id=659309780 is not handled. Duration 360 ms by bot id=7444575424
2025-01-18 22:20:48,597 - aiogram.event - ERROR - Cause exception while process update id=659309780 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: REPLY_MARKUP_BUY_EMPTY
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 76, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: REPLY_MARKUP_BUY_EMPTY
2025-01-18 22:21:36,386 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:21:36,639 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:21:36,641 - root - INFO - Бот остановлен вручную.
2025-01-18 22:21:36,853 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002143157A890>
2025-01-18 22:21:41,597 - root - INFO - Инициализация бота...
2025-01-18 22:21:42,179 - root - INFO - Инициализация бота...
2025-01-18 22:21:42,231 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:21:42,232 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:21:42,232 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:21:42,233 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:21:42,233 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:21:42,234 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:21:42,266 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:21:42,266 - root - INFO - Инициализация диспетчера...
2025-01-18 22:21:42,267 - root - INFO - Регистрация обработчиков...
2025-01-18 22:21:42,269 - root - INFO - Регистрация main menu команд...
2025-01-18 22:21:42,591 - root - INFO - Команды успешно установлены
2025-01-18 22:21:42,591 - root - INFO - Запуск polling...
2025-01-18 22:21:42,591 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:21:42,596 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:21:42,598 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:21:42,599 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ()
2025-01-18 22:21:42,602 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:21:42,602 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ('181151262',)
2025-01-18 22:21:47,648 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:21:47,650 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:21:47,650 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:21:47,650 - sqlalchemy.engine.Engine - INFO - [generated in 0.00021s] ('181151262',)
2025-01-18 22:21:47,708 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:21:48,548 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:21:48,548 - sqlalchemy.engine.Engine - INFO - [cached since 0.8976s ago] ('528155210',)
2025-01-18 22:21:48,549 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:21:48,549 - sqlalchemy.engine.Engine - INFO - [cached since 5.947s ago] ('528155210',)
2025-01-18 22:21:50,778 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:21:50,779 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:21:50,779 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:21:50,780 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] ('115',)
2025-01-18 22:21:53,166 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:21:53,166 - sqlalchemy.engine.Engine - INFO - [cached since 2.387s ago] ('116',)
2025-01-18 22:21:56,947 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:21:56,948 - sqlalchemy.engine.Engine - INFO - [cached since 9.297s ago] ('528155210',)
2025-01-18 22:21:57,155 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:21:57,156 - sqlalchemy.engine.Engine - INFO - [cached since 9.507s ago] ('432629636',)
2025-01-18 22:21:57,161 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:21:57,162 - sqlalchemy.engine.Engine - INFO - [cached since 14.56s ago] ('432629636',)
2025-01-18 22:22:10,223 - aiogram.event - INFO - Update id=659309781 is handled. Duration 297 ms by bot id=7444575424
2025-01-18 22:22:35,176 - aiogram.event - INFO - Update id=659309782 is handled. Duration 327 ms by bot id=7444575424
2025-01-18 22:22:36,447 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=9000)]
2025-01-18 22:22:36,593 - aiogram.event - INFO - Update id=659309783 is not handled. Duration 157 ms by bot id=7444575424
2025-01-18 22:22:36,593 - aiogram.event - ERROR - Cause exception while process update id=659309783 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: REPLY_MARKUP_BUY_EMPTY
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 78, in handle_period_selection
    await bot.send_invoice(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2771, in send_invoice
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: REPLY_MARKUP_BUY_EMPTY
2025-01-18 22:23:45,402 - aiogram.event - INFO - Update id=659309784 is not handled. Duration 0 ms by bot id=7444575424
2025-01-18 22:28:15,304 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:28:15,568 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:28:15,570 - root - INFO - Бот остановлен вручную.
2025-01-18 22:28:15,744 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000026BF22E8710>
2025-01-18 22:28:19,313 - root - INFO - Инициализация бота...
2025-01-18 22:28:19,711 - root - INFO - Инициализация бота...
2025-01-18 22:28:19,752 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:28:19,753 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:28:19,753 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:28:19,754 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:28:19,754 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:28:19,754 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:28:19,779 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:28:19,779 - root - INFO - Инициализация диспетчера...
2025-01-18 22:28:19,780 - root - INFO - Регистрация обработчиков...
2025-01-18 22:28:19,781 - root - INFO - Регистрация main menu команд...
2025-01-18 22:28:20,340 - root - INFO - Команды успешно установлены
2025-01-18 22:28:20,340 - root - INFO - Запуск polling...
2025-01-18 22:28:20,342 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:28:20,353 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:28:20,356 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:28:20,357 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] ()
2025-01-18 22:28:20,361 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:28:20,361 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] ('181151262',)
2025-01-18 22:28:25,333 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:28:25,334 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:28:25,336 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:28:25,337 - sqlalchemy.engine.Engine - INFO - [generated in 0.00062s] ('181151262',)
2025-01-18 22:28:25,418 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:28:25,773 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:28:25,773 - sqlalchemy.engine.Engine - INFO - [cached since 0.4367s ago] ('528155210',)
2025-01-18 22:28:25,774 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:28:25,774 - sqlalchemy.engine.Engine - INFO - [cached since 5.413s ago] ('528155210',)
2025-01-18 22:28:29,870 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:28:29,871 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:28:29,872 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:28:29,872 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] ('115',)
2025-01-18 22:28:33,241 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:28:33,242 - sqlalchemy.engine.Engine - INFO - [cached since 3.37s ago] ('116',)
2025-01-18 22:28:36,720 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:28:36,721 - sqlalchemy.engine.Engine - INFO - [cached since 11.38s ago] ('528155210',)
2025-01-18 22:28:36,847 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:28:36,847 - sqlalchemy.engine.Engine - INFO - [cached since 11.51s ago] ('432629636',)
2025-01-18 22:28:36,848 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:28:36,848 - sqlalchemy.engine.Engine - INFO - [cached since 16.49s ago] ('432629636',)
2025-01-18 22:28:41,809 - aiogram.event - INFO - Update id=659309785 is handled. Duration 389 ms by bot id=7444575424
2025-01-18 22:28:42,992 - aiogram.event - INFO - Update id=659309786 is handled. Duration 172 ms by bot id=7444575424
2025-01-18 22:28:43,971 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 22:28:44,058 - aiogram.event - INFO - Update id=659309787 is not handled. Duration 92 ms by bot id=7444575424
2025-01-18 22:28:44,059 - aiogram.event - ERROR - Cause exception while process update id=659309787 by bot id=7444575424
ValidationError: 1 validation error for InlineKeyboardMarkup
inline_keyboard
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 76, in handle_period_selection
    keyboard = InlineKeyboardMarkup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\pydantic\main.py", line 212, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for InlineKeyboardMarkup
inline_keyboard
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
2025-01-18 22:31:56,729 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:31:56,984 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:31:56,986 - root - INFO - Бот остановлен вручную.
2025-01-18 22:31:57,162 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002375CF9BDD0>
2025-01-18 22:32:00,554 - root - INFO - Инициализация бота...
2025-01-18 22:32:00,975 - root - INFO - Инициализация бота...
2025-01-18 22:32:01,015 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:32:01,015 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:32:01,015 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:32:01,016 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:32:01,016 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:32:01,016 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:32:01,041 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:32:01,041 - root - INFO - Инициализация диспетчера...
2025-01-18 22:32:01,042 - root - INFO - Регистрация обработчиков...
2025-01-18 22:32:01,043 - root - INFO - Регистрация main menu команд...
2025-01-18 22:32:01,406 - root - INFO - Команды успешно установлены
2025-01-18 22:32:01,407 - root - INFO - Запуск polling...
2025-01-18 22:32:01,407 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:32:01,410 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:32:01,412 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:32:01,412 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ()
2025-01-18 22:32:01,414 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:32:01,414 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ('181151262',)
2025-01-18 22:32:05,505 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:32:05,507 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:32:05,510 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:32:05,511 - sqlalchemy.engine.Engine - INFO - [generated in 0.00090s] ('181151262',)
2025-01-18 22:32:05,578 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:32:05,999 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:32:05,999 - sqlalchemy.engine.Engine - INFO - [cached since 0.4895s ago] ('528155210',)
2025-01-18 22:32:06,000 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:32:06,000 - sqlalchemy.engine.Engine - INFO - [cached since 4.586s ago] ('528155210',)
2025-01-18 22:32:10,017 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:32:10,019 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:32:10,022 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:32:10,023 - sqlalchemy.engine.Engine - INFO - [generated in 0.00093s] ('115',)
2025-01-18 22:32:12,108 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:32:12,109 - sqlalchemy.engine.Engine - INFO - [cached since 2.087s ago] ('116',)
2025-01-18 22:32:14,743 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:32:14,743 - sqlalchemy.engine.Engine - INFO - [cached since 9.233s ago] ('528155210',)
2025-01-18 22:32:14,903 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:32:14,903 - sqlalchemy.engine.Engine - INFO - [cached since 9.393s ago] ('432629636',)
2025-01-18 22:32:14,904 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:32:14,904 - sqlalchemy.engine.Engine - INFO - [cached since 13.49s ago] ('432629636',)
2025-01-18 22:32:31,997 - aiogram.event - INFO - Update id=659309788 is handled. Duration 297 ms by bot id=7444575424
2025-01-18 22:32:33,009 - aiogram.event - INFO - Update id=659309789 is handled. Duration 139 ms by bot id=7444575424
2025-01-18 22:32:34,148 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 22:32:34,441 - aiogram.event - INFO - Update id=659309790 is handled. Duration 296 ms by bot id=7444575424
2025-01-18 22:34:25,403 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:34:25,670 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:34:25,676 - root - INFO - Бот остановлен вручную.
2025-01-18 22:34:25,858 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002A876D49B10>
2025-01-18 22:34:28,847 - root - INFO - Инициализация бота...
2025-01-18 22:34:29,187 - root - INFO - Инициализация бота...
2025-01-18 22:34:29,223 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:34:29,224 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:34:29,224 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:34:29,224 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:34:29,224 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:34:29,225 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:34:29,244 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:34:29,244 - root - INFO - Инициализация диспетчера...
2025-01-18 22:34:29,245 - root - INFO - Регистрация обработчиков...
2025-01-18 22:34:29,246 - root - INFO - Регистрация main menu команд...
2025-01-18 22:34:29,632 - root - INFO - Команды успешно установлены
2025-01-18 22:34:29,632 - root - INFO - Запуск polling...
2025-01-18 22:34:29,632 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:34:29,637 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:34:29,639 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:34:29,639 - sqlalchemy.engine.Engine - INFO - [generated in 0.00021s] ()
2025-01-18 22:34:29,641 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:34:29,641 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] ('181151262',)
2025-01-18 22:34:32,549 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:34:32,552 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:34:32,554 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:34:32,554 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] ('181151262',)
2025-01-18 22:34:32,633 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:34:32,881 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:34:32,881 - sqlalchemy.engine.Engine - INFO - [cached since 0.3277s ago] ('528155210',)
2025-01-18 22:34:32,882 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:34:32,882 - sqlalchemy.engine.Engine - INFO - [cached since 3.241s ago] ('528155210',)
2025-01-18 22:34:36,176 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:34:36,178 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:34:36,179 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:34:36,180 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] ('115',)
2025-01-18 22:34:39,075 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:34:39,076 - sqlalchemy.engine.Engine - INFO - [cached since 2.896s ago] ('116',)
2025-01-18 22:34:41,508 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:34:41,509 - sqlalchemy.engine.Engine - INFO - [cached since 8.955s ago] ('528155210',)
2025-01-18 22:34:41,636 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:34:41,636 - sqlalchemy.engine.Engine - INFO - [cached since 9.082s ago] ('432629636',)
2025-01-18 22:34:41,636 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:34:41,636 - sqlalchemy.engine.Engine - INFO - [cached since 12s ago] ('432629636',)
2025-01-18 22:34:46,490 - aiogram.event - INFO - Update id=659309791 is handled. Duration 608 ms by bot id=7444575424
2025-01-18 22:34:47,488 - aiogram.event - INFO - Update id=659309792 is handled. Duration 139 ms by bot id=7444575424
2025-01-18 22:34:48,305 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 22:34:48,528 - aiogram.event - INFO - Update id=659309793 is handled. Duration 234 ms by bot id=7444575424
2025-01-18 22:34:50,026 - aiogram.event - INFO - Update id=659309794 is not handled. Duration 62 ms by bot id=7444575424
2025-01-18 22:34:50,026 - aiogram.event - ERROR - Cause exception while process update id=659309794 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: message can't be edited
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 31, in buy_key_menu
    await callback.message.edit_text(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message can't be edited
2025-01-18 22:35:35,659 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:35:35,913 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:35:35,917 - root - INFO - Бот остановлен вручную.
2025-01-18 22:35:36,125 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000018CE2738B10>
2025-01-18 22:35:39,010 - root - INFO - Инициализация бота...
2025-01-18 22:35:39,347 - root - INFO - Инициализация бота...
2025-01-18 22:35:39,381 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:35:39,381 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:35:39,381 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:35:39,382 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:35:39,382 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:35:39,383 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:35:39,402 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:35:39,402 - root - INFO - Инициализация диспетчера...
2025-01-18 22:35:39,403 - root - INFO - Регистрация обработчиков...
2025-01-18 22:35:39,404 - root - INFO - Регистрация main menu команд...
2025-01-18 22:35:39,766 - root - INFO - Команды успешно установлены
2025-01-18 22:35:39,767 - root - INFO - Запуск polling...
2025-01-18 22:35:39,768 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:35:39,781 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:35:39,784 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:35:39,784 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] ()
2025-01-18 22:35:39,788 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:35:39,789 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] ('181151262',)
2025-01-18 22:35:42,902 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:35:42,904 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:35:42,905 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:35:42,905 - sqlalchemy.engine.Engine - INFO - [generated in 0.00039s] ('181151262',)
2025-01-18 22:35:43,048 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:35:43,899 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:35:43,900 - sqlalchemy.engine.Engine - INFO - [cached since 0.9946s ago] ('528155210',)
2025-01-18 22:35:43,900 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:35:43,900 - sqlalchemy.engine.Engine - INFO - [cached since 4.112s ago] ('528155210',)
2025-01-18 22:35:46,362 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:35:46,363 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:35:46,365 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:35:46,365 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ('115',)
2025-01-18 22:35:48,859 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:35:48,859 - sqlalchemy.engine.Engine - INFO - [cached since 2.494s ago] ('116',)
2025-01-18 22:35:51,261 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:35:51,263 - sqlalchemy.engine.Engine - INFO - [cached since 8.358s ago] ('528155210',)
2025-01-18 22:35:51,445 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:35:51,445 - sqlalchemy.engine.Engine - INFO - [cached since 8.54s ago] ('432629636',)
2025-01-18 22:35:51,446 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:35:51,446 - sqlalchemy.engine.Engine - INFO - [cached since 11.66s ago] ('432629636',)
2025-01-18 22:35:55,045 - aiogram.event - INFO - Update id=659309795 is handled. Duration 296 ms by bot id=7444575424
2025-01-18 22:35:56,404 - aiogram.event - INFO - Update id=659309796 is handled. Duration 172 ms by bot id=7444575424
2025-01-18 22:36:01,461 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=24000)]
2025-01-18 22:36:01,959 - aiogram.event - INFO - Update id=659309797 is handled. Duration 500 ms by bot id=7444575424
2025-01-18 22:36:03,005 - aiogram.event - INFO - Update id=659309798 is not handled. Duration 47 ms by bot id=7444575424
2025-01-18 22:36:03,005 - aiogram.event - ERROR - Cause exception while process update id=659309798 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: message can't be edited
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 31, in buy_key_menu
    await callback.message.edit_text(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message can't be edited
2025-01-18 22:38:39,967 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:38:40,221 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:38:40,222 - root - INFO - Бот остановлен вручную.
2025-01-18 22:38:40,393 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001DC2D660C10>
2025-01-18 22:38:43,551 - root - INFO - Инициализация бота...
2025-01-18 22:38:43,892 - root - INFO - Инициализация бота...
2025-01-18 22:38:43,924 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:38:43,924 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:38:43,925 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:38:43,925 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:38:43,925 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:38:43,926 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:38:43,946 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:38:43,946 - root - INFO - Инициализация диспетчера...
2025-01-18 22:38:43,946 - root - INFO - Регистрация обработчиков...
2025-01-18 22:38:43,947 - root - INFO - Регистрация main menu команд...
2025-01-18 22:38:44,286 - root - INFO - Команды успешно установлены
2025-01-18 22:38:44,287 - root - INFO - Запуск polling...
2025-01-18 22:38:44,287 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:38:44,291 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:38:44,292 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:38:44,292 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ()
2025-01-18 22:38:44,294 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:38:44,295 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ('181151262',)
2025-01-18 22:38:47,360 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:38:47,361 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:38:47,362 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:38:47,362 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('181151262',)
2025-01-18 22:38:47,424 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:38:47,903 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:38:47,904 - sqlalchemy.engine.Engine - INFO - [cached since 0.5416s ago] ('528155210',)
2025-01-18 22:38:47,904 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:38:47,905 - sqlalchemy.engine.Engine - INFO - [cached since 3.61s ago] ('528155210',)
2025-01-18 22:38:51,275 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:38:51,276 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:38:51,277 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:38:51,278 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ('115',)
2025-01-18 22:38:53,424 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:38:53,424 - sqlalchemy.engine.Engine - INFO - [cached since 2.147s ago] ('116',)
2025-01-18 22:38:55,241 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:38:55,241 - sqlalchemy.engine.Engine - INFO - [cached since 7.879s ago] ('528155210',)
2025-01-18 22:38:55,394 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:38:55,395 - sqlalchemy.engine.Engine - INFO - [cached since 8.033s ago] ('432629636',)
2025-01-18 22:38:55,395 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:38:55,395 - sqlalchemy.engine.Engine - INFO - [cached since 11.1s ago] ('432629636',)
2025-01-18 22:38:58,407 - aiogram.event - INFO - Update id=659309799 is handled. Duration 406 ms by bot id=7444575424
2025-01-18 22:39:00,194 - aiogram.event - INFO - Update id=659309800 is handled. Duration 155 ms by bot id=7444575424
2025-01-18 22:39:01,191 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=24000)]
2025-01-18 22:39:01,606 - aiogram.event - INFO - Update id=659309801 is handled. Duration 422 ms by bot id=7444575424
2025-01-18 22:39:03,212 - aiogram.event - INFO - Update id=659309802 is not handled. Duration 46 ms by bot id=7444575424
2025-01-18 22:39:03,213 - aiogram.event - ERROR - Cause exception while process update id=659309802 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: message can't be edited
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 32, in buy_key_menu
    await callback.message.edit_text(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message can't be edited
2025-01-18 22:40:17,610 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:40:17,874 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:40:17,877 - root - INFO - Бот остановлен вручную.
2025-01-18 22:40:18,060 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002E37C41AA10>
2025-01-18 22:40:21,247 - root - INFO - Инициализация бота...
2025-01-18 22:40:21,589 - root - INFO - Инициализация бота...
2025-01-18 22:40:21,623 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:40:21,624 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:40:21,624 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:40:21,624 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:40:21,624 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:40:21,625 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:40:21,645 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:40:21,645 - root - INFO - Инициализация диспетчера...
2025-01-18 22:40:21,645 - root - INFO - Регистрация обработчиков...
2025-01-18 22:40:21,646 - root - INFO - Регистрация main menu команд...
2025-01-18 22:40:22,097 - root - INFO - Команды успешно установлены
2025-01-18 22:40:22,097 - root - INFO - Запуск polling...
2025-01-18 22:40:22,097 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:40:22,108 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:40:22,110 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:40:22,111 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ()
2025-01-18 22:40:22,115 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:40:22,115 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] ('181151262',)
2025-01-18 22:40:26,079 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:40:26,080 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:40:26,081 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:40:26,082 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('181151262',)
2025-01-18 22:40:26,142 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:40:26,315 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:40:26,316 - sqlalchemy.engine.Engine - INFO - [cached since 0.2345s ago] ('528155210',)
2025-01-18 22:40:26,316 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:40:26,316 - sqlalchemy.engine.Engine - INFO - [cached since 4.202s ago] ('528155210',)
2025-01-18 22:40:28,626 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:40:28,627 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:40:28,627 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:40:28,628 - sqlalchemy.engine.Engine - INFO - [generated in 0.00021s] ('115',)
2025-01-18 22:40:32,569 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:40:32,570 - sqlalchemy.engine.Engine - INFO - [cached since 3.942s ago] ('116',)
2025-01-18 22:40:34,540 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:40:34,540 - sqlalchemy.engine.Engine - INFO - [cached since 8.459s ago] ('528155210',)
2025-01-18 22:40:34,690 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:40:34,691 - sqlalchemy.engine.Engine - INFO - [cached since 8.609s ago] ('432629636',)
2025-01-18 22:40:34,692 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:40:34,692 - sqlalchemy.engine.Engine - INFO - [cached since 12.58s ago] ('432629636',)
2025-01-18 22:40:40,961 - aiogram.event - INFO - Update id=659309803 is handled. Duration 343 ms by bot id=7444575424
2025-01-18 22:40:42,121 - aiogram.event - INFO - Update id=659309804 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 22:40:44,879 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=69000)]
2025-01-18 22:40:45,249 - aiogram.event - INFO - Update id=659309805 is handled. Duration 375 ms by bot id=7444575424
2025-01-18 22:40:47,452 - aiogram.event - INFO - Update id=659309806 is not handled. Duration 0 ms by bot id=7444575424
2025-01-18 22:40:47,452 - aiogram.event - ERROR - Cause exception while process update id=659309806 by bot id=7444575424
TypeError: Bot.delete_message() missing 2 required positional arguments: 'chat_id' and 'message_id'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 43, in back_buy_key_menu
    await bot.delete_message()
          ^^^^^^^^^^^^^^^^^^^^
TypeError: Bot.delete_message() missing 2 required positional arguments: 'chat_id' and 'message_id'
2025-01-18 22:40:50,908 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:40:51,171 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:40:51,173 - root - INFO - Бот остановлен вручную.
2025-01-18 22:40:51,345 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001C4489E28D0>
2025-01-18 22:40:51,346 - asyncio - ERROR - Unclosed connector
connections: ['[(<aiohttp.client_proto.ResponseHandler object at 0x000001C44C4CD630>, 105149.718)]']
connector: <aiohttp.connector.TCPConnector object at 0x000001C445246790>
2025-01-18 22:40:54,804 - root - INFO - Инициализация бота...
2025-01-18 22:40:55,153 - root - INFO - Инициализация бота...
2025-01-18 22:40:55,186 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:40:55,186 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:40:55,186 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:40:55,188 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:40:55,188 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:40:55,188 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:40:55,209 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:40:55,210 - root - INFO - Инициализация диспетчера...
2025-01-18 22:40:55,210 - root - INFO - Регистрация обработчиков...
2025-01-18 22:40:55,211 - root - INFO - Регистрация main menu команд...
2025-01-18 22:40:55,659 - root - INFO - Команды успешно установлены
2025-01-18 22:40:55,659 - root - INFO - Запуск polling...
2025-01-18 22:40:55,660 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:40:55,670 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:40:55,674 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:40:55,674 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] ()
2025-01-18 22:40:55,679 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:40:55,679 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] ('181151262',)
2025-01-18 22:40:58,409 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:40:58,410 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:40:58,412 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:40:58,413 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] ('181151262',)
2025-01-18 22:40:58,475 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:40:58,635 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:40:58,636 - sqlalchemy.engine.Engine - INFO - [cached since 0.2237s ago] ('528155210',)
2025-01-18 22:40:58,637 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:40:58,637 - sqlalchemy.engine.Engine - INFO - [cached since 2.958s ago] ('528155210',)
2025-01-18 22:41:01,742 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:41:01,743 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:41:01,744 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:41:01,744 - sqlalchemy.engine.Engine - INFO - [generated in 0.00021s] ('115',)
2025-01-18 22:41:04,831 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:41:04,831 - sqlalchemy.engine.Engine - INFO - [cached since 3.088s ago] ('116',)
2025-01-18 22:41:06,962 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:41:06,962 - sqlalchemy.engine.Engine - INFO - [cached since 8.55s ago] ('528155210',)
2025-01-18 22:41:12,116 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:41:12,116 - sqlalchemy.engine.Engine - INFO - [cached since 13.7s ago] ('432629636',)
2025-01-18 22:41:12,118 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:41:12,118 - sqlalchemy.engine.Engine - INFO - [cached since 16.44s ago] ('432629636',)
2025-01-18 22:41:18,067 - aiogram.event - INFO - Update id=659309807 is handled. Duration 686 ms by bot id=7444575424
2025-01-18 22:41:19,168 - aiogram.event - INFO - Update id=659309808 is handled. Duration 250 ms by bot id=7444575424
2025-01-18 22:41:20,389 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 22:41:22,100 - aiogram.event - INFO - Update id=659309809 is handled. Duration 1703 ms by bot id=7444575424
2025-01-18 22:41:26,651 - aiogram.event - INFO - Update id=659309810 is not handled. Duration 875 ms by bot id=7444575424
2025-01-18 22:41:26,651 - aiogram.event - ERROR - Cause exception while process update id=659309810 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: message to edit not found
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 43, in back_buy_key_menu
    await buy_key_menu(callback, state)
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 31, in buy_key_menu
    await callback.message.edit_text(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message to edit not found
2025-01-18 22:41:36,786 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:44:41,822 - root - INFO - Инициализация бота...
2025-01-18 22:44:42,192 - root - INFO - Инициализация бота...
2025-01-18 22:44:42,227 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:44:42,227 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:44:42,228 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:44:42,228 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:44:42,228 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:44:42,229 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:44:42,253 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:44:42,253 - root - INFO - Инициализация диспетчера...
2025-01-18 22:44:42,254 - root - INFO - Регистрация обработчиков...
2025-01-18 22:44:42,255 - root - INFO - Регистрация main menu команд...
2025-01-18 22:44:42,673 - root - INFO - Команды успешно установлены
2025-01-18 22:44:42,674 - root - INFO - Запуск polling...
2025-01-18 22:44:42,675 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:44:42,684 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:44:42,687 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:44:42,687 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] ()
2025-01-18 22:44:42,691 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:44:42,692 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] ('181151262',)
2025-01-18 22:44:44,518 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:44:44,520 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:44:44,523 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:44:44,524 - sqlalchemy.engine.Engine - INFO - [generated in 0.00078s] ('181151262',)
2025-01-18 22:44:44,619 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:44:44,750 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:44:44,751 - sqlalchemy.engine.Engine - INFO - [cached since 0.2276s ago] ('528155210',)
2025-01-18 22:44:44,751 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:44:44,751 - sqlalchemy.engine.Engine - INFO - [cached since 2.06s ago] ('528155210',)
2025-01-18 22:44:46,733 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:44:46,734 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:44:46,734 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:44:46,734 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] ('115',)
2025-01-18 22:44:50,127 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:44:50,128 - sqlalchemy.engine.Engine - INFO - [cached since 3.393s ago] ('116',)
2025-01-18 22:44:53,087 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:44:53,088 - sqlalchemy.engine.Engine - INFO - [cached since 8.565s ago] ('528155210',)
2025-01-18 22:44:53,241 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:44:53,242 - sqlalchemy.engine.Engine - INFO - [cached since 8.719s ago] ('432629636',)
2025-01-18 22:44:53,242 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:44:53,242 - sqlalchemy.engine.Engine - INFO - [cached since 10.55s ago] ('432629636',)
2025-01-18 22:44:57,471 - aiogram.event - INFO - Update id=659309811 is handled. Duration 407 ms by bot id=7444575424
2025-01-18 22:44:58,636 - aiogram.event - INFO - Update id=659309812 is handled. Duration 139 ms by bot id=7444575424
2025-01-18 22:44:59,516 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 22:44:59,856 - aiogram.event - INFO - Update id=659309813 is handled. Duration 343 ms by bot id=7444575424
2025-01-18 22:45:01,113 - aiogram.event - INFO - Update id=659309814 is not handled. Duration 202 ms by bot id=7444575424
2025-01-18 22:45:01,114 - aiogram.event - ERROR - Cause exception while process update id=659309814 by bot id=7444575424
TypeError: FSMContext.get_data() takes 1 positional argument but 2 were given
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 44, in back_buy_key_menu
    payment_message = await state.get_data("payment_message")
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FSMContext.get_data() takes 1 positional argument but 2 were given
2025-01-18 22:46:40,529 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:46:40,795 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:46:40,797 - root - INFO - Бот остановлен вручную.
2025-01-18 22:46:40,970 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000014CF3FE9E50>
2025-01-18 22:46:44,027 - root - INFO - Инициализация бота...
2025-01-18 22:46:44,370 - root - INFO - Инициализация бота...
2025-01-18 22:46:44,403 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:46:44,403 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:46:44,403 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:46:44,404 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:46:44,404 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:46:44,404 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:46:44,425 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:46:44,425 - root - INFO - Инициализация диспетчера...
2025-01-18 22:46:44,426 - root - INFO - Регистрация обработчиков...
2025-01-18 22:46:44,426 - root - INFO - Регистрация main menu команд...
2025-01-18 22:46:44,811 - root - INFO - Команды успешно установлены
2025-01-18 22:46:44,811 - root - INFO - Запуск polling...
2025-01-18 22:46:44,812 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:46:44,825 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:46:44,828 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:46:44,828 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] ()
2025-01-18 22:46:44,834 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:46:44,834 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] ('181151262',)
2025-01-18 22:46:48,217 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:46:48,218 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:46:48,219 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:46:48,219 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] ('181151262',)
2025-01-18 22:46:48,350 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:46:48,610 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:46:48,610 - sqlalchemy.engine.Engine - INFO - [cached since 0.3926s ago] ('528155210',)
2025-01-18 22:46:48,611 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:46:48,611 - sqlalchemy.engine.Engine - INFO - [cached since 3.778s ago] ('528155210',)
2025-01-18 22:46:50,544 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:46:50,545 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:46:50,546 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:46:50,547 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] ('115',)
2025-01-18 22:46:53,074 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:46:53,075 - sqlalchemy.engine.Engine - INFO - [cached since 2.529s ago] ('116',)
2025-01-18 22:46:55,163 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:46:55,164 - sqlalchemy.engine.Engine - INFO - [cached since 6.945s ago] ('528155210',)
2025-01-18 22:46:55,299 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:46:55,299 - sqlalchemy.engine.Engine - INFO - [cached since 7.081s ago] ('432629636',)
2025-01-18 22:46:55,300 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:46:55,300 - sqlalchemy.engine.Engine - INFO - [cached since 10.47s ago] ('432629636',)
2025-01-18 22:46:59,279 - aiogram.event - INFO - Update id=659309815 is handled. Duration 391 ms by bot id=7444575424
2025-01-18 22:47:01,465 - aiogram.event - INFO - Update id=659309816 is handled. Duration 172 ms by bot id=7444575424
2025-01-18 22:47:02,391 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 22:47:02,906 - aiogram.event - INFO - Update id=659309817 is handled. Duration 516 ms by bot id=7444575424
2025-01-18 22:47:04,336 - aiogram.event - INFO - Update id=659309818 is not handled. Duration 108 ms by bot id=7444575424
2025-01-18 22:47:04,337 - aiogram.event - ERROR - Cause exception while process update id=659309818 by bot id=7444575424
AttributeError: 'function' object has no attribute 'get'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 43, in back_buy_key_menu
    payment_message = await state.get_data.get("payment_message")
                            ^^^^^^^^^^^^^^^^^^
AttributeError: 'function' object has no attribute 'get'
2025-01-18 22:47:21,912 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:47:22,159 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:47:22,162 - root - INFO - Бот остановлен вручную.
2025-01-18 22:47:22,374 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001ABE161E050>
2025-01-18 22:47:25,300 - root - INFO - Инициализация бота...
2025-01-18 22:47:25,642 - root - INFO - Инициализация бота...
2025-01-18 22:47:25,675 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:47:25,675 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:47:25,675 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:47:25,676 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:47:25,676 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:47:25,677 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:47:25,697 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:47:25,697 - root - INFO - Инициализация диспетчера...
2025-01-18 22:47:25,697 - root - INFO - Регистрация обработчиков...
2025-01-18 22:47:25,698 - root - INFO - Регистрация main menu команд...
2025-01-18 22:47:26,161 - root - INFO - Команды успешно установлены
2025-01-18 22:47:26,161 - root - INFO - Запуск polling...
2025-01-18 22:47:26,162 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:47:26,165 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:47:26,167 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:47:26,167 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ()
2025-01-18 22:47:26,169 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:47:26,169 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ('181151262',)
2025-01-18 22:47:29,132 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:47:29,133 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:47:29,134 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:47:29,135 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] ('181151262',)
2025-01-18 22:47:29,195 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:47:29,476 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:47:29,476 - sqlalchemy.engine.Engine - INFO - [cached since 0.3414s ago] ('528155210',)
2025-01-18 22:47:29,476 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:47:29,477 - sqlalchemy.engine.Engine - INFO - [cached since 3.307s ago] ('528155210',)
2025-01-18 22:47:32,264 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:47:32,266 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:47:32,267 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:47:32,268 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ('115',)
2025-01-18 22:47:35,348 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:47:35,349 - sqlalchemy.engine.Engine - INFO - [cached since 3.082s ago] ('116',)
2025-01-18 22:47:38,114 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:47:38,115 - sqlalchemy.engine.Engine - INFO - [cached since 8.981s ago] ('528155210',)
2025-01-18 22:47:38,243 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:47:38,243 - sqlalchemy.engine.Engine - INFO - [cached since 9.109s ago] ('432629636',)
2025-01-18 22:47:38,244 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:47:38,244 - sqlalchemy.engine.Engine - INFO - [cached since 12.08s ago] ('432629636',)
2025-01-18 22:47:41,811 - aiogram.event - INFO - Update id=659309819 is handled. Duration 561 ms by bot id=7444575424
2025-01-18 22:47:42,926 - aiogram.event - INFO - Update id=659309820 is handled. Duration 250 ms by bot id=7444575424
2025-01-18 22:47:43,887 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=24000)]
2025-01-18 22:47:44,115 - aiogram.event - INFO - Update id=659309821 is handled. Duration 218 ms by bot id=7444575424
2025-01-18 22:47:45,645 - aiogram.event - INFO - Update id=659309822 is not handled. Duration 62 ms by bot id=7444575424
2025-01-18 22:47:45,645 - aiogram.event - ERROR - Cause exception while process update id=659309822 by bot id=7444575424
AttributeError: 'coroutine' object has no attribute 'get'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 43, in back_buy_key_menu
    payment_message = await state.get_data().get("payment_message")
                            ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'get'
2025-01-18 22:48:33,939 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:48:34,200 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:48:34,201 - root - INFO - Бот остановлен вручную.
2025-01-18 22:48:34,370 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001959E099E10>
2025-01-18 22:48:37,931 - root - INFO - Инициализация бота...
2025-01-18 22:48:38,284 - root - INFO - Инициализация бота...
2025-01-18 22:48:38,357 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:48:38,357 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:48:38,357 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:48:38,358 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:48:38,358 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:48:38,359 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:48:38,414 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:48:38,414 - root - INFO - Инициализация диспетчера...
2025-01-18 22:48:38,417 - root - INFO - Регистрация обработчиков...
2025-01-18 22:48:38,419 - root - INFO - Регистрация main menu команд...
2025-01-18 22:48:38,717 - root - INFO - Команды успешно установлены
2025-01-18 22:48:38,717 - root - INFO - Запуск polling...
2025-01-18 22:48:38,717 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:48:38,721 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:48:38,723 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:48:38,723 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] ()
2025-01-18 22:48:38,726 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:48:38,726 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] ('181151262',)
2025-01-18 22:48:41,335 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:48:41,338 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:48:41,342 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:48:41,343 - sqlalchemy.engine.Engine - INFO - [generated in 0.00108s] ('181151262',)
2025-01-18 22:48:41,408 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:48:41,664 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:48:41,664 - sqlalchemy.engine.Engine - INFO - [cached since 0.3219s ago] ('528155210',)
2025-01-18 22:48:41,664 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:48:41,665 - sqlalchemy.engine.Engine - INFO - [cached since 2.938s ago] ('528155210',)
2025-01-18 22:48:43,801 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:48:43,803 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:48:43,804 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:48:43,804 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] ('115',)
2025-01-18 22:48:46,180 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:48:46,181 - sqlalchemy.engine.Engine - INFO - [cached since 2.377s ago] ('116',)
2025-01-18 22:48:49,201 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:48:49,201 - sqlalchemy.engine.Engine - INFO - [cached since 7.86s ago] ('528155210',)
2025-01-18 22:48:49,467 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:48:49,468 - sqlalchemy.engine.Engine - INFO - [cached since 8.126s ago] ('432629636',)
2025-01-18 22:48:49,468 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:48:49,469 - sqlalchemy.engine.Engine - INFO - [cached since 10.74s ago] ('432629636',)
2025-01-18 22:48:52,404 - aiogram.event - INFO - Update id=659309823 is handled. Duration 422 ms by bot id=7444575424
2025-01-18 22:48:53,588 - aiogram.event - INFO - Update id=659309824 is handled. Duration 125 ms by bot id=7444575424
2025-01-18 22:48:54,276 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 22:48:54,492 - aiogram.event - INFO - Update id=659309825 is handled. Duration 218 ms by bot id=7444575424
2025-01-18 22:48:55,629 - aiogram.event - INFO - Update id=659309826 is not handled. Duration 93 ms by bot id=7444575424
2025-01-18 22:48:55,629 - aiogram.event - ERROR - Cause exception while process update id=659309826 by bot id=7444575424
AttributeError: 'int' object has no attribute 'edit_text'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 45, in back_buy_key_menu
    await payment_message.edit_text(
          ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'int' object has no attribute 'edit_text'
2025-01-18 22:52:11,392 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:52:11,647 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:52:11,654 - root - INFO - Бот остановлен вручную.
2025-01-18 22:52:11,833 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000250537FA010>
2025-01-18 22:52:14,810 - root - INFO - Инициализация бота...
2025-01-18 22:52:15,155 - root - INFO - Инициализация бота...
2025-01-18 22:52:15,188 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:52:15,188 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:52:15,188 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:52:15,189 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:52:15,189 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:52:15,189 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:52:15,219 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:52:15,219 - root - INFO - Инициализация диспетчера...
2025-01-18 22:52:15,220 - root - INFO - Регистрация обработчиков...
2025-01-18 22:52:15,221 - root - INFO - Регистрация main menu команд...
2025-01-18 22:52:15,505 - root - INFO - Команды успешно установлены
2025-01-18 22:52:15,505 - root - INFO - Запуск polling...
2025-01-18 22:52:15,506 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:52:15,519 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:52:15,523 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:52:15,523 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] ()
2025-01-18 22:52:15,527 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:52:15,527 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] ('181151262',)
2025-01-18 22:52:17,973 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:52:17,974 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:52:17,976 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:52:17,977 - sqlalchemy.engine.Engine - INFO - [generated in 0.00099s] ('181151262',)
2025-01-18 22:52:18,042 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:52:18,431 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:52:18,431 - sqlalchemy.engine.Engine - INFO - [cached since 0.4551s ago] ('528155210',)
2025-01-18 22:52:18,431 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:52:18,432 - sqlalchemy.engine.Engine - INFO - [cached since 2.904s ago] ('528155210',)
2025-01-18 22:52:21,344 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:52:21,344 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:52:21,346 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:52:21,347 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] ('115',)
2025-01-18 22:52:23,137 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:52:23,137 - sqlalchemy.engine.Engine - INFO - [cached since 1.791s ago] ('116',)
2025-01-18 22:52:25,584 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:52:25,585 - sqlalchemy.engine.Engine - INFO - [cached since 7.609s ago] ('528155210',)
2025-01-18 22:52:25,779 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:52:25,779 - sqlalchemy.engine.Engine - INFO - [cached since 7.804s ago] ('432629636',)
2025-01-18 22:52:25,780 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:52:25,780 - sqlalchemy.engine.Engine - INFO - [cached since 10.25s ago] ('432629636',)
2025-01-18 22:52:29,487 - aiogram.event - INFO - Update id=659309827 is handled. Duration 531 ms by bot id=7444575424
2025-01-18 22:52:30,804 - aiogram.event - INFO - Update id=659309828 is handled. Duration 281 ms by bot id=7444575424
2025-01-18 22:52:31,511 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 22:52:31,732 - aiogram.event - INFO - Update id=659309829 is handled. Duration 218 ms by bot id=7444575424
2025-01-18 22:52:33,003 - aiogram.event - INFO - Update id=659309830 is not handled. Duration 63 ms by bot id=7444575424
2025-01-18 22:52:33,003 - aiogram.event - ERROR - Cause exception while process update id=659309830 by bot id=7444575424
AttributeError: 'Bot' object has no attribute 'get_message'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 47, in back_buy_key_menu
    payment_message = await bot.get_message(chat_id=callback.message.chat.id, message_id=payment_message_id)
                            ^^^^^^^^^^^^^^^
AttributeError: 'Bot' object has no attribute 'get_message'
2025-01-18 22:53:09,662 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:53:09,926 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:53:09,929 - root - INFO - Бот остановлен вручную.
2025-01-18 22:53:10,109 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000227E03CA690>
2025-01-18 22:53:13,209 - root - INFO - Инициализация бота...
2025-01-18 22:53:13,549 - root - INFO - Инициализация бота...
2025-01-18 22:53:13,582 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:53:13,582 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:53:13,582 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:53:13,583 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:53:13,583 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:53:13,583 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:53:13,603 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:53:13,603 - root - INFO - Инициализация диспетчера...
2025-01-18 22:53:13,603 - root - INFO - Регистрация обработчиков...
2025-01-18 22:53:13,604 - root - INFO - Регистрация main menu команд...
2025-01-18 22:53:14,099 - root - INFO - Команды успешно установлены
2025-01-18 22:53:14,099 - root - INFO - Запуск polling...
2025-01-18 22:53:14,100 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:53:14,111 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:53:14,114 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:53:14,114 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ()
2025-01-18 22:53:14,118 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:53:14,118 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] ('181151262',)
2025-01-18 22:53:16,468 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:53:16,471 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:53:16,474 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:53:16,475 - sqlalchemy.engine.Engine - INFO - [generated in 0.00124s] ('181151262',)
2025-01-18 22:53:16,555 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:53:16,836 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:53:16,836 - sqlalchemy.engine.Engine - INFO - [cached since 0.3623s ago] ('528155210',)
2025-01-18 22:53:16,836 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:53:16,837 - sqlalchemy.engine.Engine - INFO - [cached since 2.719s ago] ('528155210',)
2025-01-18 22:53:19,666 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:53:19,667 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:53:19,669 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:53:19,669 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] ('115',)
2025-01-18 22:53:21,885 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:53:21,885 - sqlalchemy.engine.Engine - INFO - [cached since 2.217s ago] ('116',)
2025-01-18 22:53:24,457 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:53:24,458 - sqlalchemy.engine.Engine - INFO - [cached since 7.984s ago] ('528155210',)
2025-01-18 22:53:24,583 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:53:24,583 - sqlalchemy.engine.Engine - INFO - [cached since 8.109s ago] ('432629636',)
2025-01-18 22:53:24,584 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:53:24,584 - sqlalchemy.engine.Engine - INFO - [cached since 10.47s ago] ('432629636',)
2025-01-18 22:53:27,433 - aiogram.event - INFO - Update id=659309831 is handled. Duration 342 ms by bot id=7444575424
2025-01-18 22:53:28,294 - aiogram.event - INFO - Update id=659309832 is handled. Duration 171 ms by bot id=7444575424
2025-01-18 22:53:29,040 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 22:53:29,294 - aiogram.event - INFO - Update id=659309833 is handled. Duration 265 ms by bot id=7444575424
2025-01-18 22:53:30,289 - aiogram.event - INFO - Update id=659309834 is not handled. Duration 62 ms by bot id=7444575424
2025-01-18 22:53:30,289 - aiogram.event - ERROR - Cause exception while process update id=659309834 by bot id=7444575424
AttributeError: 'Bot' object has no attribute 'get_chat_message'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 47, in back_buy_key_menu
    payment_message = await bot.get_chat_message(chat_id=callback.message.chat.id, message_id=payment_message_id)
                            ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Bot' object has no attribute 'get_chat_message'
2025-01-18 22:54:37,837 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:54:38,092 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:54:38,093 - root - INFO - Бот остановлен вручную.
2025-01-18 22:54:38,270 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001F010B41B50>
2025-01-18 22:54:41,237 - root - INFO - Инициализация бота...
2025-01-18 22:54:41,578 - root - INFO - Инициализация бота...
2025-01-18 22:54:41,610 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:54:41,611 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:54:41,611 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:54:41,612 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:54:41,612 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:54:41,612 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:54:41,632 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:54:41,632 - root - INFO - Инициализация диспетчера...
2025-01-18 22:54:41,633 - root - INFO - Регистрация обработчиков...
2025-01-18 22:54:41,634 - root - INFO - Регистрация main menu команд...
2025-01-18 22:54:41,928 - root - INFO - Команды успешно установлены
2025-01-18 22:54:41,928 - root - INFO - Запуск polling...
2025-01-18 22:54:41,928 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:54:41,933 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:54:41,935 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:54:41,935 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] ()
2025-01-18 22:54:41,938 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:54:41,938 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] ('181151262',)
2025-01-18 22:54:46,081 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:54:46,082 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:54:46,083 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:54:46,083 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] ('181151262',)
2025-01-18 22:54:46,146 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:54:46,501 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:54:46,501 - sqlalchemy.engine.Engine - INFO - [cached since 0.4182s ago] ('528155210',)
2025-01-18 22:54:46,502 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:54:46,502 - sqlalchemy.engine.Engine - INFO - [cached since 4.564s ago] ('528155210',)
2025-01-18 22:54:48,288 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:54:48,290 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:54:48,292 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:54:48,293 - sqlalchemy.engine.Engine - INFO - [generated in 0.00086s] ('115',)
2025-01-18 22:54:51,209 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:54:51,209 - sqlalchemy.engine.Engine - INFO - [cached since 2.918s ago] ('116',)
2025-01-18 22:54:53,335 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:54:53,336 - sqlalchemy.engine.Engine - INFO - [cached since 7.253s ago] ('528155210',)
2025-01-18 22:54:53,470 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:54:53,471 - sqlalchemy.engine.Engine - INFO - [cached since 7.387s ago] ('432629636',)
2025-01-18 22:54:53,471 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:54:53,472 - sqlalchemy.engine.Engine - INFO - [cached since 11.53s ago] ('432629636',)
2025-01-18 22:54:57,897 - aiogram.event - INFO - Update id=659309835 is handled. Duration 296 ms by bot id=7444575424
2025-01-18 22:54:59,437 - aiogram.event - INFO - Update id=659309836 is handled. Duration 186 ms by bot id=7444575424
2025-01-18 22:55:00,219 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 22:55:00,590 - aiogram.event - INFO - Update id=659309837 is handled. Duration 375 ms by bot id=7444575424
2025-01-18 22:55:01,833 - aiogram.event - INFO - Update id=659309838 is handled. Duration 233 ms by bot id=7444575424
2025-01-18 22:55:07,189 - aiogram.event - INFO - Update id=659309839 is handled. Duration 280 ms by bot id=7444575424
2025-01-18 22:55:08,997 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:55:18,133 - root - INFO - Инициализация бота...
2025-01-18 22:55:18,489 - root - INFO - Инициализация бота...
2025-01-18 22:55:18,522 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:55:18,522 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:55:18,522 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:55:18,523 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:55:18,523 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:55:18,523 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:55:18,543 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:55:18,543 - root - INFO - Инициализация диспетчера...
2025-01-18 22:55:18,543 - root - INFO - Регистрация обработчиков...
2025-01-18 22:55:18,544 - root - INFO - Регистрация main menu команд...
2025-01-18 22:55:18,989 - root - INFO - Команды успешно установлены
2025-01-18 22:55:18,989 - root - INFO - Запуск polling...
2025-01-18 22:55:18,989 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:55:18,998 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:55:19,001 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:55:19,001 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s] ()
2025-01-18 22:55:19,006 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:55:19,006 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] ('181151262',)
2025-01-18 22:55:22,248 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:55:22,250 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:55:22,251 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:55:22,251 - sqlalchemy.engine.Engine - INFO - [generated in 0.00021s] ('181151262',)
2025-01-18 22:55:22,319 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:55:22,561 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:55:22,561 - sqlalchemy.engine.Engine - INFO - [cached since 0.3105s ago] ('528155210',)
2025-01-18 22:55:22,562 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:55:22,562 - sqlalchemy.engine.Engine - INFO - [cached since 3.557s ago] ('528155210',)
2025-01-18 22:55:25,805 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:55:25,807 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:55:25,809 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:55:25,809 - sqlalchemy.engine.Engine - INFO - [generated in 0.00085s] ('115',)
2025-01-18 22:55:28,259 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:55:28,260 - sqlalchemy.engine.Engine - INFO - [cached since 2.451s ago] ('116',)
2025-01-18 22:55:30,975 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:55:30,976 - sqlalchemy.engine.Engine - INFO - [cached since 8.724s ago] ('528155210',)
2025-01-18 22:55:31,237 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:55:31,238 - sqlalchemy.engine.Engine - INFO - [cached since 8.986s ago] ('432629636',)
2025-01-18 22:55:31,239 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:55:31,239 - sqlalchemy.engine.Engine - INFO - [cached since 12.23s ago] ('432629636',)
2025-01-18 22:55:34,373 - aiogram.event - INFO - Update id=659309840 is handled. Duration 391 ms by bot id=7444575424
2025-01-18 22:55:35,486 - aiogram.event - INFO - Update id=659309841 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 22:55:36,563 - aiogram.event - INFO - Update id=659309842 is handled. Duration 171 ms by bot id=7444575424
2025-01-18 22:55:37,701 - aiogram.event - INFO - Update id=659309843 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 22:55:38,452 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=24000)]
2025-01-18 22:55:38,901 - aiogram.event - INFO - Update id=659309844 is handled. Duration 453 ms by bot id=7444575424
2025-01-18 22:55:43,197 - aiogram.event - INFO - Update id=659309845 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 22:55:47,033 - aiogram.event - INFO - Update id=659309846 is not handled. Duration 0 ms by bot id=7444575424
2025-01-18 22:55:59,352 - aiogram.event - INFO - Update id=659309847 is not handled. Duration 0 ms by bot id=7444575424
2025-01-18 22:56:01,716 - aiogram.event - INFO - Update id=659309848 is handled. Duration 297 ms by bot id=7444575424
2025-01-18 22:56:03,384 - aiogram.event - INFO - Update id=659309849 is handled. Duration 422 ms by bot id=7444575424
2025-01-18 22:56:03,912 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 22:56:04,446 - aiogram.event - INFO - Update id=659309850 is handled. Duration 530 ms by bot id=7444575424
2025-01-18 22:56:05,584 - aiogram.event - INFO - Update id=659309851 is handled. Duration 141 ms by bot id=7444575424
2025-01-18 22:56:07,145 - aiogram.event - INFO - Update id=659309852 is not handled. Duration 0 ms by bot id=7444575424
2025-01-18 22:56:21,990 - aiogram.event - INFO - Update id=659309853 is not handled. Duration 0 ms by bot id=7444575424
2025-01-18 22:56:42,879 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 22:56:43,145 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:56:43,147 - root - INFO - Бот остановлен вручную.
2025-01-18 22:56:43,370 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001A00EC5EDD0>
2025-01-18 22:56:46,492 - root - INFO - Инициализация бота...
2025-01-18 22:56:46,858 - root - INFO - Инициализация бота...
2025-01-18 22:56:46,889 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:56:46,889 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 22:56:46,889 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:56:46,890 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 22:56:46,890 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 22:56:46,891 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:56:46,911 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 22:56:46,911 - root - INFO - Инициализация диспетчера...
2025-01-18 22:56:46,911 - root - INFO - Регистрация обработчиков...
2025-01-18 22:56:46,912 - root - INFO - Регистрация main menu команд...
2025-01-18 22:56:47,252 - root - INFO - Команды успешно установлены
2025-01-18 22:56:47,252 - root - INFO - Запуск polling...
2025-01-18 22:56:47,252 - aiogram.dispatcher - INFO - Start polling
2025-01-18 22:56:47,256 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:56:47,258 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 22:56:47,258 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ()
2025-01-18 22:56:47,260 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:56:47,261 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] ('181151262',)
2025-01-18 22:56:49,489 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:56:49,490 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:56:49,491 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:56:49,491 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] ('181151262',)
2025-01-18 22:56:49,551 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 22:56:49,786 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:56:49,786 - sqlalchemy.engine.Engine - INFO - [cached since 0.2956s ago] ('528155210',)
2025-01-18 22:56:49,787 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:56:49,787 - sqlalchemy.engine.Engine - INFO - [cached since 2.527s ago] ('528155210',)
2025-01-18 22:56:52,441 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 22:56:52,442 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 22:56:52,443 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:56:52,443 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] ('115',)
2025-01-18 22:56:54,262 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 22:56:54,263 - sqlalchemy.engine.Engine - INFO - [cached since 1.82s ago] ('116',)
2025-01-18 22:56:57,250 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:56:57,250 - sqlalchemy.engine.Engine - INFO - [cached since 7.76s ago] ('528155210',)
2025-01-18 22:56:57,412 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 22:56:57,412 - sqlalchemy.engine.Engine - INFO - [cached since 7.921s ago] ('432629636',)
2025-01-18 22:56:57,413 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 22:56:57,413 - sqlalchemy.engine.Engine - INFO - [cached since 10.15s ago] ('432629636',)
2025-01-18 22:57:00,464 - aiogram.event - INFO - Update id=659309854 is handled. Duration 422 ms by bot id=7444575424
2025-01-18 22:57:01,948 - aiogram.event - INFO - Update id=659309855 is handled. Duration 233 ms by bot id=7444575424
2025-01-18 22:57:03,118 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=9000)]
2025-01-18 22:57:03,404 - aiogram.event - INFO - Update id=659309856 is handled. Duration 297 ms by bot id=7444575424
2025-01-18 22:57:05,027 - aiogram.event - INFO - Update id=659309857 is handled. Duration 422 ms by bot id=7444575424
2025-01-18 22:57:06,005 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=9000)]
2025-01-18 22:57:06,340 - aiogram.event - INFO - Update id=659309858 is handled. Duration 343 ms by bot id=7444575424
2025-01-18 22:57:07,879 - aiogram.event - INFO - Update id=659309859 is handled. Duration 250 ms by bot id=7444575424
2025-01-18 22:57:09,291 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 22:57:09,977 - aiogram.event - INFO - Update id=659309860 is handled. Duration 687 ms by bot id=7444575424
2025-01-18 22:57:11,059 - aiogram.event - INFO - Update id=659309861 is handled. Duration 139 ms by bot id=7444575424
2025-01-18 22:57:12,440 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=9000)]
2025-01-18 22:57:12,691 - aiogram.event - INFO - Update id=659309862 is handled. Duration 250 ms by bot id=7444575424
2025-01-18 22:57:14,287 - aiogram.event - INFO - Update id=659309863 is handled. Duration 281 ms by bot id=7444575424
2025-01-18 22:57:15,912 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=24000)]
2025-01-18 22:57:16,328 - aiogram.event - INFO - Update id=659309864 is handled. Duration 421 ms by bot id=7444575424
2025-01-18 22:57:17,823 - aiogram.event - INFO - Update id=659309865 is handled. Duration 375 ms by bot id=7444575424
2025-01-18 22:57:24,521 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=9000)]
2025-01-18 22:57:24,829 - aiogram.event - INFO - Update id=659309866 is handled. Duration 312 ms by bot id=7444575424
2025-01-18 22:57:26,186 - aiogram.event - INFO - Update id=659309867 is handled. Duration 217 ms by bot id=7444575424
2025-01-18 22:57:27,744 - aiogram.event - INFO - Update id=659309868 is handled. Duration 172 ms by bot id=7444575424
2025-01-18 22:57:28,779 - aiogram.event - INFO - Update id=659309869 is handled. Duration 141 ms by bot id=7444575424
2025-01-18 22:57:29,608 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=69000)]
2025-01-18 22:57:29,880 - aiogram.event - INFO - Update id=659309870 is handled. Duration 266 ms by bot id=7444575424
2025-01-18 22:57:31,241 - aiogram.event - INFO - Update id=659309871 is handled. Duration 233 ms by bot id=7444575424
2025-01-18 22:57:32,300 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=24000)]
2025-01-18 22:57:32,679 - aiogram.event - INFO - Update id=659309872 is handled. Duration 375 ms by bot id=7444575424
2025-01-18 22:57:33,811 - aiogram.event - INFO - Update id=659309873 is handled. Duration 171 ms by bot id=7444575424
2025-01-18 22:57:34,887 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=24000)]
2025-01-18 22:57:35,158 - aiogram.event - INFO - Update id=659309874 is handled. Duration 266 ms by bot id=7444575424
2025-01-18 22:57:36,243 - aiogram.event - INFO - Update id=659309875 is handled. Duration 187 ms by bot id=7444575424
2025-01-18 22:57:37,248 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=9000)]
2025-01-18 22:57:37,490 - aiogram.event - INFO - Update id=659309876 is handled. Duration 233 ms by bot id=7444575424
2025-01-18 22:57:38,651 - aiogram.event - INFO - Update id=659309877 is handled. Duration 250 ms by bot id=7444575424
2025-01-18 23:00:21,872 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:00:21,881 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:00:21,881 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] ('528155210', 1, 0)
2025-01-18 23:00:22,083 - aiogram.event - INFO - Update id=659309878 is handled. Duration 218 ms by bot id=7444575424
2025-01-18 23:00:23,667 - aiogram.event - INFO - Update id=659309879 is handled. Duration 110 ms by bot id=7444575424
2025-01-18 23:00:25,154 - aiogram.event - INFO - Update id=659309880 is handled. Duration 219 ms by bot id=7444575424
2025-01-18 23:00:26,342 - aiogram.event - INFO - Update id=659309881 is handled. Duration 297 ms by bot id=7444575424
2025-01-18 23:00:27,248 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 23:00:27,699 - aiogram.event - INFO - Update id=659309882 is handled. Duration 452 ms by bot id=7444575424
2025-01-18 23:00:28,918 - aiogram.event - INFO - Update id=659309883 is not handled. Duration 62 ms by bot id=7444575424
2025-01-18 23:00:28,918 - aiogram.event - ERROR - Cause exception while process update id=659309883 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: message can't be edited
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\utils_router.py", line 43, in back_button
    await callback.message.edit_text(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message can't be edited
2025-01-18 23:06:06,142 - aiogram.event - INFO - Update id=659309884 is not handled. Duration 0 ms by bot id=7444575424
2025-01-18 23:06:16,962 - aiogram.event - INFO - Update id=659309885 is handled. Duration 171 ms by bot id=7444575424
2025-01-18 23:06:18,835 - aiogram.event - INFO - Update id=659309886 is handled. Duration 327 ms by bot id=7444575424
2025-01-18 23:06:20,008 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 23:06:20,241 - aiogram.event - INFO - Update id=659309887 is handled. Duration 233 ms by bot id=7444575424
2025-01-18 23:06:21,466 - aiogram.event - INFO - Update id=659309888 is handled. Duration 203 ms by bot id=7444575424
2025-01-18 23:06:22,860 - aiogram.event - INFO - Update id=659309889 is handled. Duration 233 ms by bot id=7444575424
2025-01-18 23:06:24,438 - aiogram.event - INFO - Update id=659309890 is handled. Duration 250 ms by bot id=7444575424
2025-01-18 23:06:25,648 - aiogram.event - INFO - Update id=659309891 is handled. Duration 264 ms by bot id=7444575424
2025-01-18 23:06:26,332 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:06:26,332 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:06:26,332 - sqlalchemy.engine.Engine - INFO - [cached since 364.5s ago] ('528155210', 1, 0)
2025-01-18 23:06:26,333 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:06:26,334 - sqlalchemy.engine.Engine - INFO - [cached since 579.1s ago] ('528155210',)
2025-01-18 23:06:34,480 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-18 23:06:34,554 - aiogram.event - INFO - Update id=659309892 is handled. Duration 8218 ms by bot id=7444575424
2025-01-18 23:06:40,548 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:06:40,550 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:06:40,551 - sqlalchemy.engine.Engine - INFO - [generated in 0.00075s] ('115', 1, 0)
2025-01-18 23:06:40,678 - aiogram.event - INFO - Update id=659309893 is handled. Duration 2702 ms by bot id=7444575424
2025-01-18 23:06:44,956 - aiogram.event - INFO - Update id=659309894 is handled. Duration 202 ms by bot id=7444575424
2025-01-18 23:06:48,405 - aiogram.event - INFO - Update id=659309895 is handled. Duration 78 ms by bot id=7444575424
2025-01-18 23:06:49,886 - aiogram.event - INFO - Update id=659309896 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 23:06:51,771 - aiogram.event - INFO - Update id=659309897 is handled. Duration 343 ms by bot id=7444575424
2025-01-18 23:08:23,324 - aiogram.event - INFO - Update id=659309898 is handled. Duration 812 ms by bot id=7444575424
2025-01-18 23:08:24,091 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=69000)]
2025-01-18 23:08:24,433 - aiogram.event - INFO - Update id=659309899 is handled. Duration 342 ms by bot id=7444575424
2025-01-18 23:08:26,920 - aiogram.event - INFO - Update id=659309900 is handled. Duration 281 ms by bot id=7444575424
2025-01-18 23:08:28,861 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=24000)]
2025-01-18 23:08:29,157 - aiogram.event - INFO - Update id=659309901 is handled. Duration 297 ms by bot id=7444575424
2025-01-18 23:08:30,326 - aiogram.event - INFO - Update id=659309902 is handled. Duration 218 ms by bot id=7444575424
2025-01-18 23:08:32,858 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=69000)]
2025-01-18 23:08:33,285 - aiogram.event - INFO - Update id=659309903 is handled. Duration 422 ms by bot id=7444575424
2025-01-18 23:08:35,104 - aiogram.event - INFO - Update id=659309904 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 23:08:36,338 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=24000)]
2025-01-18 23:08:36,555 - aiogram.event - INFO - Update id=659309905 is handled. Duration 218 ms by bot id=7444575424
2025-01-18 23:08:38,455 - aiogram.event - INFO - Update id=659309906 is not handled. Duration 62 ms by bot id=7444575424
2025-01-18 23:08:38,455 - aiogram.event - ERROR - Cause exception while process update id=659309906 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: message can't be edited
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\utils_router.py", line 43, in back_button
    await callback.message.edit_text(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message can't be edited
2025-01-18 23:13:55,775 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:13:56,040 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 23:13:56,042 - root - INFO - Бот остановлен вручную.
2025-01-18 23:13:56,227 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001C52FEB8B50>
2025-01-18 23:13:59,679 - root - INFO - Инициализация бота...
2025-01-18 23:14:00,030 - root - INFO - Инициализация бота...
2025-01-18 23:14:00,067 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:14:00,067 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:14:00,067 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:14:00,068 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:14:00,068 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:14:00,068 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:14:00,095 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:14:00,095 - root - INFO - Инициализация диспетчера...
2025-01-18 23:14:00,096 - root - INFO - Регистрация обработчиков...
2025-01-18 23:14:00,097 - root - INFO - Регистрация main menu команд...
2025-01-18 23:14:55,064 - root - INFO - Бот остановлен вручную.
2025-01-18 23:14:55,210 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000024DE6075410>
2025-01-18 23:14:58,865 - root - INFO - Инициализация бота...
2025-01-18 23:14:59,220 - root - INFO - Инициализация бота...
2025-01-18 23:14:59,254 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:14:59,254 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:14:59,254 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:14:59,255 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:14:59,255 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:14:59,255 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:14:59,272 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:14:59,273 - root - INFO - Инициализация диспетчера...
2025-01-18 23:14:59,273 - root - INFO - Регистрация обработчиков...
2025-01-18 23:14:59,274 - root - INFO - Регистрация main menu команд...
2025-01-18 23:15:59,295 - root - ERROR - Ошибка при установке команд: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]
2025-01-18 23:15:59,296 - root - INFO - Запуск polling...
2025-01-18 23:15:59,297 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:15:59,318 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:15:59,323 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:15:59,323 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ()
2025-01-18 23:15:59,330 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:15:59,330 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] ('181151262',)
2025-01-18 23:16:01,691 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:16:01,694 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:16:01,697 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:16:01,697 - sqlalchemy.engine.Engine - INFO - [generated in 0.00093s] ('181151262',)
2025-01-18 23:17:01,715 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:17:01,778 - root - ERROR - Ошибка проверки базы данных: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]
2025-01-18 23:17:01,778 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-3' coro=<DbProcessor.check_db() done, defined at C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py:65> exception=TelegramNetworkError('HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]')>
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1116, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs, sock=sock)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1112, in create_connection
    transport, protocol = await self._create_connection_transport(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1145, in _create_connection_transport
    await waiter
ConnectionAbortedError: SSL handshake is taking longer than 60.0 seconds: aborting the connection

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 181, in make_request
    async with session.post(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 1360, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 663, in _request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 538, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1050, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1384, in _create_direct_connection
    raise last_exc
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1353, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1124, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py", line 94, in check_db
    await send_message_subscription_expired(
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\utils\send_message.py", line 48, in send_message_subscription_expired
    await bot.send_message(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2962, in send_message
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 188, in make_request
    raise TelegramNetworkError(method=method, message=f"{type(e).__name__}: {e}")
aiogram.exceptions.TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]
2025-01-18 23:17:01,983 - root - ERROR - Произошла ошибка при запуске бота: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]
2025-01-18 23:17:02,145 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000025614B3DD10>
2025-01-18 23:17:09,518 - root - INFO - Инициализация бота...
2025-01-18 23:17:09,881 - root - INFO - Инициализация бота...
2025-01-18 23:17:09,917 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:17:09,917 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:17:09,917 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:17:09,918 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:17:09,918 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:17:09,918 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:17:09,935 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:17:09,935 - root - INFO - Инициализация диспетчера...
2025-01-18 23:17:09,936 - root - INFO - Регистрация обработчиков...
2025-01-18 23:17:09,937 - root - INFO - Регистрация main menu команд...
2025-01-18 23:17:38,367 - root - INFO - Бот остановлен вручную.
2025-01-18 23:17:38,526 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000233B1590390>
2025-01-18 23:17:41,573 - root - INFO - Инициализация бота...
2025-01-18 23:17:41,925 - root - INFO - Инициализация бота...
2025-01-18 23:17:41,969 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:17:41,970 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:17:41,970 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:17:41,970 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:17:41,971 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:17:41,971 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:17:41,999 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:17:41,999 - root - INFO - Инициализация диспетчера...
2025-01-18 23:17:42,000 - root - INFO - Регистрация обработчиков...
2025-01-18 23:17:42,001 - root - INFO - Регистрация main menu команд...
2025-01-18 23:17:42,001 - root - INFO - Запуск polling...
2025-01-18 23:17:42,001 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:17:42,005 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:17:42,009 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:17:42,009 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] ()
2025-01-18 23:17:42,012 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:17:42,013 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] ('181151262',)
2025-01-18 23:17:44,562 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:17:44,564 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:17:44,569 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:17:44,570 - sqlalchemy.engine.Engine - INFO - [generated in 0.00103s] ('181151262',)
2025-01-18 23:17:59,707 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:17:59,708 - sqlalchemy.engine.Engine - INFO - [cached since 15.14s ago] ('528155210',)
2025-01-18 23:17:59,708 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:17:59,709 - sqlalchemy.engine.Engine - INFO - [cached since 17.7s ago] ('528155210',)
2025-01-18 23:18:02,415 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:18:02,418 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:18:02,420 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 23:18:02,421 - sqlalchemy.engine.Engine - INFO - [generated in 0.00092s] ('115',)
2025-01-18 23:18:04,425 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 23:18:04,426 - sqlalchemy.engine.Engine - INFO - [cached since 2.006s ago] ('116',)
2025-01-18 23:18:06,635 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:18:06,635 - sqlalchemy.engine.Engine - INFO - [cached since 22.07s ago] ('528155210',)
2025-01-18 23:18:15,364 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:18:15,365 - sqlalchemy.engine.Engine - INFO - [cached since 30.8s ago] ('432629636',)
2025-01-18 23:18:15,366 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:18:15,366 - sqlalchemy.engine.Engine - INFO - [cached since 33.35s ago] ('432629636',)
2025-01-18 23:18:44,594 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:18:44,863 - root - ERROR - Произошла ошибка при запуске бота: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]
2025-01-18 23:18:45,023 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002151CB14E50>
2025-01-18 23:18:53,891 - root - INFO - Инициализация бота...
2025-01-18 23:18:54,226 - root - INFO - Инициализация бота...
2025-01-18 23:18:54,258 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:18:54,259 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:18:54,259 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:18:54,259 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:18:54,259 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:18:54,260 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:18:54,276 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:18:54,276 - root - INFO - Инициализация диспетчера...
2025-01-18 23:18:54,277 - root - INFO - Регистрация обработчиков...
2025-01-18 23:18:54,278 - root - INFO - Регистрация main menu команд...
2025-01-18 23:18:54,278 - root - INFO - Запуск polling...
2025-01-18 23:18:54,278 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:18:54,282 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:18:54,284 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:18:54,284 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ()
2025-01-18 23:18:54,286 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:18:54,286 - sqlalchemy.engine.Engine - INFO - [generated in 0.00017s] ('181151262',)
2025-01-18 23:18:56,421 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:18:56,421 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:18:56,422 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:18:56,422 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ('181151262',)
2025-01-18 23:18:57,358 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:18:57,358 - sqlalchemy.engine.Engine - INFO - [cached since 0.9356s ago] ('528155210',)
2025-01-18 23:18:57,358 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:18:57,359 - sqlalchemy.engine.Engine - INFO - [cached since 3.072s ago] ('528155210',)
2025-01-18 23:19:00,266 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:19:00,267 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:19:00,268 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 23:19:00,268 - sqlalchemy.engine.Engine - INFO - [generated in 0.00039s] ('115',)
2025-01-18 23:19:02,347 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 23:19:02,347 - sqlalchemy.engine.Engine - INFO - [cached since 2.08s ago] ('116',)
2025-01-18 23:19:04,276 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:19:04,277 - sqlalchemy.engine.Engine - INFO - [cached since 7.855s ago] ('528155210',)
2025-01-18 23:19:15,491 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:19:15,491 - sqlalchemy.engine.Engine - INFO - [cached since 19.07s ago] ('432629636',)
2025-01-18 23:19:15,492 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:19:15,493 - sqlalchemy.engine.Engine - INFO - [cached since 21.21s ago] ('432629636',)
2025-01-18 23:19:28,196 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:19:28,451 - root - INFO - Бот остановлен вручную.
2025-01-18 23:22:07,839 - root - INFO - Инициализация бота...
2025-01-18 23:22:08,177 - root - INFO - Инициализация бота...
2025-01-18 23:22:08,210 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:22:08,210 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:22:08,210 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:22:08,211 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:22:08,211 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:22:08,211 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:22:08,232 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:22:08,232 - root - INFO - Инициализация диспетчера...
2025-01-18 23:22:08,232 - root - INFO - Регистрация обработчиков...
2025-01-18 23:22:08,233 - root - INFO - Регистрация main menu команд...
2025-01-18 23:22:08,233 - root - INFO - Запуск polling...
2025-01-18 23:22:08,233 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:22:08,237 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:22:08,239 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:22:08,239 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ()
2025-01-18 23:22:08,242 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:22:08,242 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] ('181151262',)
2025-01-18 23:22:10,189 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:22:10,190 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:22:10,192 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:22:10,192 - sqlalchemy.engine.Engine - INFO - [generated in 0.00052s] ('181151262',)
2025-01-18 23:22:19,768 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 23:22:34,239 - aiogram.event - INFO - Update id=659309914 is handled. Duration 389 ms by bot id=7444575424
2025-01-18 23:22:46,318 - aiogram.event - INFO - Update id=659309917 is not handled. Duration 0 ms by bot id=7444575424
2025-01-18 23:22:46,318 - aiogram.event - ERROR - Cause exception while process update id=659309917 by bot id=7444575424
KeyError: 'Key'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 60, in handle_period_selection
    amount = prices_dict[selected_period.split()[0]]
             ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: 'Key'
2025-01-18 23:22:46,324 - aiogram.event - INFO - Update id=659309918 is not handled. Duration 16 ms by bot id=7444575424
2025-01-18 23:22:46,324 - aiogram.event - ERROR - Cause exception while process update id=659309918 by bot id=7444575424
KeyError: 'About'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 60, in handle_period_selection
    amount = prices_dict[selected_period.split()[0]]
             ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: 'About'
2025-01-18 23:22:47,326 - aiogram.event - INFO - Update id=659309916 is handled. Duration 1016 ms by bot id=7444575424
2025-01-18 23:22:48,340 - aiogram.event - INFO - Update id=659309915 is not handled. Duration 3860 ms by bot id=7444575424
2025-01-18 23:22:48,341 - aiogram.event - ERROR - Cause exception while process update id=659309915 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: message is not modified: specified new message content and reply markup are exactly the same as a current content and reply markup of the message
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\main_menu_router.py", line 43, in main_menu_handler
    await buy_key_menu(callback, state)
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 32, in buy_key_menu
    await callback.message.edit_text(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message is not modified: specified new message content and reply markup are exactly the same as a current content and reply markup of the message
2025-01-18 23:22:49,500 - aiogram.event - INFO - Update id=659309919 is not handled. Duration 235 ms by bot id=7444575424
2025-01-18 23:22:49,500 - aiogram.event - ERROR - Cause exception while process update id=659309919 by bot id=7444575424
AttributeError: 'str' object has no attribute 'set_state'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\utils_router.py", line 60, in back_button
    await state.set_state(MainMenu.waiting_for_action)
          ^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'set_state'
2025-01-18 23:23:02,142 - aiogram.event - INFO - Update id=659309920 is not handled. Duration 0 ms by bot id=7444575424
2025-01-18 23:23:02,142 - aiogram.event - ERROR - Cause exception while process update id=659309920 by bot id=7444575424
KeyError: 'About'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\payment_router.py", line 60, in handle_period_selection
    amount = prices_dict[selected_period.split()[0]]
             ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: 'About'
2025-01-18 23:23:03,369 - aiogram.event - INFO - Update id=659309921 is handled. Duration 781 ms by bot id=7444575424
2025-01-18 23:23:03,409 - aiogram.event - INFO - Update id=659309922 is handled. Duration 828 ms by bot id=7444575424
2025-01-18 23:23:10,287 - root - ERROR - Ошибка проверки базы данных: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]
2025-01-18 23:23:10,287 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-2' coro=<DbProcessor.check_db() done, defined at C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py:65> exception=TelegramNetworkError('HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]')>
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1116, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs, sock=sock)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1112, in create_connection
    transport, protocol = await self._create_connection_transport(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1145, in _create_connection_transport
    await waiter
ConnectionAbortedError: SSL handshake is taking longer than 60.0 seconds: aborting the connection

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 181, in make_request
    async with session.post(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 1360, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 663, in _request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 538, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1050, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1384, in _create_direct_connection
    raise last_exc
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1353, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1124, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py", line 94, in check_db
    await send_message_subscription_expired(
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\utils\send_message.py", line 48, in send_message_subscription_expired
    await bot.send_message(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2962, in send_message
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 188, in make_request
    raise TelegramNetworkError(method=method, message=f"{type(e).__name__}: {e}")
aiogram.exceptions.TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]
2025-01-18 23:23:12,359 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:23:12,617 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 23:23:12,617 - aiogram.event - INFO - Update id=659309908 is not handled. Duration 52733 ms by bot id=7444575424
2025-01-18 23:23:12,617 - aiogram.event - INFO - Update id=659309907 is not handled. Duration 52733 ms by bot id=7444575424
2025-01-18 23:23:12,620 - root - INFO - Бот остановлен вручную.
2025-01-18 23:23:21,536 - root - INFO - Инициализация бота...
2025-01-18 23:23:21,886 - root - INFO - Инициализация бота...
2025-01-18 23:23:21,918 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:23:21,918 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:23:21,918 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:23:21,919 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:23:21,919 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:23:21,919 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:23:21,935 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:23:21,936 - root - INFO - Инициализация диспетчера...
2025-01-18 23:23:21,936 - root - INFO - Регистрация обработчиков...
2025-01-18 23:23:21,937 - root - INFO - Регистрация main menu команд...
2025-01-18 23:23:21,937 - root - INFO - Запуск polling...
2025-01-18 23:23:21,937 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:23:21,941 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:23:21,943 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:23:21,943 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] ()
2025-01-18 23:23:21,946 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:23:21,946 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] ('181151262',)
2025-01-18 23:23:24,594 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:23:24,596 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:23:24,597 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:23:24,598 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] ('181151262',)
2025-01-18 23:23:45,684 - root - ERROR - Ошибка проверки базы данных: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2025-01-18 23:23:45,685 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-2' coro=<DbProcessor.check_db() done, defined at C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py:65> exception=TelegramNetworkError('HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]')>
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1109, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\proactor_events.py", line 726, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 846, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 633, in finish_connect
    ov.getresult()
OSError: [WinError 121] Превышен таймаут семафора

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 181, in make_request
    async with session.post(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 1360, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 663, in _request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 538, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1050, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1384, in _create_direct_connection
    raise last_exc
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1353, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1124, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py", line 94, in check_db
    await send_message_subscription_expired(
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\utils\send_message.py", line 48, in send_message_subscription_expired
    await bot.send_message(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2962, in send_message
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 188, in make_request
    raise TelegramNetworkError(method=method, message=f"{type(e).__name__}: {e}")
aiogram.exceptions.TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2025-01-18 23:23:45,724 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:23:45,980 - root - ERROR - Произошла ошибка при запуске бота: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2025-01-18 23:23:46,139 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001646D695150>
2025-01-18 23:23:52,664 - root - INFO - Инициализация бота...
2025-01-18 23:23:53,004 - root - INFO - Инициализация бота...
2025-01-18 23:23:53,037 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:23:53,037 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:23:53,037 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:23:53,038 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:23:53,038 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:23:53,038 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:23:53,055 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:23:53,055 - root - INFO - Инициализация диспетчера...
2025-01-18 23:23:53,055 - root - INFO - Регистрация обработчиков...
2025-01-18 23:23:53,056 - root - INFO - Регистрация main menu команд...
2025-01-18 23:23:53,056 - root - INFO - Запуск polling...
2025-01-18 23:23:53,057 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:23:53,060 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:23:53,062 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:23:53,062 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ()
2025-01-18 23:23:53,065 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:23:53,065 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ('181151262',)
2025-01-18 23:23:55,478 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:23:55,480 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:23:55,481 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:23:55,482 - sqlalchemy.engine.Engine - INFO - [generated in 0.00057s] ('181151262',)
2025-01-18 23:24:05,664 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:24:05,665 - sqlalchemy.engine.Engine - INFO - [cached since 10.18s ago] ('528155210',)
2025-01-18 23:24:05,666 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:24:05,666 - sqlalchemy.engine.Engine - INFO - [cached since 12.6s ago] ('528155210',)
2025-01-18 23:24:08,676 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:24:08,678 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:24:08,680 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 23:24:08,681 - sqlalchemy.engine.Engine - INFO - [generated in 0.00063s] ('115',)
2025-01-18 23:24:11,742 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-18 23:24:11,743 - sqlalchemy.engine.Engine - INFO - [cached since 3.063s ago] ('116',)
2025-01-18 23:24:13,975 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:24:13,976 - sqlalchemy.engine.Engine - INFO - [cached since 18.49s ago] ('528155210',)
2025-01-18 23:24:18,250 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:24:18,250 - sqlalchemy.engine.Engine - INFO - [cached since 22.77s ago] ('432629636',)
2025-01-18 23:24:18,252 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:24:18,252 - sqlalchemy.engine.Engine - INFO - [cached since 25.19s ago] ('432629636',)
2025-01-18 23:24:55,977 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:24:56,243 - root - ERROR - Произошла ошибка при запуске бота: HTTP Client says - Request timeout error
2025-01-18 23:24:56,423 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000021E2A0C1550>
2025-01-18 23:25:05,648 - root - INFO - Инициализация бота...
2025-01-18 23:25:05,993 - root - INFO - Инициализация бота...
2025-01-18 23:25:06,029 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:25:06,030 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:25:06,030 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:25:06,031 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:25:06,031 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:25:06,031 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:25:06,053 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:25:06,053 - root - INFO - Инициализация диспетчера...
2025-01-18 23:25:06,054 - root - INFO - Регистрация обработчиков...
2025-01-18 23:25:06,055 - root - INFO - Регистрация main menu команд...
2025-01-18 23:25:06,055 - root - INFO - Запуск polling...
2025-01-18 23:25:06,055 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:25:06,060 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:25:06,063 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:25:06,063 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] ()
2025-01-18 23:25:06,066 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:25:06,066 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ('181151262',)
2025-01-18 23:25:09,277 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:25:09,278 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:25:09,280 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:25:09,280 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] ('181151262',)
2025-01-18 23:25:30,329 - root - ERROR - Ошибка проверки базы данных: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2025-01-18 23:25:30,330 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-2' coro=<DbProcessor.check_db() done, defined at C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py:65> exception=TelegramNetworkError('HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]')>
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1109, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\proactor_events.py", line 726, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 846, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 633, in finish_connect
    ov.getresult()
OSError: [WinError 121] Превышен таймаут семафора

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 181, in make_request
    async with session.post(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 1360, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 663, in _request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 538, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1050, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1384, in _create_direct_connection
    raise last_exc
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1353, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1124, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py", line 94, in check_db
    await send_message_subscription_expired(
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\utils\send_message.py", line 48, in send_message_subscription_expired
    await bot.send_message(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2962, in send_message
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 188, in make_request
    raise TelegramNetworkError(method=method, message=f"{type(e).__name__}: {e}")
aiogram.exceptions.TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2025-01-18 23:25:30,339 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:25:30,594 - root - ERROR - Произошла ошибка при запуске бота: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2025-01-18 23:25:30,758 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001BBE9184F10>
2025-01-18 23:26:50,070 - root - INFO - Инициализация бота...
2025-01-18 23:26:50,485 - root - INFO - Инициализация бота...
2025-01-18 23:26:50,526 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:26:50,526 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:26:50,526 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:26:50,527 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:26:50,527 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:26:50,528 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:26:50,548 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:26:50,548 - root - INFO - Инициализация диспетчера...
2025-01-18 23:26:50,549 - root - INFO - Регистрация обработчиков...
2025-01-18 23:26:50,550 - root - INFO - Регистрация main menu команд...
2025-01-18 23:26:50,550 - root - INFO - Запуск polling...
2025-01-18 23:26:50,550 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:26:50,555 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:26:50,557 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:26:50,558 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] ()
2025-01-18 23:26:50,561 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:26:50,562 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] ('181151262',)
2025-01-18 23:26:53,190 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:26:53,190 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:26:53,191 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:26:53,191 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] ('181151262',)
2025-01-18 23:27:53,281 - root - ERROR - Ошибка проверки базы данных: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]
2025-01-18 23:27:53,281 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-2' coro=<DbProcessor.check_db() done, defined at C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py:65> exception=TelegramNetworkError('HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]')>
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1116, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs, sock=sock)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1112, in create_connection
    transport, protocol = await self._create_connection_transport(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1145, in _create_connection_transport
    await waiter
ConnectionAbortedError: SSL handshake is taking longer than 60.0 seconds: aborting the connection

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 181, in make_request
    async with session.post(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 1360, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 663, in _request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 538, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1050, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1384, in _create_direct_connection
    raise last_exc
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1353, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1124, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py", line 94, in check_db
    await send_message_subscription_expired(
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\utils\send_message.py", line 48, in send_message_subscription_expired
    await bot.send_message(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2962, in send_message
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 188, in make_request
    raise TelegramNetworkError(method=method, message=f"{type(e).__name__}: {e}")
aiogram.exceptions.TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]
2025-01-18 23:27:53,292 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:27:53,550 - root - ERROR - Произошла ошибка при запуске бота: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]
2025-01-18 23:27:53,691 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002B9AA210F90>
2025-01-18 23:28:08,648 - root - INFO - Инициализация бота...
2025-01-18 23:28:09,012 - root - INFO - Инициализация бота...
2025-01-18 23:28:09,050 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:28:09,051 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:28:09,051 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:28:09,052 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2025-01-18 23:28:09,052 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:28:09,052 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:28:09,052 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:28:09,052 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("keys")
2025-01-18 23:28:09,052 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:28:09,053 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	user_telegram_id VARCHAR NOT NULL, 
	subscription_status VARCHAR, 
	use_trial_period BOOLEAN, 
	PRIMARY KEY (user_telegram_id)
)


2025-01-18 23:28:09,053 - sqlalchemy.engine.Engine - INFO - [no key 0.00015s] ()
2025-01-18 23:28:09,069 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE keys (
	key_id VARCHAR NOT NULL, 
	user_telegram_id VARCHAR, 
	expiration_date DATETIME, 
	start_date DATETIME, 
	remembering_before_exp BOOLEAN, 
	PRIMARY KEY (key_id), 
	FOREIGN KEY(user_telegram_id) REFERENCES users (user_telegram_id)
)


2025-01-18 23:28:09,069 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2025-01-18 23:28:09,075 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:28:09,099 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:28:09,099 - root - INFO - Инициализация диспетчера...
2025-01-18 23:28:09,100 - root - INFO - Регистрация обработчиков...
2025-01-18 23:28:09,101 - root - INFO - Регистрация main menu команд...
2025-01-18 23:28:09,101 - root - INFO - Запуск polling...
2025-01-18 23:28:09,101 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:28:09,106 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:28:09,107 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:28:09,108 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] ()
2025-01-18 23:28:22,847 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 23:28:23,757 - aiogram.event - INFO - Update id=659309924 is handled. Duration 266 ms by bot id=7444575424
2025-01-18 23:28:26,870 - aiogram.event - INFO - Update id=659309927 is handled. Duration 3391 ms by bot id=7444575424
2025-01-18 23:28:36,413 - aiogram.event - INFO - Update id=659309928 is handled. Duration 11125 ms by bot id=7444575424
2025-01-18 23:28:37,653 - aiogram.event - INFO - Update id=659309930 is handled. Duration 141 ms by bot id=7444575424
2025-01-18 23:28:37,657 - aiogram.event - INFO - Update id=659309929 is not handled. Duration 7594 ms by bot id=7444575424
2025-01-18 23:28:37,658 - aiogram.event - ERROR - Cause exception while process update id=659309929 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: message to edit not found
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\main_menu_router.py", line 43, in main_menu_handler
    await buy_key_menu(callback, state)
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\buy_key_router.py", line 32, in buy_key_menu
    await callback.message.edit_text(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message to edit not found
2025-01-18 23:28:39,007 - aiogram.event - INFO - Update id=659309931 is handled. Duration 266 ms by bot id=7444575424
2025-01-18 23:28:40,494 - aiogram.event - INFO - Update id=659309932 is handled. Duration 281 ms by bot id=7444575424
2025-01-18 23:28:51,727 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-01-18 23:28:51,727 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7444575424)
2025-01-18 23:28:52,913 - aiogram.event - INFO - Update id=659309933 is handled. Duration 11234 ms by bot id=7444575424
2025-01-18 23:28:54,372 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7444575424)
2025-01-18 23:28:54,456 - aiogram.event - INFO - Update id=659309934 is not handled. Duration 77 ms by bot id=7444575424
2025-01-18 23:28:54,456 - aiogram.event - ERROR - Cause exception while process update id=659309934 by bot id=7444575424
TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 181, in make_request
    async with session.post(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 1360, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 690, in _request
    await resp.start(conn)
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client_reqrep.py", line 1059, in start
    message, payload = await protocol.read()  # type: ignore[union-attr]
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\streams.py", line 644, in read
    await self._waiter
aiohttp.client_exceptions.ServerDisconnectedError: Server disconnected

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\utils_router.py", line 43, in back_button
    await callback.message.edit_text(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 188, in make_request
    raise TelegramNetworkError(method=method, message=f"{type(e).__name__}: {e}")
aiogram.exceptions.TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-01-18 23:28:55,672 - aiogram.event - INFO - Update id=659309925 is handled. Duration 32187 ms by bot id=7444575424
2025-01-18 23:29:03,262 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:29:03,526 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 23:29:03,528 - root - INFO - Бот остановлен вручную.
2025-01-18 23:29:07,094 - root - INFO - Инициализация бота...
2025-01-18 23:29:07,443 - root - INFO - Инициализация бота...
2025-01-18 23:29:07,475 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:29:07,476 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:29:07,476 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:29:07,476 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:29:07,477 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:29:07,477 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:29:07,493 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:29:07,493 - root - INFO - Инициализация диспетчера...
2025-01-18 23:29:07,494 - root - INFO - Регистрация обработчиков...
2025-01-18 23:29:07,495 - root - INFO - Регистрация main menu команд...
2025-01-18 23:29:07,495 - root - INFO - Запуск polling...
2025-01-18 23:29:07,495 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:29:07,498 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:29:07,501 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:29:07,501 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ()
2025-01-18 23:29:07,771 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 23:29:11,459 - aiogram.event - INFO - Update id=659309935 is handled. Duration 218 ms by bot id=7444575424
2025-01-18 23:29:13,428 - aiogram.event - INFO - Update id=659309936 is handled. Duration 218 ms by bot id=7444575424
2025-01-18 23:29:14,452 - aiogram.event - INFO - Update id=659309937 is handled. Duration 296 ms by bot id=7444575424
2025-01-18 23:29:15,498 - aiogram.event - INFO - Update id=659309938 is handled. Duration 328 ms by bot id=7444575424
2025-01-18 23:29:16,638 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 23:29:16,927 - aiogram.event - INFO - Update id=659309939 is handled. Duration 281 ms by bot id=7444575424
2025-01-18 23:29:18,018 - aiogram.event - INFO - Update id=659309940 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 23:29:19,315 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 23:29:19,538 - aiogram.event - INFO - Update id=659309941 is handled. Duration 219 ms by bot id=7444575424
2025-01-18 23:29:21,348 - aiogram.event - INFO - Update id=659309942 is not handled. Duration 328 ms by bot id=7444575424
2025-01-18 23:29:21,349 - aiogram.event - ERROR - Cause exception while process update id=659309942 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: message can't be edited
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\utils_router.py", line 43, in back_button
    await callback.message.edit_text(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message can't be edited
2025-01-18 23:29:23,231 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:29:23,496 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 23:29:23,499 - root - INFO - Бот остановлен вручную.
2025-01-18 23:29:43,776 - root - INFO - Инициализация бота...
2025-01-18 23:29:44,140 - root - INFO - Инициализация бота...
2025-01-18 23:29:44,174 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:29:44,175 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:29:44,175 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:29:44,175 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:29:44,175 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:29:44,176 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:29:44,196 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:29:44,196 - root - INFO - Инициализация диспетчера...
2025-01-18 23:29:44,196 - root - INFO - Регистрация обработчиков...
2025-01-18 23:29:44,197 - root - INFO - Регистрация main menu команд...
2025-01-18 23:29:44,197 - root - INFO - Запуск polling...
2025-01-18 23:29:44,197 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:29:44,201 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:29:44,204 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:29:44,204 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ()
2025-01-18 23:29:44,433 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 23:29:46,177 - aiogram.event - INFO - Update id=659309943 is handled. Duration 235 ms by bot id=7444575424
2025-01-18 23:29:47,836 - aiogram.event - INFO - Update id=659309944 is handled. Duration 312 ms by bot id=7444575424
2025-01-18 23:29:48,425 - aiogram.event - INFO - Update id=659309945 is not handled. Duration 0 ms by bot id=7444575424
2025-01-18 23:29:48,425 - aiogram.event - ERROR - Cause exception while process update id=659309945 by bot id=7444575424
NameError: name 'GetKey' is not defined
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\utils_router.py", line 42, in back_button
    if state in {GetKey.waiting_for_payment, GetKey.waiting_for_extension_payment}:
                 ^^^^^^
NameError: name 'GetKey' is not defined
2025-01-18 23:29:52,357 - aiogram.event - INFO - Update id=659309946 is not handled. Duration 14 ms by bot id=7444575424
2025-01-18 23:29:52,357 - aiogram.event - ERROR - Cause exception while process update id=659309946 by bot id=7444575424
NameError: name 'GetKey' is not defined
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\utils_router.py", line 42, in back_button
    if state in {GetKey.waiting_for_payment, GetKey.waiting_for_extension_payment}:
                 ^^^^^^
NameError: name 'GetKey' is not defined
2025-01-18 23:29:57,152 - aiogram.event - INFO - Update id=659309947 is handled. Duration 172 ms by bot id=7444575424
2025-01-18 23:29:58,573 - aiogram.event - INFO - Update id=659309948 is handled. Duration 187 ms by bot id=7444575424
2025-01-18 23:29:59,226 - aiogram.event - INFO - Update id=659309949 is not handled. Duration 0 ms by bot id=7444575424
2025-01-18 23:29:59,226 - aiogram.event - ERROR - Cause exception while process update id=659309949 by bot id=7444575424
NameError: name 'GetKey' is not defined
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\utils_router.py", line 42, in back_button
    if state in {GetKey.waiting_for_payment, GetKey.waiting_for_extension_payment}:
                 ^^^^^^
NameError: name 'GetKey' is not defined
2025-01-18 23:30:11,364 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:30:11,624 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 23:30:11,627 - root - INFO - Бот остановлен вручную.
2025-01-18 23:30:14,758 - root - INFO - Инициализация бота...
2025-01-18 23:30:15,099 - root - INFO - Инициализация бота...
2025-01-18 23:30:15,132 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:30:15,132 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:30:15,132 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:30:15,133 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:30:15,133 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:30:15,133 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:30:15,154 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:30:15,154 - root - INFO - Инициализация диспетчера...
2025-01-18 23:30:15,154 - root - INFO - Регистрация обработчиков...
2025-01-18 23:30:15,155 - root - INFO - Регистрация main menu команд...
2025-01-18 23:30:15,156 - root - INFO - Запуск polling...
2025-01-18 23:30:15,156 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:30:15,159 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:30:15,162 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:30:15,162 - sqlalchemy.engine.Engine - INFO - [generated in 0.00021s] ()
2025-01-18 23:30:15,391 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 23:30:18,094 - aiogram.event - INFO - Update id=659309950 is handled. Duration 203 ms by bot id=7444575424
2025-01-18 23:30:19,226 - aiogram.event - INFO - Update id=659309951 is handled. Duration 203 ms by bot id=7444575424
2025-01-18 23:30:19,943 - aiogram.event - INFO - Update id=659309952 is not handled. Duration 77 ms by bot id=7444575424
2025-01-18 23:30:19,943 - aiogram.event - ERROR - Cause exception while process update id=659309952 by bot id=7444575424
AttributeError: 'str' object has no attribute 'set_state'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\utils_router.py", line 59, in back_button
    await state.set_state(MainMenu.waiting_for_action)
          ^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'set_state'
2025-01-18 23:30:20,938 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:30:20,940 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:30:20,940 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] ('528155210', 1, 0)
2025-01-18 23:30:21,087 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-18 23:30:21,088 - aiogram.event - INFO - Update id=659309953 is handled. Duration 157 ms by bot id=7444575424
2025-01-18 23:30:23,090 - aiogram.event - INFO - Update id=659309954 is not handled. Duration 157 ms by bot id=7444575424
2025-01-18 23:30:23,090 - aiogram.event - ERROR - Cause exception while process update id=659309954 by bot id=7444575424
AttributeError: 'str' object has no attribute 'set_state'
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\utils_router.py", line 59, in back_button
    await state.set_state(MainMenu.waiting_for_action)
          ^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'set_state'
2025-01-18 23:30:47,299 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:30:47,555 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 23:30:47,557 - root - INFO - Бот остановлен вручную.
2025-01-18 23:30:50,834 - root - INFO - Инициализация бота...
2025-01-18 23:30:51,184 - root - INFO - Инициализация бота...
2025-01-18 23:30:51,218 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:30:51,218 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:30:51,218 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:30:51,219 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:30:51,219 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:30:51,219 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:30:51,241 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:30:51,241 - root - INFO - Инициализация диспетчера...
2025-01-18 23:30:51,241 - root - INFO - Регистрация обработчиков...
2025-01-18 23:30:51,242 - root - INFO - Регистрация main menu команд...
2025-01-18 23:30:51,242 - root - INFO - Запуск polling...
2025-01-18 23:30:51,242 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:30:51,246 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:30:51,251 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:30:51,251 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ()
2025-01-18 23:30:51,502 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 23:30:58,124 - aiogram.event - INFO - Update id=659309955 is handled. Duration 235 ms by bot id=7444575424
2025-01-18 23:30:59,283 - aiogram.event - INFO - Update id=659309956 is handled. Duration 219 ms by bot id=7444575424
2025-01-18 23:31:00,317 - aiogram.event - INFO - Update id=659309957 is handled. Duration 155 ms by bot id=7444575424
2025-01-18 23:31:02,133 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:31:02,134 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:31:02,134 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ('528155210', 1, 0)
2025-01-18 23:31:02,410 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-18 23:31:02,635 - aiogram.event - INFO - Update id=659309958 is handled. Duration 500 ms by bot id=7444575424
2025-01-18 23:31:04,255 - aiogram.event - INFO - Update id=659309959 is handled. Duration 141 ms by bot id=7444575424
2025-01-18 23:31:05,185 - aiogram.event - INFO - Update id=659309960 is handled. Duration 139 ms by bot id=7444575424
2025-01-18 23:31:06,362 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=69000)]
2025-01-18 23:31:06,571 - aiogram.event - INFO - Update id=659309961 is handled. Duration 202 ms by bot id=7444575424
2025-01-18 23:31:07,847 - aiogram.event - INFO - Update id=659309962 is handled. Duration 187 ms by bot id=7444575424
2025-01-18 23:31:11,816 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=9000)]
2025-01-18 23:31:12,353 - aiogram.event - INFO - Update id=659309963 is handled. Duration 547 ms by bot id=7444575424
2025-01-18 23:31:13,504 - aiogram.event - INFO - Update id=659309964 is handled. Duration 203 ms by bot id=7444575424
2025-01-18 23:31:16,334 - aiogram.event - INFO - Update id=659309965 is handled. Duration 171 ms by bot id=7444575424
2025-01-18 23:31:17,195 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=69000)]
2025-01-18 23:31:17,423 - aiogram.event - INFO - Update id=659309966 is handled. Duration 235 ms by bot id=7444575424
2025-01-18 23:31:18,644 - aiogram.event - INFO - Update id=659309967 is handled. Duration 203 ms by bot id=7444575424
2025-01-18 23:31:19,825 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:31:19,826 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:31:19,826 - sqlalchemy.engine.Engine - INFO - [cached since 17.69s ago] ('528155210', 1, 0)
2025-01-18 23:31:20,041 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-18 23:31:20,217 - aiogram.event - INFO - Update id=659309968 is handled. Duration 391 ms by bot id=7444575424
2025-01-18 23:31:22,028 - aiogram.event - INFO - Update id=659309969 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 23:31:23,109 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:31:23,109 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:31:23,110 - sqlalchemy.engine.Engine - INFO - [cached since 20.98s ago] ('528155210', 1, 0)
2025-01-18 23:31:23,228 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-18 23:31:23,290 - aiogram.event - INFO - Update id=659309970 is handled. Duration 172 ms by bot id=7444575424
2025-01-18 23:31:24,379 - aiogram.event - INFO - Update id=659309971 is handled. Duration 63 ms by bot id=7444575424
2025-01-18 23:31:25,866 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:31:25,867 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:31:25,867 - sqlalchemy.engine.Engine - INFO - [cached since 23.73s ago] ('528155210', 1, 0)
2025-01-18 23:31:25,872 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (user_telegram_id, subscription_status, use_trial_period) VALUES (?, ?, ?)
2025-01-18 23:31:25,873 - sqlalchemy.engine.Engine - INFO - [generated in 0.00077s] ('528155210', 'active', 0)
2025-01-18 23:31:25,875 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:31:25,884 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:31:25,885 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:31:25,885 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] ('528155210',)
2025-01-18 23:31:25,887 - sqlalchemy.engine.Engine - INFO - UPDATE users SET use_trial_period=? WHERE users.user_telegram_id = ?
2025-01-18 23:31:25,888 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] (1, '528155210')
2025-01-18 23:31:25,889 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:31:27,903 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:31:27,904 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2025-01-18 23:31:27,905 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ('125', '528155210', '2025-01-20 23:31:27.902249', '2025-01-18 23:31:27.902249', 0)
2025-01-18 23:31:27,906 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:31:27,913 - root - INFO - Key created: OutlineKey(key_id='125', name='VPN Key73', password='ObhOj48Q0HHv8uKeIwTTdp', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpPYmhPajQ4UTBISHY4dUtlSXdUVGRw@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2025-01-18 23:31:28,003 - aiogram.event - INFO - Update id=659309972 is handled. Duration 2141 ms by bot id=7444575424
2025-01-18 23:31:29,798 - aiogram.event - INFO - Update id=659309973 is handled. Duration 140 ms by bot id=7444575424
2025-01-18 23:31:30,856 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:31:30,857 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:31:30,857 - sqlalchemy.engine.Engine - INFO - [cached since 28.72s ago] ('528155210', 1, 0)
2025-01-18 23:31:30,860 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:31:30,860 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] ('528155210',)
2025-01-18 23:31:48,577 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-18 23:32:17,439 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:32:17,693 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 23:32:17,694 - aiogram.event - INFO - Update id=659309974 is not handled. Duration 46827 ms by bot id=7444575424
2025-01-18 23:32:17,697 - root - INFO - Бот остановлен вручную.
2025-01-18 23:32:20,849 - root - INFO - Инициализация бота...
2025-01-18 23:32:21,190 - root - INFO - Инициализация бота...
2025-01-18 23:32:21,222 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:32:21,222 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:32:21,222 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:32:21,223 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:32:21,223 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:32:21,223 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:32:21,240 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:32:21,240 - root - INFO - Инициализация диспетчера...
2025-01-18 23:32:21,240 - root - INFO - Регистрация обработчиков...
2025-01-18 23:32:21,241 - root - INFO - Регистрация main menu команд...
2025-01-18 23:32:21,241 - root - INFO - Запуск polling...
2025-01-18 23:32:21,242 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:32:21,245 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:32:21,248 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:32:21,248 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] ()
2025-01-18 23:32:21,250 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:32:21,250 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ('528155210',)
2025-01-18 23:32:24,291 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:32:24,292 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:32:24,293 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:32:24,294 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('528155210',)
2025-01-18 23:33:11,717 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:33:11,980 - root - INFO - Бот остановлен вручную.
2025-01-18 23:33:12,141 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000210DE8D9150>
2025-01-18 23:33:16,611 - root - INFO - Инициализация бота...
2025-01-18 23:33:16,945 - root - INFO - Инициализация бота...
2025-01-18 23:33:16,979 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:33:16,979 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:33:16,980 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:33:16,980 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:33:16,980 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:33:16,981 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:33:16,998 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:33:16,998 - root - INFO - Инициализация диспетчера...
2025-01-18 23:33:16,999 - root - INFO - Регистрация обработчиков...
2025-01-18 23:33:17,000 - root - INFO - Регистрация main menu команд...
2025-01-18 23:33:17,000 - root - INFO - Запуск polling...
2025-01-18 23:33:17,000 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:33:17,004 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:33:17,006 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:33:17,006 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ()
2025-01-18 23:33:17,009 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:33:17,009 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] ('528155210',)
2025-01-18 23:33:19,231 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:33:19,234 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:33:19,235 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:33:19,236 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ('528155210',)
2025-01-18 23:34:19,269 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:34:19,523 - root - ERROR - Произошла ошибка при запуске бота: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]
2025-01-18 23:34:19,677 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001B389443290>
2025-01-18 23:34:32,013 - root - INFO - Инициализация бота...
2025-01-18 23:34:32,359 - root - INFO - Инициализация бота...
2025-01-18 23:34:32,394 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:34:32,394 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:34:32,394 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:34:32,395 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:34:32,395 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:34:32,395 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:34:32,413 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:34:32,413 - root - INFO - Инициализация диспетчера...
2025-01-18 23:34:32,414 - root - INFO - Регистрация обработчиков...
2025-01-18 23:34:32,415 - root - INFO - Регистрация main menu команд...
2025-01-18 23:34:32,415 - root - INFO - Запуск polling...
2025-01-18 23:34:32,415 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:34:32,419 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:34:32,421 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:34:32,421 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ()
2025-01-18 23:34:32,424 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:34:32,424 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] ('528155210',)
2025-01-18 23:34:34,810 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:34:34,810 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:34:34,812 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:34:34,812 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ('528155210',)
2025-01-18 23:34:37,270 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:34:37,526 - root - INFO - Бот остановлен вручную.
2025-01-18 23:34:37,677 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000257D49007D0>
2025-01-18 23:34:41,653 - root - INFO - Инициализация бота...
2025-01-18 23:34:41,997 - root - INFO - Инициализация бота...
2025-01-18 23:34:42,031 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:34:42,031 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:34:42,031 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:34:42,032 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:34:42,032 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:34:42,032 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:34:42,048 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:34:42,049 - root - INFO - Инициализация диспетчера...
2025-01-18 23:34:42,049 - root - INFO - Регистрация обработчиков...
2025-01-18 23:34:42,050 - root - INFO - Регистрация main menu команд...
2025-01-18 23:34:42,050 - root - INFO - Запуск polling...
2025-01-18 23:34:42,050 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:34:42,054 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:34:42,056 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:34:42,057 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] ()
2025-01-18 23:34:42,059 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:34:42,059 - sqlalchemy.engine.Engine - INFO - [generated in 0.00021s] ('528155210',)
2025-01-18 23:34:42,062 - root - ERROR - Ошибка проверки базы данных: HTTPSConnectionPool(host='5.35.38.7', port=8811): Max retries exceeded with url: /p78Ho3alpF3e8Sv37eLV1Q/access-keys/125 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x0000020671591C90>: Failed to establish a new connection: [WinError 10051] Сделана попытка выполнить операцию на сокете при отключенной сети'))
2025-01-18 23:34:42,062 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-2' coro=<DbProcessor.check_db() done, defined at C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py:65> exception=ConnectionError(MaxRetryError("HTTPSConnectionPool(host='5.35.38.7', port=8811): Max retries exceeded with url: /p78Ho3alpF3e8Sv37eLV1Q/access-keys/125 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x0000020671591C90>: Failed to establish a new connection: [WinError 10051] Сделана попытка выполнить операцию на сокете при отключенной сети'))"))>
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\connection.py", line 199, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
OSError: [WinError 10051] Сделана попытка выполнить операцию на сокете при отключенной сети

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\connectionpool.py", line 789, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\connectionpool.py", line 490, in _make_request
    raise new_e
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\connectionpool.py", line 466, in _make_request
    self._validate_conn(conn)
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\connectionpool.py", line 1095, in _validate_conn
    conn.connect()
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\connection.py", line 693, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\connection.py", line 214, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x0000020671591C90>: Failed to establish a new connection: [WinError 10051] Сделана попытка выполнить операцию на сокете при отключенной сети

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\connectionpool.py", line 843, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='5.35.38.7', port=8811): Max retries exceeded with url: /p78Ho3alpF3e8Sv37eLV1Q/access-keys/125 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x0000020671591C90>: Failed to establish a new connection: [WinError 10051] Сделана попытка выполнить операцию на сокете при отключенной сети'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py", line 74, in check_db
    key_info = outline_processor.get_key_info(key.key_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\utils\outline_processor.py", line 17, in get_key_info
    return self.client.get_key(key_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\outline_vpn\outline_vpn.py", line 111, in get_key
    response = self.session.get(
               ^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\requests\adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='5.35.38.7', port=8811): Max retries exceeded with url: /p78Ho3alpF3e8Sv37eLV1Q/access-keys/125 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x0000020671591C90>: Failed to establish a new connection: [WinError 10051] Сделана попытка выполнить операцию на сокете при отключенной сети'))
2025-01-18 23:34:42,082 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:34:42,347 - root - ERROR - Произошла ошибка при запуске бота: HTTP Client says - ClientConnectorDNSError: Cannot connect to host api.telegram.org:443 ssl:default [getaddrinfo failed]
2025-01-18 23:34:47,772 - root - INFO - Инициализация бота...
2025-01-18 23:34:48,242 - root - INFO - Инициализация бота...
2025-01-18 23:34:48,288 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:34:48,288 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:34:48,288 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:34:48,289 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:34:48,289 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:34:48,290 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:34:48,317 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:34:48,317 - root - INFO - Инициализация диспетчера...
2025-01-18 23:34:48,318 - root - INFO - Регистрация обработчиков...
2025-01-18 23:34:48,319 - root - INFO - Регистрация main menu команд...
2025-01-18 23:34:48,319 - root - INFO - Запуск polling...
2025-01-18 23:34:48,319 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:34:48,324 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:34:48,327 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:34:48,327 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] ()
2025-01-18 23:34:48,330 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:34:48,330 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ('528155210',)
2025-01-18 23:34:49,997 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:34:49,999 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:34:50,001 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:34:50,001 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] ('528155210',)
2025-01-18 23:35:10,920 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:41:44,322 - root - INFO - Инициализация бота...
2025-01-18 23:41:45,180 - root - INFO - Инициализация бота...
2025-01-18 23:41:45,266 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:41:45,267 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:41:45,267 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:41:45,271 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:41:45,272 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:41:45,273 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:41:45,335 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:41:45,336 - root - INFO - Инициализация диспетчера...
2025-01-18 23:41:45,337 - root - INFO - Регистрация обработчиков...
2025-01-18 23:41:45,340 - root - INFO - Регистрация main menu команд...
2025-01-18 23:41:45,340 - root - INFO - Запуск polling...
2025-01-18 23:41:45,341 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:41:45,351 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:41:45,356 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:41:45,357 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ()
2025-01-18 23:41:45,363 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:41:45,363 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ('528155210',)
2025-01-18 23:41:48,062 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:41:48,064 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:41:48,067 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-18 23:41:48,068 - sqlalchemy.engine.Engine - INFO - [generated in 0.00090s] ('528155210',)
2025-01-18 23:42:15,228 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-18 23:42:17,539 - aiogram.event - INFO - Update id=659309980 is handled. Duration 2156 ms by bot id=7444575424
2025-01-18 23:42:48,193 - root - ERROR - Ошибка проверки базы данных: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]
2025-01-18 23:42:48,195 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-2' coro=<DbProcessor.check_db() done, defined at C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py:65> exception=TelegramNetworkError('HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]')>
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1116, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs, sock=sock)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1112, in create_connection
    transport, protocol = await self._create_connection_transport(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1145, in _create_connection_transport
    await waiter
ConnectionAbortedError: SSL handshake is taking longer than 60.0 seconds: aborting the connection

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 181, in make_request
    async with session.post(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 1360, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 663, in _request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 538, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1050, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1384, in _create_direct_connection
    raise last_exc
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1353, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1124, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py", line 94, in check_db
    await send_message_subscription_expired(
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\utils\send_message.py", line 48, in send_message_subscription_expired
    await bot.send_message(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 2962, in send_message
    return await self(call, request_timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 188, in make_request
    raise TelegramNetworkError(method=method, message=f"{type(e).__name__}: {e}")
aiogram.exceptions.TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]
2025-01-18 23:43:02,948 - aiogram.event - INFO - Update id=659309985 is not handled. Duration 30608 ms by bot id=7444575424
2025-01-18 23:43:02,948 - aiogram.event - ERROR - Cause exception while process update id=659309985 by bot id=7444575424
TelegramBadRequest: Telegram server says - Bad Request: message to edit not found
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\main_menu_router.py", line 51, in main_menu_handler
    await show_about_us(callback, state)
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\utils_router.py", line 67, in show_about_us
    await callback.message.edit_text(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 189, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message to edit not found
2025-01-18 23:43:03,090 - aiogram.event - INFO - Update id=659309987 is handled. Duration 125 ms by bot id=7444575424
2025-01-18 23:43:06,362 - aiogram.event - INFO - Update id=659309988 is handled. Duration 218 ms by bot id=7444575424
2025-01-18 23:43:07,689 - aiogram.event - INFO - Update id=659309989 is handled. Duration 265 ms by bot id=7444575424
2025-01-18 23:43:08,979 - aiogram.event - INFO - Update id=659309990 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 23:43:10,404 - aiogram.event - INFO - Update id=659309991 is handled. Duration 609 ms by bot id=7444575424
2025-01-18 23:43:11,669 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:43:11,673 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:43:11,673 - sqlalchemy.engine.Engine - INFO - [generated in 0.00072s] ('528155210', 1, 0)
2025-01-18 23:43:11,676 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:43:11,676 - sqlalchemy.engine.Engine - INFO - [cached since 86.31s ago] ('528155210',)
2025-01-18 23:43:14,168 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-18 23:43:14,242 - aiogram.event - INFO - Update id=659309992 is handled. Duration 2562 ms by bot id=7444575424
2025-01-18 23:43:15,386 - aiogram.event - INFO - Update id=659309981 is not handled. Duration 60014 ms by bot id=7444575424
2025-01-18 23:43:15,386 - aiogram.event - ERROR - Cause exception while process update id=659309981 by bot id=7444575424
TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1116, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs, sock=sock)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1112, in create_connection
    transport, protocol = await self._create_connection_transport(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1145, in _create_connection_transport
    await waiter
ConnectionAbortedError: SSL handshake is taking longer than 60.0 seconds: aborting the connection

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 181, in make_request
    async with session.post(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 1360, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 663, in _request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 538, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1050, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1384, in _create_direct_connection
    raise last_exc
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1353, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1124, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\main_menu_router.py", line 28, in show_main_menu
    await send_message_and_save(
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\utils\send_message.py", line 41, in send_message_and_save
    sent_message = await message.answer(text, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 188, in make_request
    raise TelegramNetworkError(method=method, message=f"{type(e).__name__}: {e}")
aiogram.exceptions.TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]
2025-01-18 23:43:15,398 - aiogram.event - INFO - Update id=659309984 is not handled. Duration 60014 ms by bot id=7444575424
2025-01-18 23:43:15,398 - aiogram.event - ERROR - Cause exception while process update id=659309984 by bot id=7444575424
TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1116, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs, sock=sock)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1112, in create_connection
    transport, protocol = await self._create_connection_transport(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1145, in _create_connection_transport
    await waiter
ConnectionAbortedError: SSL handshake is taking longer than 60.0 seconds: aborting the connection

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 181, in make_request
    async with session.post(
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 1360, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\client.py", line 663, in _request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 538, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1050, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1384, in _create_direct_connection
    raise last_exc
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1353, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiohttp\connector.py", line 1124, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\routers\main_menu_router.py", line 28, in show_main_menu
    await send_message_and_save(
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\bot\utils\send_message.py", line 41, in send_message_and_save
    sent_message = await message.answer(text, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\bot.py", line 494, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Хороший человек\Documents\LISA\Lib\site-packages\aiogram\client\session\aiohttp.py", line 188, in make_request
    raise TelegramNetworkError(method=method, message=f"{type(e).__name__}: {e}")
aiogram.exceptions.TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [None]
2025-01-18 23:43:15,625 - aiogram.event - INFO - Update id=659309993 is handled. Duration 141 ms by bot id=7444575424
2025-01-18 23:43:16,879 - aiogram.event - INFO - Update id=659309994 is handled. Duration 328 ms by bot id=7444575424
2025-01-18 23:43:17,912 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=24000)]
2025-01-18 23:43:18,272 - aiogram.event - INFO - Update id=659309995 is handled. Duration 358 ms by bot id=7444575424
2025-01-18 23:43:19,312 - aiogram.event - INFO - Update id=659309986 is handled. Duration 31906 ms by bot id=7444575424
2025-01-18 23:43:19,600 - aiogram.event - INFO - Update id=659309996 is handled. Duration 218 ms by bot id=7444575424
2025-01-18 23:43:22,302 - aiogram.event - INFO - Update id=659309997 is handled. Duration 390 ms by bot id=7444575424
2025-01-18 23:43:23,597 - aiogram.event - INFO - Update id=659309998 is handled. Duration 297 ms by bot id=7444575424
2025-01-18 23:43:28,475 - aiogram.event - INFO - Update id=659309999 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 23:43:29,770 - aiogram.event - INFO - Update id=659310000 is handled. Duration 170 ms by bot id=7444575424
2025-01-18 23:43:31,019 - aiogram.event - INFO - Update id=659310001 is handled. Duration 358 ms by bot id=7444575424
2025-01-18 23:43:31,708 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:43:31,709 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:43:31,709 - sqlalchemy.engine.Engine - INFO - [cached since 20.04s ago] ('528155210', 1, 0)
2025-01-18 23:43:31,711 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:43:31,711 - sqlalchemy.engine.Engine - INFO - [cached since 106.3s ago] ('528155210',)
2025-01-18 23:43:34,204 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-18 23:43:34,384 - aiogram.event - INFO - Update id=659310002 is handled. Duration 2672 ms by bot id=7444575424
2025-01-18 23:43:35,302 - aiogram.event - INFO - Update id=659310003 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 23:43:36,282 - aiogram.event - INFO - Update id=659310004 is handled. Duration 141 ms by bot id=7444575424
2025-01-18 23:43:38,025 - aiogram.event - INFO - Update id=659310005 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 23:43:38,863 - aiogram.event - INFO - Update id=659310006 is handled. Duration 139 ms by bot id=7444575424
2025-01-18 23:43:41,263 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:43:41,265 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:43:41,265 - sqlalchemy.engine.Engine - INFO - [cached since 29.59s ago] ('528155210', 1, 0)
2025-01-18 23:43:41,342 - aiogram.event - INFO - Update id=659310007 is handled. Duration 93 ms by bot id=7444575424
2025-01-18 23:43:42,688 - aiogram.event - INFO - Update id=659310008 is handled. Duration 203 ms by bot id=7444575424
2025-01-18 23:43:43,654 - aiogram.event - INFO - Update id=659310009 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 23:43:44,651 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=24000)]
2025-01-18 23:43:44,896 - aiogram.event - INFO - Update id=659310010 is handled. Duration 250 ms by bot id=7444575424
2025-01-18 23:43:46,084 - aiogram.event - INFO - Update id=659310011 is handled. Duration 140 ms by bot id=7444575424
2025-01-18 23:43:47,415 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 23:43:47,772 - aiogram.event - INFO - Update id=659310012 is handled. Duration 358 ms by bot id=7444575424
2025-01-18 23:43:49,167 - aiogram.event - INFO - Update id=659310013 is handled. Duration 234 ms by bot id=7444575424
2025-01-18 23:43:50,867 - aiogram.event - INFO - Update id=659310014 is handled. Duration 139 ms by bot id=7444575424
2025-01-18 23:43:51,922 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=9000)]
2025-01-18 23:43:52,144 - aiogram.event - INFO - Update id=659310015 is handled. Duration 218 ms by bot id=7444575424
2025-01-18 23:43:54,135 - aiogram.event - INFO - Update id=659310016 is handled. Duration 562 ms by bot id=7444575424
2025-01-18 23:43:57,888 - aiogram.event - INFO - Update id=659310017 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 23:43:59,195 - aiogram.event - INFO - Update id=659310018 is handled. Duration 140 ms by bot id=7444575424
2025-01-18 23:44:00,104 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:44:00,106 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:44:00,106 - sqlalchemy.engine.Engine - INFO - [cached since 48.43s ago] ('528155210', 1, 0)
2025-01-18 23:44:00,109 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:44:00,110 - sqlalchemy.engine.Engine - INFO - [cached since 134.7s ago] ('528155210',)
2025-01-18 23:44:03,636 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-18 23:44:03,783 - aiogram.event - INFO - Update id=659310019 is handled. Duration 3687 ms by bot id=7444575424
2025-01-18 23:44:06,478 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:44:06,482 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:44:06,482 - sqlalchemy.engine.Engine - INFO - [generated in 0.00089s] ('125', 1, 0)
2025-01-18 23:44:06,694 - aiogram.event - INFO - Update id=659310020 is handled. Duration 1984 ms by bot id=7444575424
2025-01-18 23:44:09,273 - aiogram.event - INFO - Update id=659310021 is handled. Duration 250 ms by bot id=7444575424
2025-01-18 23:44:11,025 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 23:44:11,323 - aiogram.event - INFO - Update id=659310022 is handled. Duration 312 ms by bot id=7444575424
2025-01-18 23:44:12,853 - aiogram.event - INFO - Update id=659310023 is handled. Duration 250 ms by bot id=7444575424
2025-01-18 23:44:23,535 - aiogram.event - INFO - Update id=659310024 is handled. Duration 187 ms by bot id=7444575424
2025-01-18 23:44:25,504 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:44:25,505 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:44:25,506 - sqlalchemy.engine.Engine - INFO - [cached since 73.83s ago] ('528155210', 1, 0)
2025-01-18 23:44:25,509 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:44:25,510 - sqlalchemy.engine.Engine - INFO - [cached since 160.1s ago] ('528155210',)
2025-01-18 23:44:27,685 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-18 23:44:27,769 - aiogram.event - INFO - Update id=659310025 is handled. Duration 2264 ms by bot id=7444575424
2025-01-18 23:44:30,775 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:44:30,776 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:44:30,777 - sqlalchemy.engine.Engine - INFO - [cached since 24.3s ago] ('125', 1, 0)
2025-01-18 23:44:30,922 - aiogram.event - INFO - Update id=659310026 is handled. Duration 2093 ms by bot id=7444575424
2025-01-18 23:44:32,719 - aiogram.event - INFO - Update id=659310027 is handled. Duration 79 ms by bot id=7444575424
2025-01-18 23:44:34,378 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=39000)]
2025-01-18 23:44:34,599 - aiogram.event - INFO - Update id=659310028 is handled. Duration 218 ms by bot id=7444575424
2025-01-18 23:44:36,717 - aiogram.event - INFO - Update id=659310029 is handled. Duration 218 ms by bot id=7444575424
2025-01-18 23:44:38,476 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:44:38,477 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:44:38,477 - sqlalchemy.engine.Engine - INFO - [cached since 86.8s ago] ('528155210', 1, 0)
2025-01-18 23:44:38,479 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:44:38,479 - sqlalchemy.engine.Engine - INFO - [cached since 173.1s ago] ('528155210',)
2025-01-18 23:44:41,348 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-18 23:44:41,412 - aiogram.event - INFO - Update id=659310030 is handled. Duration 2937 ms by bot id=7444575424
2025-01-18 23:44:44,186 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:44:44,187 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:44:44,187 - sqlalchemy.engine.Engine - INFO - [cached since 37.71s ago] ('125', 1, 0)
2025-01-18 23:44:44,306 - aiogram.event - INFO - Update id=659310031 is handled. Duration 1921 ms by bot id=7444575424
2025-01-18 23:44:46,440 - aiogram.event - INFO - Update id=659310032 is handled. Duration 155 ms by bot id=7444575424
2025-01-18 23:44:49,931 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=24000)]
2025-01-18 23:44:50,186 - aiogram.event - INFO - Update id=659310033 is handled. Duration 264 ms by bot id=7444575424
2025-01-18 23:44:53,294 - aiogram.event - INFO - Update id=659310034 is handled. Duration 156 ms by bot id=7444575424
2025-01-18 23:44:57,819 - aiogram.event - INFO - Update id=659310035 is handled. Duration 217 ms by bot id=7444575424
2025-01-18 23:45:02,356 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:45:02,357 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:45:02,357 - sqlalchemy.engine.Engine - INFO - [cached since 110.7s ago] ('528155210', 1, 0)
2025-01-18 23:45:02,359 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:45:02,360 - sqlalchemy.engine.Engine - INFO - [cached since 197s ago] ('528155210',)
2025-01-18 23:45:04,994 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-18 23:45:05,116 - aiogram.event - INFO - Update id=659310036 is handled. Duration 2750 ms by bot id=7444575424
2025-01-18 23:45:08,640 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:45:08,641 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:45:08,641 - sqlalchemy.engine.Engine - INFO - [cached since 62.16s ago] ('125', 1, 0)
2025-01-18 23:45:08,838 - aiogram.event - INFO - Update id=659310037 is handled. Duration 2484 ms by bot id=7444575424
2025-01-18 23:45:14,338 - aiogram.event - INFO - Update id=659310038 is handled. Duration 94 ms by bot id=7444575424
2025-01-18 23:45:21,462 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:45:21,463 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-18 23:45:21,463 - sqlalchemy.engine.Engine - INFO - [cached since 74.98s ago] ('125', 1, 0)
2025-01-18 23:45:21,628 - aiogram.event - INFO - Update id=659310039 is handled. Duration 2671 ms by bot id=7444575424
2025-01-18 23:45:23,679 - aiogram.event - INFO - Update id=659310040 is handled. Duration 110 ms by bot id=7444575424
2025-01-18 23:45:24,937 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=24000)]
2025-01-18 23:45:25,221 - aiogram.event - INFO - Update id=659310041 is handled. Duration 282 ms by bot id=7444575424
2025-01-18 23:45:28,944 - aiogram.event - INFO - Update id=659310042 is handled. Duration 155 ms by bot id=7444575424
2025-01-18 23:45:36,507 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=9000)]
2025-01-18 23:45:36,905 - aiogram.event - INFO - Update id=659310043 is handled. Duration 406 ms by bot id=7444575424
2025-01-18 23:45:38,767 - aiogram.event - INFO - Update id=659310044 is handled. Duration 265 ms by bot id=7444575424
2025-01-18 23:45:51,318 - aiogram.dispatcher - INFO - Polling stopped
2025-01-18 23:58:11,267 - root - INFO - Инициализация бота...
2025-01-18 23:58:11,873 - root - INFO - Инициализация бота...
2025-01-18 23:58:11,929 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:58:11,930 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-18 23:58:11,930 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:58:11,931 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-18 23:58:11,931 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-18 23:58:11,932 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-18 23:58:11,958 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-18 23:58:11,958 - root - INFO - Инициализация диспетчера...
2025-01-18 23:58:11,959 - root - INFO - Регистрация обработчиков...
2025-01-18 23:58:11,960 - root - INFO - Регистрация main menu команд...
2025-01-18 23:58:11,960 - root - INFO - Запуск polling...
2025-01-18 23:58:11,961 - aiogram.dispatcher - INFO - Start polling
2025-01-18 23:58:11,966 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-18 23:58:11,970 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-18 23:58:11,970 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] ()
2025-01-18 23:58:11,974 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-18 23:58:11,974 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] ('528155210',)
2025-01-18 23:58:14,579 - root - ERROR - Ошибка проверки базы данных: (0, '125')
2025-01-18 23:58:14,946 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:00:12,980 - aiogram.dispatcher - INFO - Polling stopped
2025-01-19 00:00:13,240 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:00:13,366 - root - INFO - Бот остановлен вручную.
2025-01-19 00:00:23,536 - root - INFO - Инициализация бота...
2025-01-19 00:00:24,646 - root - INFO - Инициализация бота...
2025-01-19 00:00:24,767 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:00:24,768 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-19 00:00:24,768 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:00:24,770 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-19 00:00:24,770 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:00:24,771 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-19 00:00:24,831 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-19 00:00:24,831 - root - INFO - Инициализация диспетчера...
2025-01-19 00:00:24,833 - root - INFO - Регистрация обработчиков...
2025-01-19 00:00:24,835 - root - INFO - Регистрация main menu команд...
2025-01-19 00:00:24,835 - root - INFO - Запуск polling...
2025-01-19 00:00:24,836 - aiogram.dispatcher - INFO - Start polling
2025-01-19 00:00:24,848 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:00:24,856 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-19 00:00:24,856 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] ()
2025-01-19 00:00:24,863 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-19 00:00:24,864 - sqlalchemy.engine.Engine - INFO - [generated in 0.00064s] ('528155210',)
2025-01-19 00:00:39,636 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:02:09,846 - aiogram.dispatcher - INFO - Polling stopped
2025-01-19 00:02:10,112 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:02:10,118 - root - INFO - Бот остановлен вручную.
2025-01-19 00:02:10,435 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000012F7711BF10>
2025-01-19 00:02:15,602 - root - INFO - Инициализация бота...
2025-01-19 00:02:16,196 - root - INFO - Инициализация бота...
2025-01-19 00:02:16,245 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:02:16,246 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-19 00:02:16,246 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:02:16,247 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-19 00:02:16,247 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:02:16,248 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-19 00:02:16,273 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-19 00:02:16,273 - root - INFO - Инициализация диспетчера...
2025-01-19 00:02:16,274 - root - INFO - Регистрация обработчиков...
2025-01-19 00:02:16,275 - root - INFO - Регистрация main menu команд...
2025-01-19 00:02:16,275 - root - INFO - Запуск polling...
2025-01-19 00:02:16,276 - aiogram.dispatcher - INFO - Start polling
2025-01-19 00:02:16,283 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:02:16,287 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-19 00:02:16,287 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ()
2025-01-19 00:02:16,292 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-19 00:02:16,292 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('528155210',)
2025-01-19 00:02:18,764 - root - ERROR - Ошибка проверки базы данных: unsupported operand type(s) for +: 'int' and 'datetime.timedelta'
2025-01-19 00:02:18,765 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-2' coro=<DbProcessor.check_db() done, defined at C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py:65> exception=TypeError("unsupported operand type(s) for +: 'int' and 'datetime.timedelta'")>
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py", line 80, in check_db
    expiring_keys[key.key_id] = (key_name, (key.expiration_date - datetime.now()).days + timedelta(days=1))
                                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for +: 'int' and 'datetime.timedelta'
2025-01-19 00:02:19,097 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:02:45,366 - aiogram.dispatcher - INFO - Polling stopped
2025-01-19 00:02:45,625 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:02:45,630 - root - INFO - Бот остановлен вручную.
2025-01-19 00:02:51,066 - root - INFO - Инициализация бота...
2025-01-19 00:02:51,693 - root - INFO - Инициализация бота...
2025-01-19 00:02:51,744 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:02:51,744 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-19 00:02:51,745 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:02:51,746 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-19 00:02:51,746 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:02:51,747 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-19 00:02:51,778 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-19 00:02:51,778 - root - INFO - Инициализация диспетчера...
2025-01-19 00:02:51,779 - root - INFO - Регистрация обработчиков...
2025-01-19 00:02:51,781 - root - INFO - Регистрация main menu команд...
2025-01-19 00:02:51,781 - root - INFO - Запуск polling...
2025-01-19 00:02:51,781 - aiogram.dispatcher - INFO - Start polling
2025-01-19 00:02:51,787 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:02:51,792 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-19 00:02:51,793 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] ()
2025-01-19 00:02:51,797 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-19 00:02:51,797 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ('528155210',)
2025-01-19 00:02:55,564 - root - ERROR - Ошибка проверки базы данных: 'int' object is not callable
2025-01-19 00:02:55,564 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-2' coro=<DbProcessor.check_db() done, defined at C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py:65> exception=TypeError("'int' object is not callable")>
Traceback (most recent call last):
  File "C:\Users\Хороший человек\Documents\coding\LISA\src\database\db_processor.py", line 80, in check_db
    expiring_keys[key.key_id] = (key_name, (key.expiration_date - datetime.now()).days()+1)
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'int' object is not callable
2025-01-19 00:02:56,836 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:03:57,822 - aiogram.dispatcher - INFO - Polling stopped
2025-01-19 00:03:58,083 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:03:58,091 - root - INFO - Бот остановлен вручную.
2025-01-19 00:04:03,843 - root - INFO - Инициализация бота...
2025-01-19 00:04:04,566 - root - INFO - Инициализация бота...
2025-01-19 00:04:04,615 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:04:04,615 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-19 00:04:04,615 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:04:04,617 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-19 00:04:04,617 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:04:04,617 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-19 00:04:04,656 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-19 00:04:04,657 - root - INFO - Инициализация диспетчера...
2025-01-19 00:04:04,658 - root - INFO - Регистрация обработчиков...
2025-01-19 00:04:04,660 - root - INFO - Регистрация main menu команд...
2025-01-19 00:04:04,661 - root - INFO - Запуск polling...
2025-01-19 00:04:04,661 - aiogram.dispatcher - INFO - Start polling
2025-01-19 00:04:04,670 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:04:04,677 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-19 00:04:04,678 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] ()
2025-01-19 00:04:04,685 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-19 00:04:04,686 - sqlalchemy.engine.Engine - INFO - [generated in 0.00067s] ('528155210',)
2025-01-19 00:04:07,209 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:04:41,213 - aiogram.dispatcher - INFO - Polling stopped
2025-01-19 00:04:41,477 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:04:41,482 - root - INFO - Бот остановлен вручную.
2025-01-19 00:04:41,806 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001A27FFD3C50>
2025-01-19 00:04:46,913 - root - INFO - Инициализация бота...
2025-01-19 00:04:47,431 - root - INFO - Инициализация бота...
2025-01-19 00:04:47,488 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:04:47,488 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-19 00:04:47,488 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:04:47,490 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-19 00:04:47,490 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:04:47,490 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-19 00:04:47,516 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-19 00:04:47,517 - root - INFO - Инициализация диспетчера...
2025-01-19 00:04:47,517 - root - INFO - Регистрация обработчиков...
2025-01-19 00:04:47,519 - root - INFO - Регистрация main menu команд...
2025-01-19 00:04:47,519 - root - INFO - Запуск polling...
2025-01-19 00:04:47,519 - aiogram.dispatcher - INFO - Start polling
2025-01-19 00:04:47,527 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:04:47,532 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-19 00:04:47,532 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] ()
2025-01-19 00:04:47,538 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-19 00:04:47,538 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] ('528155210',)
2025-01-19 00:04:49,814 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:05:23,589 - aiogram.dispatcher - INFO - Polling stopped
2025-01-19 00:05:23,843 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:05:23,848 - root - INFO - Бот остановлен вручную.
2025-01-19 00:05:24,210 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001F1D0D69410>
2025-01-19 00:05:29,838 - root - INFO - Инициализация бота...
2025-01-19 00:05:30,523 - root - INFO - Инициализация бота...
2025-01-19 00:05:30,592 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:05:30,592 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-19 00:05:30,592 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:05:30,594 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-19 00:05:30,594 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:05:30,596 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-19 00:05:30,631 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-19 00:05:30,631 - root - INFO - Инициализация диспетчера...
2025-01-19 00:05:30,631 - root - INFO - Регистрация обработчиков...
2025-01-19 00:05:30,634 - root - INFO - Регистрация main menu команд...
2025-01-19 00:05:30,634 - root - INFO - Запуск polling...
2025-01-19 00:05:30,634 - aiogram.dispatcher - INFO - Start polling
2025-01-19 00:05:30,642 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:05:30,646 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-19 00:05:30,646 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] ()
2025-01-19 00:05:30,651 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-19 00:05:30,651 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] ('528155210',)
2025-01-19 00:05:33,226 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:05:36,027 - aiogram.event - INFO - Update id=659310045 is handled. Duration 280 ms by bot id=7444575424
2025-01-19 00:05:37,928 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=9000)]
2025-01-19 00:05:38,347 - aiogram.event - INFO - Update id=659310046 is handled. Duration 422 ms by bot id=7444575424
2025-01-19 00:06:08,361 - aiogram.event - INFO - Update id=659310047 is handled. Duration 281 ms by bot id=7444575424
2025-01-19 00:06:09,724 - root - INFO - {
    "message_id": 4930,
    "date": 1737234371,
    "chat": {
        "id": 528155210,
        "type": "private",
        "title": null,
        "username": "dastroo",
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "is_forum": null,
        "accent_color_id": null,
        "active_usernames": null,
        "available_reactions": null,
        "background_custom_emoji_id": null,
        "bio": null,
        "birthdate": null,
        "business_intro": null,
        "business_location": null,
        "business_opening_hours": null,
        "can_set_sticker_set": null,
        "custom_emoji_sticker_set_name": null,
        "description": null,
        "emoji_status_custom_emoji_id": null,
        "emoji_status_expiration_date": null,
        "has_aggressive_anti_spam_enabled": null,
        "has_hidden_members": null,
        "has_private_forwards": null,
        "has_protected_content": null,
        "has_restricted_voice_and_video_messages": null,
        "has_visible_history": null,
        "invite_link": null,
        "join_by_request": null,
        "join_to_send_messages": null,
        "linked_chat_id": null,
        "location": null,
        "message_auto_delete_time": null,
        "permissions": null,
        "personal_chat": null,
        "photo": null,
        "pinned_message": null,
        "profile_accent_color_id": null,
        "profile_background_custom_emoji_id": null,
        "slow_mode_delay": null,
        "sticker_set_name": null,
        "unrestrict_boost_count": null
    },
    "message_thread_id": null,
    "from_user": {
        "id": 528155210,
        "is_bot": false,
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "username": "dastroo",
        "language_code": "ru",
        "is_premium": null,
        "added_to_attachment_menu": null,
        "can_join_groups": null,
        "can_read_all_group_messages": null,
        "supports_inline_queries": null,
        "can_connect_to_business": null,
        "has_main_web_app": null
    },
    "sender_chat": null,
    "sender_boost_count": null,
    "sender_business_bot": null,
    "business_connection_id": null,
    "forward_origin": null,
    "is_topic_message": null,
    "is_automatic_forward": null,
    "reply_to_message": null,
    "external_reply": null,
    "quote": null,
    "reply_to_story": null,
    "via_bot": null,
    "edit_date": null,
    "has_protected_content": null,
    "is_from_offline": null,
    "media_group_id": null,
    "author_signature": null,
    "text": null,
    "entities": null,
    "link_preview_options": null,
    "effect_id": null,
    "animation": null,
    "audio": null,
    "document": null,
    "paid_media": null,
    "photo": null,
    "sticker": null,
    "story": null,
    "video": null,
    "video_note": null,
    "voice": null,
    "caption": null,
    "caption_entities": null,
    "show_caption_above_media": null,
    "has_media_spoiler": null,
    "contact": null,
    "dice": null,
    "game": null,
    "poll": null,
    "venue": null,
    "location": null,
    "new_chat_members": null,
    "left_chat_member": null,
    "new_chat_title": null,
    "new_chat_photo": null,
    "delete_chat_photo": null,
    "group_chat_created": null,
    "supergroup_chat_created": null,
    "channel_chat_created": null,
    "message_auto_delete_timer_changed": null,
    "migrate_to_chat_id": null,
    "migrate_from_chat_id": null,
    "pinned_message": null,
    "invoice": null,
    "successful_payment": {
        "currency": "RUB",
        "total_amount": 9000,
        "invoice_payload": "4f6091f5-2344-48bb-92da-d57ce3c93da9",
        "telegram_payment_charge_id": "7444575424_528155210_346180",
        "provider_payment_charge_id": "2f1e2b82-000f-5000-a000-1ae4e3362cd5",
        "subscription_expiration_date": null,
        "is_recurring": null,
        "is_first_recurring": null,
        "shipping_option_id": null,
        "order_info": null
    },
    "refunded_payment": null,
    "users_shared": null,
    "chat_shared": null,
    "connected_website": null,
    "write_access_allowed": null,
    "passport_data": null,
    "proximity_alert_triggered": null,
    "boost_added": null,
    "chat_background_set": null,
    "forum_topic_created": null,
    "forum_topic_edited": null,
    "forum_topic_closed": null,
    "forum_topic_reopened": null,
    "general_forum_topic_hidden": null,
    "general_forum_topic_unhidden": null,
    "giveaway_created": null,
    "giveaway": null,
    "giveaway_winners": null,
    "giveaway_completed": null,
    "video_chat_scheduled": null,
    "video_chat_started": null,
    "video_chat_ended": null,
    "video_chat_participants_invited": null,
    "web_app_data": null,
    "reply_markup": null,
    "forward_date": null,
    "forward_from": null,
    "forward_from_chat": null,
    "forward_from_message_id": null,
    "forward_sender_name": null,
    "forward_signature": null,
    "user_shared": null
}
2025-01-19 00:06:09,818 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:06:09,824 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-19 00:06:09,825 - sqlalchemy.engine.Engine - INFO - [generated in 0.00186s] ('125', 1, 0)
2025-01-19 00:06:09,839 - sqlalchemy.engine.Engine - INFO - UPDATE keys SET expiration_date=? WHERE keys.key_id = ?
2025-01-19 00:06:09,840 - sqlalchemy.engine.Engine - INFO - [generated in 0.00203s] ('2025-02-20 23:31:27.902249', '125')
2025-01-19 00:06:09,849 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-19 00:06:09,862 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:06:09,866 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-19 00:06:09,867 - sqlalchemy.engine.Engine - INFO - [generated in 0.00112s] ('125',)
2025-01-19 00:06:09,870 - root - INFO - Ключ с ID 125 успешно продлён на 31 дней. Новая дата окончания: 2025-02-20 23:31:27.902249
2025-01-19 00:06:09,871 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-19 00:06:09,873 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:06:09,874 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-19 00:06:09,874 - sqlalchemy.engine.Engine - INFO - [cached since 0.05115s ago] ('125', 1, 0)
2025-01-19 00:06:12,566 - aiogram.event - INFO - Update id=659310048 is handled. Duration 2843 ms by bot id=7444575424
2025-01-19 00:06:26,865 - aiogram.event - INFO - Update id=659310049 is handled. Duration 219 ms by bot id=7444575424
2025-01-19 00:06:58,079 - aiogram.event - INFO - Update id=659310050 is handled. Duration 483 ms by bot id=7444575424
2025-01-19 00:07:00,455 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:07:00,459 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-19 00:07:00,460 - sqlalchemy.engine.Engine - INFO - [generated in 0.00086s] ('528155210', 1, 0)
2025-01-19 00:07:00,463 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-19 00:07:00,464 - sqlalchemy.engine.Engine - INFO - [cached since 89.81s ago] ('528155210',)
2025-01-19 00:07:02,441 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-19 00:07:02,511 - aiogram.event - INFO - Update id=659310051 is handled. Duration 2062 ms by bot id=7444575424
2025-01-19 00:07:06,930 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:07:06,931 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-19 00:07:06,931 - sqlalchemy.engine.Engine - INFO - [cached since 57.11s ago] ('125', 1, 0)
2025-01-19 00:07:07,059 - aiogram.event - INFO - Update id=659310052 is handled. Duration 2468 ms by bot id=7444575424
2025-01-19 00:07:08,995 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:07:08,996 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-19 00:07:08,997 - sqlalchemy.engine.Engine - INFO - [cached since 59.17s ago] ('125', 1, 0)
2025-01-19 00:07:11,698 - aiogram.event - INFO - Update id=659310053 is handled. Duration 2718 ms by bot id=7444575424
2025-01-19 00:07:15,968 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:07:15,969 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-19 00:07:15,970 - sqlalchemy.engine.Engine - INFO - [cached since 66.15s ago] ('125', 1, 0)
2025-01-19 00:07:16,101 - aiogram.event - INFO - Update id=659310054 is handled. Duration 2609 ms by bot id=7444575424
2025-01-19 00:07:17,859 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:07:17,862 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-19 00:07:17,862 - sqlalchemy.engine.Engine - INFO - [cached since 68.04s ago] ('125', 1, 0)
2025-01-19 00:07:17,942 - aiogram.event - INFO - Update id=659310055 is handled. Duration 93 ms by bot id=7444575424
2025-01-19 00:07:21,906 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:07:21,907 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-19 00:07:21,908 - sqlalchemy.engine.Engine - INFO - [cached since 72.08s ago] ('125', 1, 0)
2025-01-19 00:07:22,099 - aiogram.event - INFO - Update id=659310056 is handled. Duration 2641 ms by bot id=7444575424
2025-01-19 00:09:11,240 - aiogram.dispatcher - INFO - Polling stopped
2025-01-19 00:09:11,509 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:09:11,514 - root - INFO - Бот остановлен вручную.
2025-01-19 00:09:11,832 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001EAF1471550>
2025-01-19 00:09:17,123 - root - INFO - Инициализация бота...
2025-01-19 00:09:17,750 - root - INFO - Инициализация бота...
2025-01-19 00:09:17,803 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:09:17,803 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-19 00:09:17,804 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:09:17,805 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-19 00:09:17,805 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:09:17,806 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-19 00:09:17,850 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-19 00:09:17,851 - root - INFO - Инициализация диспетчера...
2025-01-19 00:09:17,852 - root - INFO - Регистрация обработчиков...
2025-01-19 00:09:17,855 - root - INFO - Регистрация main menu команд...
2025-01-19 00:09:17,856 - root - INFO - Запуск polling...
2025-01-19 00:09:17,856 - aiogram.dispatcher - INFO - Start polling
2025-01-19 00:09:17,873 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:09:17,878 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-19 00:09:17,880 - sqlalchemy.engine.Engine - INFO - [generated in 0.00111s] ()
2025-01-19 00:09:17,888 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-19 00:09:17,889 - sqlalchemy.engine.Engine - INFO - [generated in 0.00067s] ('528155210',)
2025-01-19 00:09:21,011 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:09:31,170 - aiogram.event - INFO - Update id=659310057 is handled. Duration 266 ms by bot id=7444575424
2025-01-19 00:09:35,708 - aiogram.event - INFO - Update id=659310058 is handled. Duration 530 ms by bot id=7444575424
2025-01-19 00:09:36,383 - aiogram.event - INFO - Update id=659310059 is handled. Duration 140 ms by bot id=7444575424
2025-01-19 00:09:37,539 - aiogram.event - INFO - Update id=659310060 is handled. Duration 125 ms by bot id=7444575424
2025-01-19 00:09:39,220 - aiogram.event - INFO - Update id=659310061 is handled. Duration 156 ms by bot id=7444575424
2025-01-19 00:09:40,189 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:09:40,194 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-19 00:09:40,194 - sqlalchemy.engine.Engine - INFO - [generated in 0.00103s] ('528155210', 1, 0)
2025-01-19 00:09:40,199 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-19 00:09:40,200 - sqlalchemy.engine.Engine - INFO - [cached since 22.31s ago] ('528155210',)
2025-01-19 00:09:42,796 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-19 00:09:42,866 - aiogram.event - INFO - Update id=659310062 is handled. Duration 2672 ms by bot id=7444575424
2025-01-19 00:09:46,499 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:09:46,502 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-19 00:09:46,503 - sqlalchemy.engine.Engine - INFO - [generated in 0.00097s] ('125', 1, 0)
2025-01-19 00:09:46,629 - aiogram.event - INFO - Update id=659310063 is handled. Duration 2562 ms by bot id=7444575424
2025-01-19 00:09:50,412 - aiogram.event - INFO - Update id=659310064 is handled. Duration 77 ms by bot id=7444575424
2025-01-19 00:09:53,412 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=9000)]
2025-01-19 00:09:53,638 - aiogram.event - INFO - Update id=659310065 is handled. Duration 234 ms by bot id=7444575424
2025-01-19 00:10:29,425 - aiogram.event - INFO - Update id=659310066 is handled. Duration 219 ms by bot id=7444575424
2025-01-19 00:10:30,930 - root - INFO - {
    "message_id": 4936,
    "date": 1737234632,
    "chat": {
        "id": 528155210,
        "type": "private",
        "title": null,
        "username": "dastroo",
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "is_forum": null,
        "accent_color_id": null,
        "active_usernames": null,
        "available_reactions": null,
        "background_custom_emoji_id": null,
        "bio": null,
        "birthdate": null,
        "business_intro": null,
        "business_location": null,
        "business_opening_hours": null,
        "can_set_sticker_set": null,
        "custom_emoji_sticker_set_name": null,
        "description": null,
        "emoji_status_custom_emoji_id": null,
        "emoji_status_expiration_date": null,
        "has_aggressive_anti_spam_enabled": null,
        "has_hidden_members": null,
        "has_private_forwards": null,
        "has_protected_content": null,
        "has_restricted_voice_and_video_messages": null,
        "has_visible_history": null,
        "invite_link": null,
        "join_by_request": null,
        "join_to_send_messages": null,
        "linked_chat_id": null,
        "location": null,
        "message_auto_delete_time": null,
        "permissions": null,
        "personal_chat": null,
        "photo": null,
        "pinned_message": null,
        "profile_accent_color_id": null,
        "profile_background_custom_emoji_id": null,
        "slow_mode_delay": null,
        "sticker_set_name": null,
        "unrestrict_boost_count": null
    },
    "message_thread_id": null,
    "from_user": {
        "id": 528155210,
        "is_bot": false,
        "first_name": "Daniel Kostin\ud83d\udce1",
        "last_name": null,
        "username": "dastroo",
        "language_code": "ru",
        "is_premium": null,
        "added_to_attachment_menu": null,
        "can_join_groups": null,
        "can_read_all_group_messages": null,
        "supports_inline_queries": null,
        "can_connect_to_business": null,
        "has_main_web_app": null
    },
    "sender_chat": null,
    "sender_boost_count": null,
    "sender_business_bot": null,
    "business_connection_id": null,
    "forward_origin": null,
    "is_topic_message": null,
    "is_automatic_forward": null,
    "reply_to_message": null,
    "external_reply": null,
    "quote": null,
    "reply_to_story": null,
    "via_bot": null,
    "edit_date": null,
    "has_protected_content": null,
    "is_from_offline": null,
    "media_group_id": null,
    "author_signature": null,
    "text": null,
    "entities": null,
    "link_preview_options": null,
    "effect_id": null,
    "animation": null,
    "audio": null,
    "document": null,
    "paid_media": null,
    "photo": null,
    "sticker": null,
    "story": null,
    "video": null,
    "video_note": null,
    "voice": null,
    "caption": null,
    "caption_entities": null,
    "show_caption_above_media": null,
    "has_media_spoiler": null,
    "contact": null,
    "dice": null,
    "game": null,
    "poll": null,
    "venue": null,
    "location": null,
    "new_chat_members": null,
    "left_chat_member": null,
    "new_chat_title": null,
    "new_chat_photo": null,
    "delete_chat_photo": null,
    "group_chat_created": null,
    "supergroup_chat_created": null,
    "channel_chat_created": null,
    "message_auto_delete_timer_changed": null,
    "migrate_to_chat_id": null,
    "migrate_from_chat_id": null,
    "pinned_message": null,
    "invoice": null,
    "successful_payment": {
        "currency": "RUB",
        "total_amount": 9000,
        "invoice_payload": "7f12f11f-c720-4654-a1ae-3f551495c3cf",
        "telegram_payment_charge_id": "7444575424_528155210_346192",
        "provider_payment_charge_id": "2f1e2c87-000f-5000-b000-15b754733ad0",
        "subscription_expiration_date": null,
        "is_recurring": null,
        "is_first_recurring": null,
        "shipping_option_id": null,
        "order_info": null
    },
    "refunded_payment": null,
    "users_shared": null,
    "chat_shared": null,
    "connected_website": null,
    "write_access_allowed": null,
    "passport_data": null,
    "proximity_alert_triggered": null,
    "boost_added": null,
    "chat_background_set": null,
    "forum_topic_created": null,
    "forum_topic_edited": null,
    "forum_topic_closed": null,
    "forum_topic_reopened": null,
    "general_forum_topic_hidden": null,
    "general_forum_topic_unhidden": null,
    "giveaway_created": null,
    "giveaway": null,
    "giveaway_winners": null,
    "giveaway_completed": null,
    "video_chat_scheduled": null,
    "video_chat_started": null,
    "video_chat_ended": null,
    "video_chat_participants_invited": null,
    "web_app_data": null,
    "reply_markup": null,
    "forward_date": null,
    "forward_from": null,
    "forward_from_chat": null,
    "forward_from_message_id": null,
    "forward_sender_name": null,
    "forward_signature": null,
    "user_shared": null
}
2025-01-19 00:10:31,015 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:10:31,017 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-19 00:10:31,018 - sqlalchemy.engine.Engine - INFO - [cached since 44.52s ago] ('125', 1, 0)
2025-01-19 00:10:31,028 - sqlalchemy.engine.Engine - INFO - UPDATE keys SET expiration_date=? WHERE keys.key_id = ?
2025-01-19 00:10:31,029 - sqlalchemy.engine.Engine - INFO - [generated in 0.00160s] ('2025-03-23 23:31:27.902249', '125')
2025-01-19 00:10:31,035 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-19 00:10:31,049 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:10:31,054 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
2025-01-19 00:10:31,055 - sqlalchemy.engine.Engine - INFO - [generated in 0.00131s] ('125',)
2025-01-19 00:10:31,057 - root - INFO - Ключ с ID 125 успешно продлён на 31 дней. Новая дата окончания: 2025-03-23 23:31:27.902249
2025-01-19 00:10:31,058 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-19 00:10:31,060 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:10:31,062 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE keys.key_id = ?
 LIMIT ? OFFSET ?
2025-01-19 00:10:31,063 - sqlalchemy.engine.Engine - INFO - [cached since 44.56s ago] ('125', 1, 0)
2025-01-19 00:10:33,756 - aiogram.event - INFO - Update id=659310067 is handled. Duration 2827 ms by bot id=7444575424
2025-01-19 00:10:39,500 - aiogram.event - INFO - Update id=659310068 is handled. Duration 250 ms by bot id=7444575424
2025-01-19 00:10:43,782 - aiogram.event - INFO - Update id=659310069 is handled. Duration 172 ms by bot id=7444575424
2025-01-19 00:11:45,364 - aiogram.dispatcher - INFO - Polling stopped
2025-01-19 00:11:56,423 - root - INFO - Инициализация бота...
2025-01-19 00:11:57,023 - root - INFO - Инициализация бота...
2025-01-19 00:11:57,072 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:11:57,072 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-19 00:11:57,073 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:11:57,074 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2025-01-19 00:11:57,074 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:11:57,074 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-19 00:11:57,075 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:11:57,075 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("keys")
2025-01-19 00:11:57,075 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:11:57,076 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	user_telegram_id VARCHAR NOT NULL, 
	subscription_status VARCHAR, 
	use_trial_period BOOLEAN, 
	PRIMARY KEY (user_telegram_id)
)


2025-01-19 00:11:57,077 - sqlalchemy.engine.Engine - INFO - [no key 0.00045s] ()
2025-01-19 00:11:57,088 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE keys (
	key_id VARCHAR NOT NULL, 
	user_telegram_id VARCHAR, 
	expiration_date DATETIME, 
	start_date DATETIME, 
	remembering_before_exp BOOLEAN, 
	PRIMARY KEY (key_id), 
	FOREIGN KEY(user_telegram_id) REFERENCES users (user_telegram_id)
)


2025-01-19 00:11:57,088 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2025-01-19 00:11:57,097 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-19 00:11:57,155 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-19 00:11:57,156 - root - INFO - Инициализация диспетчера...
2025-01-19 00:11:57,157 - root - INFO - Регистрация обработчиков...
2025-01-19 00:11:57,160 - root - INFO - Регистрация main menu команд...
2025-01-19 00:11:57,160 - root - INFO - Запуск polling...
2025-01-19 00:11:57,161 - aiogram.dispatcher - INFO - Start polling
2025-01-19 00:11:57,173 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:11:57,181 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-19 00:11:57,181 - sqlalchemy.engine.Engine - INFO - [generated in 0.00070s] ()
2025-01-19 00:11:57,492 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:12:39,471 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:12:39,476 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-19 00:12:39,476 - sqlalchemy.engine.Engine - INFO - [generated in 0.00093s] ('432629636', 1, 0)
2025-01-19 00:12:39,777 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-19 00:12:39,778 - aiogram.event - INFO - Update id=659310070 is handled. Duration 311 ms by bot id=7444575424
2025-01-19 00:12:40,796 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:12:40,797 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-19 00:12:40,798 - sqlalchemy.engine.Engine - INFO - [cached since 1.323s ago] ('432629636', 1, 0)
2025-01-19 00:12:40,804 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (user_telegram_id, subscription_status, use_trial_period) VALUES (?, ?, ?)
2025-01-19 00:12:40,805 - sqlalchemy.engine.Engine - INFO - [generated in 0.00084s] ('432629636', 'active', 0)
2025-01-19 00:12:40,816 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-19 00:12:40,827 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:12:40,831 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
2025-01-19 00:12:40,831 - sqlalchemy.engine.Engine - INFO - [generated in 0.00081s] ('432629636',)
2025-01-19 00:12:40,837 - sqlalchemy.engine.Engine - INFO - UPDATE users SET use_trial_period=? WHERE users.user_telegram_id = ?
2025-01-19 00:12:40,837 - sqlalchemy.engine.Engine - INFO - [generated in 0.00078s] (1, '432629636')
2025-01-19 00:12:40,840 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-19 00:12:42,887 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:12:42,891 - sqlalchemy.engine.Engine - INFO - INSERT INTO keys (key_id, user_telegram_id, expiration_date, start_date, remembering_before_exp) VALUES (?, ?, ?, ?, ?)
2025-01-19 00:12:42,892 - sqlalchemy.engine.Engine - INFO - [generated in 0.00138s] ('126', '432629636', '2025-01-21 00:12:42.885795', '2025-01-19 00:12:42.885795', 0)
2025-01-19 00:12:42,903 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-19 00:12:42,914 - root - INFO - Key created: OutlineKey(key_id='126', name='VPN Key74', password='Ixlkk7AciXrRSxyq8pohST', port=20669, method='chacha20-ietf-poly1305', access_url='ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpJeGxrazdBY2lYclJTeHlxOHBvaFNU@5.35.38.7:20669/?outline=1', used_bytes=0, data_limit=1073741824) for user 7444575424
2025-01-19 00:12:43,086 - aiogram.event - INFO - Update id=659310071 is handled. Duration 2297 ms by bot id=7444575424
2025-01-19 00:12:45,020 - aiogram.event - INFO - Update id=659310072 is handled. Duration 186 ms by bot id=7444575424
2025-01-19 00:12:45,850 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:12:45,852 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users 
WHERE users.user_telegram_id = ?
 LIMIT ? OFFSET ?
2025-01-19 00:12:45,852 - sqlalchemy.engine.Engine - INFO - [cached since 6.377s ago] ('432629636', 1, 0)
2025-01-19 00:12:45,861 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-19 00:12:45,862 - sqlalchemy.engine.Engine - INFO - [generated in 0.00089s] ('432629636',)
2025-01-19 00:12:48,859 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-01-19 00:12:48,938 - aiogram.event - INFO - Update id=659310073 is handled. Duration 3092 ms by bot id=7444575424
2025-01-19 00:12:57,202 - aiogram.dispatcher - INFO - Polling stopped
2025-01-19 00:12:57,454 - aiogram.dispatcher - INFO - Polling stopped for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:12:57,460 - root - INFO - Бот остановлен вручную.
2025-01-19 00:13:03,018 - root - INFO - Инициализация бота...
2025-01-19 00:13:03,518 - root - INFO - Инициализация бота...
2025-01-19 00:13:03,564 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:13:03,564 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-01-19 00:13:03,564 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:13:03,565 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("keys")
2025-01-19 00:13:03,565 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-01-19 00:13:03,566 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-01-19 00:13:03,591 - root - INFO - Инициализация хранилища состояний (MemoryStorage)...
2025-01-19 00:13:03,591 - root - INFO - Инициализация диспетчера...
2025-01-19 00:13:03,592 - root - INFO - Регистрация обработчиков...
2025-01-19 00:13:03,593 - root - INFO - Регистрация main menu команд...
2025-01-19 00:13:03,593 - root - INFO - Запуск polling...
2025-01-19 00:13:03,593 - aiogram.dispatcher - INFO - Start polling
2025-01-19 00:13:03,599 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-01-19 00:13:03,602 - sqlalchemy.engine.Engine - INFO - SELECT users.user_telegram_id AS users_user_telegram_id, users.subscription_status AS users_subscription_status, users.use_trial_period AS users_use_trial_period 
FROM users
2025-01-19 00:13:03,602 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ()
2025-01-19 00:13:03,606 - sqlalchemy.engine.Engine - INFO - SELECT keys.key_id AS keys_key_id, keys.user_telegram_id AS keys_user_telegram_id, keys.expiration_date AS keys_expiration_date, keys.start_date AS keys_start_date, keys.remembering_before_exp AS keys_remembering_before_exp 
FROM keys 
WHERE ? = keys.user_telegram_id
2025-01-19 00:13:03,606 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] ('432629636',)
2025-01-19 00:13:06,129 - aiogram.dispatcher - INFO - Run polling for bot @safe_net_vpnbot id=7444575424 - 'LISA connect'
2025-01-19 00:13:22,938 - aiogram.event - INFO - Update id=659310074 is handled. Duration 436 ms by bot id=7444575424
2025-01-19 00:13:24,754 - root - INFO - Sending invoice with currency=RUB, amount=[LabeledPrice(label='Ключ от VPN', amount=69000)]
2025-01-19 00:13:25,147 - aiogram.event - INFO - Update id=659310075 is handled. Duration 389 ms by bot id=7444575424
2025-01-19 00:14:40,705 - aiogram.dispatcher - INFO - Polling stopped
